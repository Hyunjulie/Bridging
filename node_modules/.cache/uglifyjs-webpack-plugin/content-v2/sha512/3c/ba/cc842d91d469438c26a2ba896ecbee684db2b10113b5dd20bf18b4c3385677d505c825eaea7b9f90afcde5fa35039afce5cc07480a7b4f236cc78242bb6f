{"code":"!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&\"object\"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:e}),2&t&&\"string\"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,\"a\",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p=\"\",n(n.s=76)}([function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(2);function o(e){for(var t=e.length,n=0,r=0;t>0;)r=Math.random()*t|0,n=e[--t],e[t]=e[r],e[r]=n}function a(e,t){if(!e)throw new Error(t)}function i(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function s(e){if(\"float32\"===e)return t.NAN_FLOAT32;if(\"int32\"===e)return t.NAN_INT32;if(\"bool\"===e)return t.NAN_BOOL;throw new Error(\"Unknown dtype \"+e)}function u(e,n){if(isNaN(e))return!0;if(\"float32\"===n)return!1;if(\"int32\"===n)return e===t.NAN_INT32;if(\"bool\"===n)return e===t.NAN_BOOL;throw new Error(\"Unknown dtype \"+n)}function c(e){return e instanceof Float32Array||e instanceof Int32Array||e instanceof Uint8Array}t.shuffle=o,t.clamp=function(e,t,n){return Math.max(e,Math.min(t,n))},t.randUniform=function(e,t){return Math.random()*(t-e)+e},t.distSquared=function(e,t){for(var n=0,r=0;r<e.length;r++){var o=Number(e[r])-Number(t[r]);n+=o*o}return n},t.assert=a,t.assertShapesMatch=function(e,t,n){void 0===n&&(n=\"\"),a(i(e,t),n+\"Shapes \"+e+\" and \"+t+\" must match\")},t.assertTypesMatch=function(e,t){a(e.dtype===t.dtype,\"The dtypes of the first (\"+e.dtype+\") and second (\"+t.dtype+\") input must match\")},t.flatten=function e(t,n){if(void 0===n&&(n=[]),Array.isArray(t))for(var r=0;r<t.length;++r)e(t[r],n);else n.push(t);return n},t.inferShape=function(e){if(c(e))return[e.length];if(!Array.isArray(e))return[];for(var t=[];e instanceof Array;)t.push(e.length),e=e[0];return t},t.sizeFromShape=function(e){if(0===e.length)return 1;for(var t=e[0],n=1;n<e.length;n++)t*=e[n];return t},t.isScalarShape=function(e){return 0===e.length},t.arraysEqual=i,t.isInt=function(e){return e%1==0},t.tanh=function(e){if(null!=Math.tanh)return Math.tanh(e);if(e===1/0)return 1;if(e===-1/0)return-1;var t=Math.exp(2*e);return(t-1)/(t+1)},t.sizeToSquarishShape=function(e){for(var t=Math.floor(Math.sqrt(e));t>1;--t)if(e%t==0)return[t,e/t];return[1,e]},t.createShuffledIndices=function(e){for(var t=new Uint32Array(e),n=0;n<e;++n)t[n]=n;return o(t),t},t.rightPad=function(e,t){return t<=e.length?e:e+\" \".repeat(t-e.length)},t.repeatedTry=function(e,t,n){return void 0===t&&(t=function(e){return 0}),new Promise(function(r,o){var a=0,i=function(){if(e())r();else{var s=t(++a);null!=n&&a>=n?o():setTimeout(i,s)}};setTimeout(i,0)})},t.getQueryParams=function(e){var t={};return e.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return function(e,t,n){e[decodeURIComponent(t)]=decodeURIComponent(n||\"\")}(t,n[0],n[1]),n.join(\"=\")}),t},t.inferFromImplicitShape=function(e,t){for(var n=1,r=-1,o=0;o<e.length;++o)if(e[o]>0)n*=e[o];else if(-1===e[o]){if(-1!==r)throw Error(\"Shapes can only have 1 implicit size. Found -1 at dim \"+r+\" and dim \"+o);r=o}else if(e[o]<=0)throw Error(\"Shapes can not be <= 0. Found \"+e[o]+\" at dim \"+o);if(-1===r){if(t>0&&t!==n)throw Error(\"Size (\"+t+\") must match the product of shape \"+e);return e}if(t%n!=0)throw Error(\"The implicit shape can't be a fractional number. Got \"+t+\" / \"+n);var a=e.slice();return a[r]=t/n,a},t.NAN_INT32=1<<31,t.NAN_BOOL=255,t.NAN_FLOAT32=NaN,t.getNaN=s,t.isValNaN=u,t.squeezeShape=function(e,t){for(var n=[],r=[],o=0,a=0;a<e.length;++a){if(void 0!==t){if(t[o]===a&&e[a]>1)throw new Error(\"axis \"+a+\" is not 1\");(void 0===t[o]||t[o]>a)&&1===e[a]&&(n.push(e[a]),r.push(a)),t[o]<=a&&o++}e[a]>1&&(n.push(e[a]),r.push(a))}return{newShape:n,keptDims:r}},t.getTypedArrayFromDType=function(e,t){var n=null;if(null==e||\"float32\"===e)n=new Float32Array(t);else if(\"int32\"===e)n=new Int32Array(t);else{if(\"bool\"!==e)throw new Error(\"Unknown data type \"+e);n=new Uint8Array(t)}return n},t.isTensorInList=function(e,t){for(var n=0;n<t.length;n++)if(t[n].id===e.id)return!0;return!1},t.checkForNaN=function(e,t,n){for(var r=0;r<e.length;r++)if(u(e[r],t))throw Error(\"The result of the '\"+n+\"' has NaNs.\")},t.flattenNameArrayMap=function(e,t){var n=[];if(e instanceof r.Tensor)n.push(e);else for(var o=e,a=0;a<t.length;a++)n.push(o[t[a]]);return n},t.unflattenToNameArrayMap=function(e,t){if(e.length!==t.length)throw new Error(\"Cannot unflatten Tensor[], keys and arrays are not of same length.\");for(var n={},r=0;r<e.length;r++)n[e[r]]=t[r];return n},t.hasEncodingLoss=function(e,t){return!(\"float32\"===t||\"int32\"===t&&\"float32\"!==e||\"bool\"===t&&\"bool\"===e)},t.copyTypedArray=function(e,t){if(null==t||\"float32\"===t)return new Float32Array(e);if(\"int32\"===t){for(var n=new Int32Array(e.length),r=0;r<n.length;++r)u(a=e[r],\"int32\")?n[r]=s(\"int32\"):n[r]=a;return n}if(\"bool\"===t){var o=new Uint8Array(e.length);for(r=0;r<o.length;++r){var a;u(a=e[r],\"bool\")?o[r]=s(\"bool\"):0!==Math.round(a)&&(o[r]=1)}return o}throw new Error(\"Unknown data type \"+t)},t.isTypedArray=c,t.bytesPerElement=function(e){if(\"float32\"===e||\"int32\"===e)return 4;if(\"bool\"===e)return 1;throw new Error(\"Unknown dtype \"+e)},t.isFunction=function(e){return!!(e&&e.constructor&&e.call&&e.apply)}},function(e,t,n){\"use strict\";(function(e){var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o,a=n(90),i=n(4),s=n(91),u=n(25),c=n(0);function l(e,t){return null!=e.getExtension(t)}function p(e){if(0===e)throw new Error(\"Cannot get WebGL rendering context, WebGL is disabled.\");var t=document.createElement(\"canvas\");return 1===e?t.getContext(\"webgl\")||t.getContext(\"experimental-webgl\"):t.getContext(\"webgl2\")}function h(e){if(null!=e){var t=e.getExtension(\"WEBGL_lose_context\");if(null==t)throw new Error(\"Extension WEBGL_lose_context not supported on this browser.\");t.loseContext()}}function d(e){var t=p(e);return null!=t&&(h(t),!0)}!function(e){e[e.NUMBER=0]=\"NUMBER\",e[e.BOOLEAN=1]=\"BOOLEAN\",e[e.STRING=2]=\"STRING\"}(o=t.Type||(t.Type={})),t.URL_PROPERTIES=[{name:\"DEBUG\",type:o.BOOLEAN},{name:\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\",type:o.NUMBER},{name:\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE\",type:o.BOOLEAN},{name:\"WEBGL_VERSION\",type:o.NUMBER},{name:\"WEBGL_FLOAT_TEXTURE_ENABLED\",type:o.BOOLEAN},{name:\"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED\",type:o.BOOLEAN},{name:\"BACKEND\",type:o.STRING}];var f=[\"webgl\",\"cpu\"],m=function(){function e(e){this.features={},this.BACKEND_REGISTRY={},this.backends=this.BACKEND_REGISTRY,null!=e&&(this.features=e),this.get(\"DEBUG\")&&console.warn(\"Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.\")}return e.setBackend=function(e,n){if(void 0===n&&(n=!1),!(e in t.ENV.backends))throw new Error(\"Backend type '\"+e+\"' not found in registry\");t.ENV.globalMath=new u.NDArrayMath(e,n)},e.getBackend=function(){return t.ENV.initEngine(),t.ENV.currentBackendType},e.memory=function(){return t.ENV.engine.memory()},e.prototype.get=function(e){return e in this.features?this.features[e]:(this.features[e]=this.evaluateFeature(e),this.features[e])},e.prototype.set=function(e,t){this.features[e]=t},e.prototype.getBestBackendType=function(){for(var e=0;e<f.length;++e){var t=f[e];if(t in this.backends)return t}throw new Error(\"No backend found in registry.\")},e.prototype.evaluateFeature=function(e){if(\"DEBUG\"===e)return!1;if(\"BACKEND\"===e)return this.getBestBackendType();if(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\"===e){var t=this.get(\"WEBGL_VERSION\");return 0===t?0:function(e){if(0===e)return 0;var t,n=p(e);return t=l(n,\"EXT_disjoint_timer_query_webgl2\")&&2===e?2:l(n,\"EXT_disjoint_timer_query\")?1:0,null!=n&&h(n),t}(t)}if(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE\"===e)return this.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")>0&&!a.isMobile();if(\"WEBGL_VERSION\"===e)return d(2)?2:d(1)?1:0;if(\"WEBGL_FLOAT_TEXTURE_ENABLED\"===e)return function(e){if(0===e)return!1;var t=p(e);if(1===e){if(!l(t,\"OES_texture_float\"))return!1}else if(!l(t,\"EXT_color_buffer_float\"))return!1;var n=t.createFramebuffer(),r=t.createTexture();t.bindTexture(t.TEXTURE_2D,r);var o=2===e?t.RGBA32F:t.RGBA;t.texImage2D(t.TEXTURE_2D,0,o,1,1,0,t.RGBA,t.FLOAT,null),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,r,0);var a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;t.readPixels(0,0,1,1,t.RGBA,t.FLOAT,new Float32Array(4));var i=t.getError()===t.NO_ERROR;return h(t),a&&i}(this.get(\"WEBGL_VERSION\"));if(\"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED\"===e)return function(e){if(2!==e)return!1;var t=p(e),n=l(t,\"WEBGL_get_buffer_sub_data_async\");return h(t),n}(this.get(\"WEBGL_VERSION\"));throw new Error(\"Unknown feature \"+e+\".\")},e.prototype.setFeatures=function(e){this.reset(),this.features=e,this.backends={}},e.prototype.reset=function(){if(this.features=g(),null!=this.globalMath&&(this.globalMath.dispose(),this.globalMath=null,this.globalEngine=null),this.backends!==this.BACKEND_REGISTRY){for(var e in this.backends)this.backends[e].dispose();this.backends=this.BACKEND_REGISTRY}},e.prototype.setMath=function(e,n,r){if(void 0===r&&(r=!1),this.globalMath!==e){var o=!1;\"string\"==typeof n?(this.currentBackendType=n,n=t.ENV.findBackend(n)):(o=!0,this.currentBackendType=\"custom\"),this.globalEngine=new s.Engine(n,o,r),this.globalMath=e}},e.prototype.findBackend=function(e){return this.backends[e]},e.prototype.addCustomBackend=function(e,t){if(e in this.backends)throw new Error(e+\" backend was already registered\");try{var n=t();return this.backends[e]=n,!0}catch(e){return!1}},e.prototype.registerBackend=function(e,t){if(e in this.BACKEND_REGISTRY)throw new Error(e+\" backend was already registered as global\");try{var n=t();return this.BACKEND_REGISTRY[e]=n,!0}catch(e){return!1}},Object.defineProperty(e.prototype,\"math\",{get:function(){return null==this.globalEngine&&this.initEngine(),this.globalMath},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,\"engine\",{get:function(){return null==this.globalEngine&&this.initEngine(),this.globalEngine},enumerable:!0,configurable:!0}),e.prototype.initEngine=function(){this.globalMath=new u.NDArrayMath(t.ENV.get(\"BACKEND\"),!1)},r([i.doc({heading:\"Environment\"})],e,\"setBackend\",null),r([i.doc({heading:\"Environment\"})],e,\"getBackend\",null),r([i.doc({heading:\"Performance\",subheading:\"Memory\"})],e,\"memory\",null),e}();t.Environment=m;var v=\"dljsflags\";function g(){var e={};if(\"undefined\"==typeof window)return e;var n=c.getQueryParams(window.location.search);if(v in n){var r={};n[v].split(\",\").forEach(function(e){var t=e.split(\":\"),n=t[0],o=t[1];r[n]=o}),t.URL_PROPERTIES.forEach(function(t){t.name in r&&(console.log(\"Setting feature override from URL \"+t.name+\": \"+r[t.name]),t.type===o.NUMBER?e[t.name]=+r[t.name]:t.type===o.BOOLEAN?e[t.name]=\"true\"===r[t.name]:t.type===o.STRING?e[t.name]=r[t.name]:console.warn(\"Unknown URL param: \"+t.name+\".\"))})}return e}t.ENV=function(){var t=function(){var t;if(\"undefined\"!=typeof window)t=window;else{if(void 0===e)throw new Error(\"Could not find a global object\");t=e}return t}();return t.ENV=t.ENV||new m(g()),t.ENV}()}).call(this,n(37))},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},i=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var s=n(4),u=n(1),c=n(5),l=n(0),p=function(){function e(e,t,n){if(this.shape=e,this.dtype=t,this.values=n,null!=n){var r=n.length,o=l.sizeFromShape(e);l.assert(r===o,\"Length of values '\"+r+\"' does not match the size inferred by the shape '\"+o+\"'\")}this.values=n||l.getTypedArrayFromDType(t,l.sizeFromShape(e)),this.strides=x(e)}return e.prototype.set=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];0===t.length&&(t=[0]),l.assert(t.length===this.rank,\"The number of provided coordinates (\"+t.length+\") must match the rank (\"+this.rank+\")\");var r=this.locToIndex(t);this.values[r]=e},e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];0===e.length&&(e=[0]);for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.values[n]},e.prototype.locToIndex=function(e){if(0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},Object.defineProperty(e.prototype,\"rank\",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.toTensor=function(){return h.make(this.shape,{values:this.values},this.dtype)},o([s.doc({heading:\"Tensors\",subheading:\"Creation\"})],e.prototype,\"set\",null),o([s.doc({heading:\"Tensors\",subheading:\"Creation\"})],e.prototype,\"get\",null),o([s.doc({heading:\"Tensors\",subheading:\"Creation\"})],e.prototype,\"toTensor\",null),e=o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e)}();t.TensorBuffer=p;var h=function(){function e(e,n,r,o){this.isDisposed=!1,this.size=l.sizeFromShape(e),null!=r&&l.assert(this.size===r.length,\"Constructing tensor of shape (\"+this.size+\") should match the length of values (\"+r.length+\")\"),this.shape=e,this.dtype=n||\"float32\",this.strides=x(e),this.dataId=null!=o?o:{},this.id=t.nextId++,this.rankType=this.rank<5?this.rank.toString():\"higher\",u.ENV.engine.registerTensor(this),null!=r&&u.ENV.engine.write(this.dataId,r)}return t=e,e.ones=function(e,t){return c.ones(e,t)},e.zeros=function(e,t){return c.zeros(e,t)},e.onesLike=function(e){return c.onesLike(e)},e.zerosLike=function(e){return c.zerosLike(e)},e.like=function(e){return c.clone(e)},e.make=function(e,n,r){return new t(e,r,n.values,n.dataId)},e.fromPixels=function(e,t){return void 0===t&&(t=3),c.fromPixels(e,t)},e.rand=function(e,t,n){return c.rand(e,t,n)},e.randNormal=function(e,t,n,r,o){return void 0===t&&(t=0),void 0===n&&(n=1),c.randomNormal(e,t,n,r,o)},e.randTruncatedNormal=function(e,t,n,r,o){return void 0===t&&(t=0),void 0===n&&(n=1),c.truncatedNormal(e,t,n,r,o)},e.randUniform=function(e,t,n,r){return c.randomUniform(e,t,n,r)},e.prototype.flatten=function(){return this.throwIfDisposed(),this.as1D()},e.prototype.asScalar=function(){return this.throwIfDisposed(),l.assert(1===this.size,\"The array must have only 1 element.\"),this.reshape([])},e.prototype.as1D=function(){return this.throwIfDisposed(),this.reshape([this.size])},e.prototype.as2D=function(e,t){return this.throwIfDisposed(),this.reshape([e,t])},e.prototype.as3D=function(e,t,n){return this.throwIfDisposed(),this.reshape([e,t,n])},e.prototype.as4D=function(e,t,n,r){return this.throwIfDisposed(),this.reshape([e,t,n,r])},e.prototype.asType=function(e){return this.throwIfDisposed(),c.cast(this,e)},Object.defineProperty(e.prototype,\"rank\",{get:function(){return this.shape.length},enumerable:!0,configurable:!0}),e.prototype.get=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];this.throwIfDisposed(),0===e.length&&(e=[0]);for(var n=e[e.length-1],r=0;r<e.length-1;++r)n+=this.strides[r]*e[r];return this.dataSync()[n]},e.prototype.val=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return a(this,void 0,void 0,function(){return i(this,function(t){switch(t.label){case 0:return 0===e.length&&(e=[0]),this.throwIfDisposed(),[4,this.data()];case 1:return t.sent(),[2,this.get.apply(this,e)]}})})},e.prototype.locToIndex=function(e){if(this.throwIfDisposed(),0===this.rank)return 0;if(1===this.rank)return e[0];for(var t=e[e.length-1],n=0;n<e.length-1;++n)t+=this.strides[n]*e[n];return t},e.prototype.indexToLoc=function(e){if(this.throwIfDisposed(),0===this.rank)return[];if(1===this.rank)return[e];for(var t=new Array(this.shape.length),n=0;n<t.length-1;++n)t[n]=Math.floor(e/this.strides[n]),e-=t[n]*this.strides[n];return t[t.length-1]=e,t},e.prototype.getValues=function(){return this.dataSync()},e.prototype.getValuesAsync=function(){return this.data()},e.prototype.buffer=function(){return c.buffer(this.shape,this.dtype,this.dataSync())},e.prototype.data=function(){return a(this,void 0,void 0,function(){return i(this,function(e){return this.throwIfDisposed(),[2,u.ENV.engine.read(this.dataId)]})})},e.prototype.dataSync=function(){return this.throwIfDisposed(),u.ENV.engine.readSync(this.dataId)},e.prototype.dispose=function(){this.isDisposed||(this.isDisposed=!0,u.ENV.engine.disposeTensor(this))},e.prototype.throwIfDisposed=function(){if(this.isDisposed)throw new Error(\"Tensor is disposed.\")},e.prototype.toFloat=function(){return this.asType(\"float32\")},e.prototype.toInt=function(){return this.asType(\"int32\")},e.prototype.toBool=function(){return this.asType(\"bool\")},e.prototype.print=function(e){return void 0===e&&(e=!1),c.print(this,e)},e.prototype.reshape=function(e){return this.throwIfDisposed(),c.reshape(this,e)},e.prototype.reshapeAs=function(e){return this.throwIfDisposed(),this.reshape(e.shape)},e.prototype.expandDims=function(e){return void 0===e&&(e=0),c.expandDims(this,e)},e.prototype.squeeze=function(e){return this.throwIfDisposed(),c.squeeze(this,e)},e.prototype.clone=function(){return this.throwIfDisposed(),c.clone(this)},e.prototype.tile=function(e){return this.throwIfDisposed(),c.tile(this,e)},e.prototype.gather=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),c.gather(this,e)},e.prototype.matMul=function(e,t,n){return void 0===t&&(t=!1),void 0===n&&(n=!1),this.throwIfDisposed(),c.matMul(this,e,t,n)},e.prototype.norm=function(e,t,n){return void 0===e&&(e=\"euclidean\"),void 0===t&&(t=null),void 0===n&&(n=!1),this.throwIfDisposed(),c.norm(this,e,t,n)},e.prototype.slice=function(e,t){return this.throwIfDisposed(),c.slice(this,e,t)},e.prototype.reverse=function(e){return this.throwIfDisposed(),c.reverse(this,e)},e.prototype.concat=function(e,t){return void 0===t&&(t=0),this.throwIfDisposed(),c.concat([this,e],t)},e.prototype.stack=function(e,t){return void 0===t&&(t=0),c.stack([this,e],t)},e.prototype.pad=function(e,t){return void 0===t&&(t=0),c.pad(this,e,t)},e.prototype.batchNormalization=function(e,t,n,r,o){return void 0===n&&(n=.001),this.throwIfDisposed(),c.batchNormalization(this,e,t,n,r,o)},e.prototype.logSumExp=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),c.logSumExp(this,e,t)},e.prototype.sum=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),c.sum(this,e,t)},e.prototype.mean=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),c.mean(this,e,t)},e.prototype.min=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),c.min(this,e,t)},e.prototype.max=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=!1),this.throwIfDisposed(),c.max(this,e,t)},e.prototype.argMin=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),c.argMin(this,e)},e.prototype.argMax=function(e){return void 0===e&&(e=null),this.throwIfDisposed(),c.argMax(this,e)},e.prototype.add=function(e){return this.throwIfDisposed(),c.add(this,e)},e.prototype.addStrict=function(e){return this.throwIfDisposed(),c.addStrict(this,e)},e.prototype.sub=function(e){return this.throwIfDisposed(),c.sub(this,e)},e.prototype.subStrict=function(e){return this.throwIfDisposed(),c.subStrict(this,e)},e.prototype.pow=function(e){return this.throwIfDisposed(),c.pow(this,e)},e.prototype.powStrict=function(e){return this.throwIfDisposed(),c.powStrict(this,e)},e.prototype.mul=function(e){return this.throwIfDisposed(),c.mul(this,e)},e.prototype.mulStrict=function(e){return this.throwIfDisposed(),c.mulStrict(this,e)},e.prototype.div=function(e){return this.throwIfDisposed(),c.div(this,e)},e.prototype.divStrict=function(e){return this.throwIfDisposed(),c.divStrict(this,e)},e.prototype.minimum=function(e){return this.throwIfDisposed(),c.minimum(this,e)},e.prototype.minimumStrict=function(e){return this.throwIfDisposed(),c.minimumStrict(this,e)},e.prototype.maximum=function(e){return this.throwIfDisposed(),c.maximum(this,e)},e.prototype.maximumStrict=function(e){return this.throwIfDisposed(),c.maximumStrict(this,e)},e.prototype.transpose=function(e){return this.throwIfDisposed(),c.transpose(this,e)},e.prototype.notEqual=function(e){return this.throwIfDisposed(),c.notEqual(this,e)},e.prototype.notEqualStrict=function(e){return this.throwIfDisposed(),c.notEqualStrict(this,e)},e.prototype.less=function(e){return this.throwIfDisposed(),c.less(this,e)},e.prototype.lessStrict=function(e){return this.throwIfDisposed(),c.lessStrict(this,e)},e.prototype.equal=function(e){return this.throwIfDisposed(),c.equal(this,e)},e.prototype.equalStrict=function(e){return this.throwIfDisposed(),c.equalStrict(this,e)},e.prototype.lessEqual=function(e){return this.throwIfDisposed(),c.lessEqual(this,e)},e.prototype.lessEqualStrict=function(e){return this.throwIfDisposed(),c.lessEqualStrict(this,e)},e.prototype.greater=function(e){return this.throwIfDisposed(),c.greater(this,e)},e.prototype.greaterStrict=function(e){return this.throwIfDisposed(),c.greaterStrict(this,e)},e.prototype.greaterEqual=function(e){return this.throwIfDisposed(),c.greaterEqual(this,e)},e.prototype.greaterEqualStrict=function(e){return this.throwIfDisposed(),c.greaterEqualStrict(this,e)},e.prototype.logicalAnd=function(e){return this.throwIfDisposed(),c.logicalAnd(this,e)},e.prototype.logicalOr=function(e){return this.throwIfDisposed(),c.logicalOr(this,e)},e.prototype.logicalXor=function(e){return this.throwIfDisposed(),c.logicalXor(this,e)},e.prototype.where=function(e,t){return this.throwIfDisposed(),c.where(e,this,t)},e.prototype.neg=function(){return this.throwIfDisposed(),c.neg(this)},e.prototype.ceil=function(){return this.throwIfDisposed(),c.ceil(this)},e.prototype.floor=function(){return this.throwIfDisposed(),c.floor(this)},e.prototype.exp=function(){return this.throwIfDisposed(),c.exp(this)},e.prototype.log=function(){return this.throwIfDisposed(),c.log(this)},e.prototype.sqrt=function(){return this.throwIfDisposed(),c.sqrt(this)},e.prototype.square=function(){return this.throwIfDisposed(),c.square(this)},e.prototype.abs=function(){return this.throwIfDisposed(),c.abs(this)},e.prototype.clipByValue=function(e,t){return this.throwIfDisposed(),c.clipByValue(this,e,t)},e.prototype.relu=function(){return this.throwIfDisposed(),c.relu(this)},e.prototype.elu=function(){return this.throwIfDisposed(),c.elu(this)},e.prototype.selu=function(){return this.throwIfDisposed(),c.selu(this)},e.prototype.leakyRelu=function(e){return void 0===e&&(e=.2),this.throwIfDisposed(),c.leakyRelu(this,e)},e.prototype.prelu=function(e){return this.throwIfDisposed(),c.prelu(this,e)},e.prototype.sigmoid=function(){return this.throwIfDisposed(),c.sigmoid(this)},e.prototype.sin=function(){return this.throwIfDisposed(),c.sin(this)},e.prototype.cos=function(){return this.throwIfDisposed(),c.cos(this)},e.prototype.tan=function(){return this.throwIfDisposed(),c.tan(this)},e.prototype.asin=function(){return this.throwIfDisposed(),c.asin(this)},e.prototype.acos=function(){return this.throwIfDisposed(),c.acos(this)},e.prototype.atan=function(){return this.throwIfDisposed(),c.atan(this)},e.prototype.sinh=function(){return this.throwIfDisposed(),c.sinh(this)},e.prototype.cosh=function(){return this.throwIfDisposed(),c.cosh(this)},e.prototype.tanh=function(){return this.throwIfDisposed(),c.tanh(this)},e.prototype.step=function(e){return void 0===e&&(e=0),this.throwIfDisposed(),c.step(this,e)},e.prototype.softmax=function(e){return void 0===e&&(e=-1),this.throwIfDisposed(),c.softmax(this,e)},e.prototype.resizeBilinear=function(e,t){return void 0===t&&(t=!1),this.throwIfDisposed(),c.image.resizeBilinear(this,e,t)},e.prototype.conv1d=function(e,t,n,r){return this.throwIfDisposed(),c.conv1d(this,e,t,n,r)},e.prototype.conv2d=function(e,t,n,r){return this.throwIfDisposed(),c.conv2d(this,e,t,n,r)},e.prototype.conv2dTranspose=function(e,t,n,r,o){return this.throwIfDisposed(),c.conv2dTranspose(this,e,t,n,r,o)},e.prototype.depthwiseConv2D=function(e,t,n,r,o){return void 0===r&&(r=[1,1]),this.throwIfDisposed(),c.depthwiseConv2d(this,e,t,n,r,o)},e.prototype.avgPool=function(e,t,n,r){return this.throwIfDisposed(),c.avgPool(this,e,t,n,r)},e.prototype.maxPool=function(e,t,n,r){return this.throwIfDisposed(),c.maxPool(this,e,t,n,r)},e.prototype.minPool=function(e,t,n,r){return this.throwIfDisposed(),c.minPool(this,e,t,n,r)},e.prototype.localResponseNormalization=function(e,t,n,r,o){return void 0===e&&(e=5),void 0===t&&(t=1),void 0===n&&(n=1),void 0===r&&(r=.5),void 0===o&&(o=\"acrossChannels\"),c.localResponseNormalization(this,e,t,n,r,o)},e.prototype.variable=function(e,t,n){return void 0===e&&(e=!0),this.throwIfDisposed(),y.variable(this,e,t,n)},e.nextId=0,o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"flatten\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"asScalar\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"as1D\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"as2D\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"as3D\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"as4D\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"asType\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"buffer\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"data\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"dataSync\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"dispose\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"toFloat\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"toInt\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"toBool\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"print\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"reshape\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"reshapeAs\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"expandDims\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"squeeze\",null),o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e.prototype,\"clone\",null),e=t=o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],e);var t}();t.Tensor=h,t.NDArray=h;var d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.new=function(e,t){return c.scalar(e,t)},t}(h);t.Scalar=d;var f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.new=function(e,t){return c.tensor1d(e,t)},t}(h);t.Tensor1D=f,t.Array1D=f;var m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.new=function(e,t,n){return c.tensor2d(t,e,n)},t}(h);t.Tensor2D=m,t.Array2D=m;var v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.new=function(e,t,n){return c.tensor3d(t,e,n)},t}(h);t.Tensor3D=v,t.Array3D=v;var g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.new=function(e,t,n){return c.tensor4d(t,e,n)},t}(h);t.Tensor4D=g,t.Array4D=g;var y=function(e){function t(t,r,o){void 0===r&&(r=!0);var a=e.call(this,t.shape,t.dtype,null,t.dataId)||this;return a.trainable=r,a.name=o,null==a.name&&(a.name=n.nextVarId.toString(),n.nextVarId++),u.ENV.engine.registerVariable(a),a}return r(t,e),n=t,t.variable=function(e,t,r,o){return void 0===t&&(t=!0),null!=o&&o!==e.dtype&&(e=e.asType(o)),new n(e,t,r)},t.prototype.assign=function(e){if(e.dtype!==this.dtype)throw new Error(\"dtype of the new value (\"+e.dtype+\") and previous value (\"+this.dtype+\") must match\");if(!l.arraysEqual(e.shape,this.shape))throw new Error(\"shape of the new value (\"+e.shape+\") and previous value (\"+this.shape+\") must match\");u.ENV.engine.disposeTensor(this),this.dataId=e.dataId,u.ENV.engine.registerTensor(this)},t.nextVarId=0,o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],t.prototype,\"assign\",null),o([s.doc({heading:\"Tensors\",subheading:\"Creation\"})],t,\"variable\",null),t=n=o([s.doc({heading:\"Tensors\",subheading:\"Classes\"})],t);var n}(h);t.Variable=y;var b=y.variable;function x(e){var t=e.length;if(t<2)return[];var n=new Array(t-1);n[t-2]=e[t-1];for(var r=t-3;r>=0;--r)n[r]=n[r+1]*e[r+1];return n}t.variable=b},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(92),o=n(38);t.tidy=o.Tracking.tidy,t.keep=o.Tracking.keep,t.time=o.Tracking.time,t.grad=r.Gradients.grad,t.valueAndGrad=r.Gradients.valueAndGrad,t.grads=r.Gradients.grads,t.valueAndGrads=r.Gradients.valueAndGrads,t.variableGrads=r.Gradients.variableGrads,t.customGrad=r.Gradients.customGrad},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.doc=function(e){return function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(39),o=n(41),a=n(42),i=n(43),s=n(40),u=n(44),c=n(45),l=n(46),p=n(47),h=n(48),d=n(49),f=n(51),m=n(52),v=n(53),g=n(54),y=n(55),b=n(56),x=n(57),w=n(58);t.batchNormalization=o.Ops.batchNormalization,t.batchNormalization2d=o.Ops.batchNormalization2d,t.batchNormalization3d=o.Ops.batchNormalization3d,t.batchNormalization4d=o.Ops.batchNormalization4d,t.concat=s.Concat.concat,t.concat1d=s.Concat.concat1d,t.concat2d=s.Concat.concat2d,t.concat3d=s.Concat.concat3d,t.concat4d=s.Concat.concat4d,t.conv1d=u.Ops.conv1d,t.conv2d=u.Ops.conv2d,t.conv2dTranspose=u.Ops.conv2dTranspose,t.depthwiseConv2d=u.Ops.depthwiseConv2d,t.matMul=d.Ops.matMul,t.matrixTimesVector=d.Ops.matrixTimesVector,t.outerProduct=d.Ops.outerProduct,t.vectorTimesMatrix=d.Ops.vectorTimesMatrix,t.avgPool=m.Ops.avgPool,t.maxPool=m.Ops.maxPool,t.minPool=m.Ops.minPool,t.transpose=x.Ops.transpose,t.reverse=g.Ops.reverse,t.reverse1d=g.Ops.reverse1d,t.reverse2d=g.Ops.reverse2d,t.reverse3d=g.Ops.reverse3d,t.reverse4d=g.Ops.reverse4d,t.slice=y.Ops.slice,t.slice1d=y.Ops.slice1d,t.slice2d=y.Ops.slice2d,t.slice3d=y.Ops.slice3d,t.slice4d=y.Ops.slice4d,t.argMax=v.Ops.argMax,t.argMin=v.Ops.argMin,t.logSumExp=v.Ops.logSumExp,t.max=v.Ops.max,t.mean=v.Ops.mean,t.min=v.Ops.min,t.moments=v.Ops.moments,t.sum=v.Ops.sum,t.equal=i.Ops.equal,t.equalStrict=i.Ops.equalStrict,t.greater=i.Ops.greater,t.greaterStrict=i.Ops.greaterStrict,t.greaterEqual=i.Ops.greaterEqual,t.greaterEqualStrict=i.Ops.greaterEqualStrict,t.less=i.Ops.less,t.lessStrict=i.Ops.lessStrict,t.lessEqual=i.Ops.lessEqual,t.lessEqualStrict=i.Ops.lessEqualStrict,t.notEqual=i.Ops.notEqual,t.notEqualStrict=i.Ops.notEqualStrict,t.logicalNot=l.Ops.logicalNot,t.logicalAnd=l.Ops.logicalAnd,t.logicalOr=l.Ops.logicalOr,t.logicalXor=l.Ops.logicalXor,t.where=l.Ops.where,t.abs=w.Ops.abs,t.acos=w.Ops.acos,t.asin=w.Ops.asin,t.atan=w.Ops.atan,t.ceil=w.Ops.ceil,t.clipByValue=w.Ops.clipByValue,t.cos=w.Ops.cos,t.cosh=w.Ops.cosh,t.elu=w.Ops.elu,t.exp=w.Ops.exp,t.floor=w.Ops.floor,t.leakyRelu=w.Ops.leakyRelu,t.log=w.Ops.log,t.neg=w.Ops.neg,t.prelu=w.Ops.prelu,t.relu=w.Ops.relu,t.selu=w.Ops.selu,t.sigmoid=w.Ops.sigmoid,t.sin=w.Ops.sin,t.sinh=w.Ops.sinh,t.sqrt=w.Ops.sqrt,t.square=w.Ops.square,t.step=w.Ops.step,t.tan=w.Ops.tan,t.tanh=w.Ops.tanh,t.add=a.Ops.add,t.addStrict=a.Ops.addStrict,t.div=a.Ops.div,t.divStrict=a.Ops.divStrict,t.maximum=a.Ops.maximum,t.maximumStrict=a.Ops.maximumStrict,t.minimum=a.Ops.minimum,t.minimumStrict=a.Ops.minimumStrict,t.mul=a.Ops.mul,t.mulStrict=a.Ops.mulStrict,t.pow=a.Ops.pow,t.powStrict=a.Ops.powStrict,t.sub=a.Ops.sub,t.subStrict=a.Ops.subStrict,t.norm=f.Ops.norm,t.cast=r.Ops.cast,t.clone=r.Ops.clone,t.fromPixels=r.Ops.fromPixels,t.ones=r.Ops.ones,t.onesLike=r.Ops.onesLike,t.zeros=r.Ops.zeros,t.zerosLike=r.Ops.zerosLike,t.rand=r.Ops.rand,t.randomNormal=r.Ops.randomNormal,t.truncatedNormal=r.Ops.truncatedNormal,t.randomUniform=r.Ops.randomUniform,t.reshape=r.Ops.reshape,t.squeeze=r.Ops.squeeze,t.tile=r.Ops.tile,t.gather=r.Ops.gather,t.oneHot=r.Ops.oneHot,t.linspace=r.Ops.linspace,t.range=r.Ops.range,t.buffer=r.Ops.buffer,t.fill=r.Ops.fill,t.tensor=r.Ops.tensor,t.scalar=r.Ops.scalar,t.tensor1d=r.Ops.tensor1d,t.tensor2d=r.Ops.tensor2d,t.tensor3d=r.Ops.tensor3d,t.tensor4d=r.Ops.tensor4d,t.print=r.Ops.print,t.expandDims=r.Ops.expandDims,t.stack=r.Ops.stack,t.pad=r.Ops.pad,t.pad1d=r.Ops.pad1d,t.pad2d=r.Ops.pad2d,t.basicLSTMCell=h.Ops.basicLSTMCell,t.multiRNNCell=h.Ops.multiRNNCell,t.softmax=b.Ops.softmax,t.localResponseNormalization=p.LRN.localResponseNormalization;var E=n(2),T=n(20);E.Tensor,T.Rank,E.Tensor3D,E.Tensor4D,t.losses={softmaxCrossEntropy:b.Ops.softmaxCrossEntropy},t.image={resizeBilinear:c.Ops.resizeBilinear}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(3);t.operation=function(e,t,n){var o=n.value;return n.value=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return r.tidy(t,function(){return o.apply(void 0,e)})},n}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){function e(){}return e.prototype.disposeTransientArrays=function(e,t){},e.prototype.dispose=function(){},e}();t.Operation=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(22),o=n(74),a=n(74);t.getUnorderedEvaluationSet=function(e,t){var n={},r={},o=[],a=e.slice();t.forEach(function(e){return n[e.id]=e});for(var i=function(){var e=a.pop();null==r[e.id]&&(null==n[e.id]&&Object.keys(e.inputs).map(function(t){return e.inputs[t]}).forEach(function(e){return a.push(e.node)}),o.push(e),r[e.id]=e)};0!==a.length;)i();return o},t.getOrderedEvaluationSet=function(e){var t=[],n={},r={},i=new a.PriorityQueue(function(e,t){return o.defaultCompare(r[e.id],r[t.id])},function(e,t){return n[e.id]=t});for(e.forEach(function(e){return r[e.id]=0}),e.forEach(function(t){return Object.keys(t.inputs).map(function(e){return t.inputs[e]}).forEach(function(t){-1!==e.indexOf(t.node)&&r[t.node.id]++})}),e.forEach(function(e){return i.enqueue(e)});!i.empty();)t.unshift(i.dequeue()),Object.keys(t[0].inputs).map(function(e){return t[0].inputs[e]}).forEach(function(t){-1!==e.indexOf(t.node)&&(r[t.node.id]--,i.update(t.node,n[t.node.id]))});return t},t.isInputNode=function(e){return 0===Object.keys(e.inputs).length},t.shouldBackProp=function(e){return!(e.node instanceof r.ConstantNode)},t.isPassthroughNode=function(e,t){for(var n=Object.keys(e.inputs),r=0;r<n.length;r++){var o=e.inputs[n[r]];if(t.get(o,!0)===t.get(e.output,!0))return!0}return!1}},function(e,t){e.exports=function(){throw new Error(\"define cannot be used indirect\")}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=function(){function e(){this.dict={}}return e.prototype.get=function(e,t){if(void 0===t&&(t=!1),!t&&void 0===this.dict[e.id])throw new Error(\"tensor \"+e.id+\" not in array map.\");var n=this.dict[e.id];if(!t&&null===n)throw new Error(\"tensor \"+e.id+\" has null array.\");return n},e.prototype.delete=function(e){delete this.dict[e.id]},e.prototype.nullify=function(e){this.dict[e.id]=null},e.prototype.disposeArray=function(e){if(void 0!==this.dict[e.id]){var t=this.dict[e.id];null!==t&&(t.dispose(),this.dict[e.id]=null)}},e.prototype.size=function(){return Object.keys(this.dict).length},e.prototype.dispose=function(){var e=this;Object.keys(this.dict).forEach(function(t){var n=e.dict[+t];n&&n.dispose()}),this.dict={}},e.prototype.hasNullArray=function(e){if(void 0===this.dict[e.id])throw new Error(\"tensor \"+e.id+\" not in array map.\");return null===this.dict[e.id]},e}();t.TensorArrayMapBase=o;var a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.set=function(e,t){this.dict[e.id]=t},t}(o);t.TensorArrayMap=a;var i=function(e){function t(t){var n=e.call(this)||this;return n.math=t,n}return r(t,e),t.prototype.add=function(e,t){if(null==this.dict[e.id])this.dict[e.id]=this.math.keep(t);else{var n=this.get(e),r=this.math.keep(this.math.addStrict(n,t));this.dict[e.id]=r,n.dispose()}},t}(o);t.SummedTensorArrayMap=i},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,\"loaded\",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,\"id\",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.getBroadcastDims=function(e,t){for(var n=e.length,r=[],o=0;o<n;o++){var a=n-1-o,i=e[a]||1;(t[t.length-1-o]||1)>1&&1===i&&r.unshift(a)}return r},t.getReductionAxes=function(e,t){for(var n=[],r=0;r<t.length;r++){var o=e[e.length-r-1],a=t.length-r-1,i=t[a];(null==o||1===o&&i>1)&&n.unshift(a)}return n},t.broadcastDimsAreOuter=function(e){for(var t=0;t<e.length;t++)if(e[t]!==t)return!1;return!0},t.assertAndGetBroadcastShape=function(e,t){for(var n=[],r=\"Operands could not be broadcast together with shapes \"+e+\" and \"+t+\".\",o=Math.max(e.length,t.length),a=0;a<o;a++){var i=e[e.length-a-1]||1,s=t[t.length-a-1]||1;if(i>1&&s>1&&i!==s)throw Error(r);n.unshift(Math.max(i,s))}return n}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(0);function o(e,t){for(var n=0;n<e.length;++n)if(e[e.length-n-1]!==t-1-n)return!1;return!0}function a(e,t,n){for(var r=e.length+t.length,o=[],a=0,i=0,s=0;s<r;s++)-1===n.indexOf(s)?o.push(e[a++]):o.push(t[i++]);return o}t.axesAreInnerMostDims=o,t.combineLocations=a,t.computeOutAndReduceShapes=function(e,t){for(var n=[],r=e.length,o=0;o<r;o++)-1===t.indexOf(o)&&n.push(e[o]);return[n,t.map(function(t){return e[t]})]},t.expandShapeToKeepDim=function(e,t){return a(e,t.map(function(e){return 1}),t)},t.parseAxisParam=function(e,t){var n=t.length;return e=null==e?t.map(function(e,t){return t}):[].concat(e),r.assert(e.every(function(e){return e>=-n&&e<n}),\"All values in axis param must be in range [-\"+n+\", \"+n+\") but got axis \"+e),r.assert(e.every(function(e){return r.isInt(e)}),\"All values in axis param must be integers but got axis \"+e),e.map(function(e){return e<0?n+e:e})},t.assertAxesAreInnerMostDims=function(e,t,n){r.assert(o(t,n),e+\" supports only inner-most axes for now. Got axes \"+t+\" and rank-\"+n+\" input.\")},t.getAxesPermutation=function(e,t){if(o(e,t))return null;for(var n=[],r=0;r<t;++r)-1===e.indexOf(r)&&n.push(r);return e.forEach(function(e){return n.push(e)}),n},t.getUndoAxesPermutation=function(e){return e.map(function(e,t){return[t,e]}).sort(function(e,t){return e[1]-t[1]}).map(function(e){return e[0]})},t.getInnerMostAxes=function(e,t){for(var n=[],r=t-e;r<t;++r)n.push(r);return n}},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(3),i=n(30),s=n(10),u=n(5),c=n(2),l=function(){function e(e,t){this.learningRate=e,this.variableGradients=new s.TensorArrayMap,null!=t&&(this.specifiedVariableNodes=t)}return e.prototype.minimize=function(e,t,n){void 0===t&&(t=!1);var r=this.computeGradients(e,n),o=r.value,a=r.grads;return this.applyGradients(a),Object.keys(a).forEach(function(e){return a[e].dispose()}),t?o:(o.dispose(),null)},e.prototype.computeGradients=function(e,t){return a.variableGrads(e,t)},e.prototype.beforeBatch=function(e,t,n,r,o){var a=this;this.variableNodes=null==this.specifiedVariableNodes?i.getVariableNodesFromEvaluationSet(n.nodes):this.specifiedVariableNodes,t!==this.prevBatchSize&&(null!=this.cGraph&&this.cGraph.dispose(),this.prevBatchSize=t,this.cGraph=e.keep(u.scalar(-this.learningRate/t))),this.variableNodes.forEach(function(t){return a.variableGradients.set(t.output,e.keep(c.Tensor.zeros(t.output.shape)))})},e.prototype.afterExample=function(e,t,n,r){var o=this;a.tidy(function(){o.variableNodes.forEach(function(t){var n=r.get(t.output),i=o.variableGradients.get(t.output);o.variableGradients.set(t.output,a.keep(e.add(n,i))),i.dispose()})})},e.prototype.dispose=function(){null!=this.cGraph&&this.cGraph.dispose(),null!=this.variableNodes&&this.variableNodes.forEach(function(e){e.data.dispose()}),null!=this.specifiedVariableNodes&&this.specifiedVariableNodes.forEach(function(e){e.data.dispose()})},r([o.doc({heading:\"Training\",subheading:\"Optimizers\"})],e.prototype,\"minimize\",null),e=r([o.doc({heading:\"Training\",subheading:\"Classes\",namespace:\"train\"})],e)}();t.Optimizer=l},function(e,t){(function(t){e.exports=t}).call(this,{})},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(0);function o(e,t,n,r,o,i,u){void 0===i&&(i=!1),void 0===u&&(u=\"channelsLast\");var c=[-1,-1,-1,-1],l=c[0],p=c[1],h=c[2],d=c[3];if(\"channelsLast\"===u)l=e[0],p=e[1],h=e[2],d=e[3];else{if(\"channelsFirst\"!==u)throw new Error(\"Unknown dataFormat \"+u);l=e[0],d=e[1],p=e[2],h=e[3]}var f,m=t[0],v=t[1],g=t[3],y=s(n),b=y[0],x=y[1],w=function(e,t,n,r,o,i,s,u){var c,l,p;if(\"number\"==typeof e){c={top:e,bottom:e,left:e,right:e};var h=a([t,n,1],i,1,r,e,u);l=h[0],p=h[1]}else if(\"same\"===e){l=Math.ceil(t/r),p=Math.ceil(n/o);var d=(l-1)*r+i-t,f=(p-1)*o+s-n,m=Math.floor(d/2),v=d-m,g=Math.floor(f/2),y=f-g;c={top:m,bottom:v,left:g,right:y}}else{if(\"valid\"!==e)throw Error(\"Unknown padding parameter: \"+e);c={top:0,bottom:0,left:0,right:0},l=Math.ceil((t-i+1)/r),p=Math.ceil((n-s+1)/o)}return{padInfo:c,outHeight:l,outWidth:p}}(r,p,h,b,x,m,v,o),E=w.padInfo,T=w.outHeight,k=w.outWidth,S=i?g*d:g;return\"channelsFirst\"===u?f=[l,S,T,k]:\"channelsLast\"===u&&(f=[l,T,k,S]),{batchSize:l,dataFormat:u,inHeight:p,inWidth:h,inChannels:d,outHeight:T,outWidth:k,outChannels:S,padInfo:E,strideHeight:b,strideWidth:x,filterHeight:m,filterWidth:v,inShape:e,outShape:f,filterShape:t}}function a(e,t,n,o,a,s){null==a&&(a=i(e,t,o));var c=e[0],l=e[1],p=u((c-t+2*a)/o+1,s);r.assert(r.isInt(p),\"The output # of rows (\"+p+\") must be an integer. Change the stride and/or zero pad parameters\");var h=u((l-t+2*a)/o+1,s);return r.assert(r.isInt(h),\"The output # of columns (\"+h+\") must be an integer. Change the stride and/or zero pad parameters\"),[p,h,n]}function i(e,t,n){return Math.floor((e[0]*(n-1)-n+t)/2)}function s(e){return\"number\"==typeof e?[e,e]:e}function u(e,t){if(!t)return e;switch(t){case\"round\":return Math.round(e);case\"ceil\":return Math.ceil(e);case\"floor\":return Math.floor(e);default:throw new Error(\"Unknown roundingMode \"+t)}}t.computePool2DInfo=function(e,t,n,r,a,i){void 0===i&&(i=\"channelsLast\");var u,c=s(t),l=c[0],p=c[1];if(\"channelsLast\"===i)u=[l,p,e[3],e[3]];else{if(\"channelsFirst\"!==i)throw new Error(\"Unknown dataFormat \"+i);u=[l,p,e[1],e[1]]}return o(e,u,n,r,a,!1,i)},t.computeConv2DInfo=o,t.computeOutputShape3D=a,t.computeDefaultPad=i,t.computeWeightsShape4D=function(e,t,n,r){return[n,r,e,t]},t.computeDilatedRC=function(e,t){return[(e[0]-1)*t+1,(e[1]-1)*t+1]}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(24),s=n(99),u=n(59);function c(e){return new d(e)}function l(e){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,w.create(e)]})})}t.streamFromItems=function(e){return new h(e)},t.streamFromIncrementing=function(e){var t=e;return c(function(){return t++})},t.streamFromFunction=c,t.streamFromConcatenated=l,t.streamFromConcatenatedFunction=function(e,t){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,l(c(e).take(t))]})})};var p=function(){function e(){}return e.prototype.collectRemaining=function(){return o(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return e=[],[4,this.next()];case 1:t=n.sent(),n.label=2;case 2:return null==t?[3,4]:(e.push(t),[4,this.next()]);case 3:return t=n.sent(),[3,2];case 4:return[2,e]}})})},e.prototype.resolveFully=function(){return o(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return[4,this.next()];case 1:e=t.sent(),t.label=2;case 2:return null==e?[3,4]:[4,this.next()];case 3:return e=t.sent(),[3,2];case 4:return[2]}})})},e.prototype.filter=function(e){return new y(this,e)},e.prototype.map=function(e){return new b(this,e)},e.prototype.forEach=function(e){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,this.map(e).resolveFully()]})})},e.prototype.batch=function(e,t){return void 0===t&&(t=!0),new g(this,e,t)},e.prototype.concatenate=function(e){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,w.create(new h([this,e]))]})})},e.prototype.take=function(e){return e<0||null==e?this:new m(this,e)},e.prototype.skip=function(e){return e<0||null==e?this:new f(this,e)},e.prototype.prefetch=function(e){return new E(this,e)},e.prototype.shuffle=function(e,t){return new T(this,e,t)},e}();t.DataStream=p;var h=function(e){function t(t){var n=e.call(this)||this;return n.items=t,n.trav=0,n}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){var e;return a(this,function(t){return this.trav>=this.items.length?[2,void 0]:(e=this.items[this.trav],this.trav++,[2,e])})})},t}(p),d=function(e){function t(t){var n=e.call(this)||this;return n.nextFn=t,n}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,this.nextFn()]})})},t}(p),f=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.maxCount=n,r.count=0,r}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.count++<this.maxCount?[4,this.upstream.next()]:[3,2];case 1:return null==e.sent()?[2,void 0]:[3,0];case 2:return[2,this.upstream.next()]}})})},t}(p),m=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.maxCount=n,r.count=0,r}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){return a(this,function(e){return this.count++>=this.maxCount?[2,void 0]:[2,this.upstream.next()]})})},t}(p),v=function(e){function t(){var t=e.call(this)||this;return t.outputQueue=new s.GrowingRingBuffer,t}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return 0!==this.outputQueue.length()?[3,2]:[4,this.pump()];case 1:return e.sent()?[3,0]:[2,void 0];case 2:return[2,this.outputQueue.shift()]}})})},t}(p);t.QueueStream=v;var g=function(e){function t(t,n,r){void 0===r&&(r=!0);var o=e.call(this)||this;return o.upstream=t,o.batchSize=n,o.enableSmallLastBatch=r,o.currentBatch=[],o}return r(t,e),t.prototype.pump=function(){return o(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return[4,this.upstream.next()];case 1:return null==(e=t.sent())?this.enableSmallLastBatch&&this.currentBatch.length>0?(this.outputQueue.push(this.currentBatch),this.currentBatch=[],[2,!0]):[2,!1]:(this.currentBatch.push(e),this.currentBatch.length===this.batchSize&&(this.outputQueue.push(this.currentBatch),this.currentBatch=[]),[2,!0])}})})},t}(v),y=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.predicate=n,r}return r(t,e),t.prototype.pump=function(){return o(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return[4,this.upstream.next()];case 1:return null==(e=n.sent())?[2,!1]:(t=this.predicate(e))instanceof Promise?[4,t]:[3,3];case 2:t=n.sent(),n.label=3;case 3:return t&&this.outputQueue.push(e),[2,!0]}})})},t}(v),b=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.transform=n,r}return r(t,e),t.prototype.pump=function(){return o(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return[4,this.upstream.next()];case 1:return null==(e=n.sent())?[2,!1]:(t=this.transform(e))instanceof Promise?[4,t]:[3,3];case 2:t=n.sent(),n.label=3;case 3:return this.outputQueue.push(t),[2,!0]}})})},t}(v),x=function(){return function(e,t,n){this.item=e,this.currentStream=t,this.moreStreams=n}}();var w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.create=function(e){return o(this,void 0,void 0,function(){var n,r;return a(this,function(o){switch(o.label){case 0:return n=new t,[4,e.next()];case 1:return r=o.sent(),n.currentPromise=Promise.resolve(new x(void 0,r,e)),[2,n]}})})},t.prototype.next=function(){return o(this,void 0,void 0,function(){return a(this,function(e){switch(e.label){case 0:return this.currentPromise=function e(t){return o(this,void 0,void 0,function(){var n,r,o;return a(this,function(a){switch(a.label){case 0:return[4,t];case 1:return n=a.sent(),null==(r=n.currentStream)?[2,new x(void 0,void 0,n.moreStreams)]:[4,r.next()];case 2:return null!=(o=a.sent())?[3,4]:[4,n.moreStreams.next()];case 3:return r=a.sent(),[2,e(Promise.resolve(new x(void 0,r,n.moreStreams)))];case 4:return[2,new x(o,r,n.moreStreams)]}})})}(this.currentPromise),[4,this.currentPromise];case 1:return[2,e.sent().item]}})})},t}(p);t.ChainedStream=w;var E=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.bufferSize=n,r.total=0,r.buffer=new u.RingBuffer(n),r}return r(t,e),t.prototype.refill=function(){for(;!this.buffer.isFull();){var e=this.upstream.next();if(null==e)return;this.buffer.push(e)}},t.prototype.next=function(){return o(this,void 0,void 0,function(){var e;return a(this,function(t){switch(t.label){case 0:return this.refill(),this.buffer.isEmpty()?[2,void 0]:[4,this.buffer.shift()];case 1:return e=t.sent(),this.refill(),[2,e]}})})},t}(p);t.PrefetchStream=E;var T=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o.upstream=t,o.windowSize=n,o.upstreamExhausted=!1,o.random=i(r),o}return r(t,e),t.prototype.randomInt=function(e){return Math.floor(this.random()*e)},t.prototype.chooseIndex=function(){return this.randomInt(this.buffer.length())},t.prototype.next=function(){return o(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:this.upstreamExhausted||this.refill(),n.label=1;case 1:return this.buffer.isEmpty()?[3,3]:(e=this.chooseIndex(),[4,this.buffer.shuffleExcise(e)]);case 2:return null!=(t=n.sent())?(this.refill(),[2,t]):(this.upstreamExhausted=!0,[3,1]);case 3:return[2,void 0]}})})},t}(E);t.ShuffleStream=T},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(1),o=n(0),a=n(12),i=n(21);function s(e){var t=e.shapeInfo.logicalShape;switch(t.length){case 0:return function(e){var t=e.name;return\"\\n    float get\"+t.charAt(0).toUpperCase()+t.slice(1)+\"() {\\n      return sample(\"+t+\", halfCR);\\n    }\\n  \"}(e);case 1:return function(e){var t=e.name,n=\"get\"+t.charAt(0).toUpperCase()+t.slice(1);return\"\\n    float \"+n+\"(int index) {\\n      return \"+n+\"Flat(index);\\n    }\\n  \"}(e);case 2:return function(e){var t=e.shapeInfo.logicalShape,n=e.shapeInfo.texShape,r=e.name,a=\"get\"+r.charAt(0).toUpperCase()+r.slice(1),i=n[0],u=n[1];if(o.arraysEqual(t,n))return\"\\n    float \"+a+\"(int row, int col) {\\n      vec2 uv = (vec2(col, row) + halfCR) / vec2(\"+u+\".0, \"+i+\".0);\\n      return sample(\"+r+\", uv);\\n    }\\n  \";var c=o.squeezeShape(t),l=c.newShape,p=c.keptDims,h=l;if(h.length<t.length){var m=d(e,h);return\"\\n      \"+s(m)+\"\\n      float \"+a+\"(int row, int col) {\\n        return \"+a+\"(\"+f([\"row\",\"col\"],p)+\");\\n      }\\n    \"}if(1===u)return\"\\n    float \"+a+\"(int row, int col) {\\n      int index = row * \"+t[1]+\" + col;\\n      vec2 uv = vec2(0.5, (float(index) + 0.5) / \"+i+\".0);\\n      return sample(\"+r+\", uv);\\n    }\\n  \";if(1===i)return\"\\n    float \"+a+\"(int row, int col) {\\n      int index = row * \"+t[1]+\" + col;\\n      vec2 uv = vec2((float(index) + 0.5) / \"+u+\".0, 0.5);\\n      return sample(\"+r+\", uv);\\n    }\\n  \";return\"\\n  float \"+a+\"(int row, int col) {\\n    vec2 uv = UVfrom2D(\"+i+\", \"+u+\", \"+t[1]+\", row, col);\\n    return sample(\"+r+\", uv);\\n  }\\n\"}(e);case 3:return function(e){var t=e.shapeInfo.texShape,n=e.shapeInfo.logicalShape,r=e.name,a=\"get\"+r.charAt(0).toUpperCase()+r.slice(1),i=t[0],u=t[1],c=n[1]*n[2],l=n[2],p=o.squeezeShape(n),h=p.newShape,m=p.keptDims,v=h;if(v.length<n.length){var g=d(e,v);return\"\\n        \"+s(g)+\"\\n        float \"+a+\"(int row, int col, int depth) {\\n          return \"+a+\"(\"+f([\"row\",\"col\",\"depth\"],m)+\");\\n        }\\n      \"}if(u===c)return\"\\n        float \"+a+\"(int row, int col, int depth) {\\n          int texR = row;\\n          int texC = col * \"+l+\" + depth;\\n          vec2 uv = (vec2(texC, texR) + halfCR) /\\n                     vec2(\"+u+\".0, \"+i+\".0);\\n          return sample(\"+r+\", uv);\\n        }\\n      \";if(u===l)return\"\\n    float \"+a+\"(int row, int col, int depth) {\\n      int texR = row * \"+n[1]+\" + col;\\n      int texC = depth;\\n      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(\"+u+\".0, \"+i+\".0);\\n      return sample(\"+r+\", uv);\\n    }\\n  \";return\"\\n      float \"+a+\"(int row, int col, int depth) {\\n        vec2 uv = UVfrom3D(\\n            \"+i+\", \"+u+\", \"+c+\", \"+l+\", row, col, depth);\\n        return sample(\"+r+\", uv);\\n      }\\n  \"}(e);case 4:return function(e){var t=e.shapeInfo.logicalShape,n=e.shapeInfo.texShape,r=e.name,a=\"get\"+r.charAt(0).toUpperCase()+r.slice(1),i=n[0],u=n[1],c=t[3],l=t[2]*c,p=t[1]*l,h=o.squeezeShape(t),m=h.newShape,v=h.keptDims;if(m.length<t.length){var g=d(e,m);return\"\\n      \"+s(g)+\"\\n      float \"+a+\"(int row, int col, int depth, int depth2) {\\n        return \"+a+\"(\"+f([\"row\",\"col\",\"depth\",\"depth2\"],v)+\");\\n      }\\n    \"}if(u===p)return\"\\n      float \"+a+\"(int row, int col, int depth, int depth2) {\\n        int texR = row;\\n        int texC = col * \"+l+\" + depth * \"+c+\" + depth2;\\n        vec2 uv = (vec2(texC, texR) + halfCR) /\\n                   vec2(\"+u+\".0, \"+i+\".0);\\n        return sample(\"+r+\", uv);\\n      }\\n    \";if(u===c)return\"\\n      float \"+a+\"(int row, int col, int depth, int depth2) {\\n        int texR = row * \"+t[1]*t[2]+\" + col * \"+t[2]+\" + depth;\\n        int texC = depth2;\\n        vec2 uv = (vec2(texC, texR) + halfCR) /\\n                  vec2(\"+u+\".0, \"+i+\".0);\\n        return sample(\"+r+\", uv);\\n      }\\n    \";return\"\\n    float \"+a+\"(int row, int col, int depth, int depth2) {\\n      vec2 uv = UVfrom4D(\"+i+\", \"+u+\", \"+p+\", \"+l+\",\\n          \"+c+\", row, col, depth, depth2);\\n      return sample(\"+r+\", uv);\\n    }\\n  \"}(e);default:throw new Error(t.length+\"-D input sampling is not yet supported\")}}t.makeShader=function(e,t,n,i){var d=r.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")?l:u,f=r.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")?p:c,m=e.map(function(e){return\"uniform sampler2D \"+e.name+\";\"}).join(\"\\n\"),v=e.map(function(e){return function(e,t,n){var r=function(e){var t=e.name,n=e.shapeInfo.texShape,r=\"get\"+t.charAt(0).toUpperCase()+t.slice(1)+\"Flat\",o=n[0],a=n[1];return 1===a&&1===o?\"\\n      float \"+r+\"(int index) {\\n        return sample(\"+t+\", halfCR);\\n      }\\n    \":1===a?\"\\n      float \"+r+\"(int index) {\\n        vec2 uv = vec2(0.5, (float(index) + 0.5) / \"+o+\".0);\\n        return sample(\"+t+\", uv);\\n      }\\n    \":1===o?\"\\n      float \"+r+\"(int index) {\\n        vec2 uv = vec2((float(index) + 0.5) / \"+a+\".0, 0.5);\\n        return sample(\"+t+\", uv);\\n      }\\n    \":\"\\n    float \"+r+\"(int index) {\\n      vec2 uv = UVfrom1D(\"+o+\", \"+a+\", index);\\n      return sample(\"+t+\", uv);\\n    }\\n  \"}(e);return r+=s(e),(n||o.arraysEqual(e.shapeInfo.logicalShape,t.logicalShape))&&(r+=function(e,t,n){var r=e.shapeInfo.texShape,i=e.name,s=i.charAt(0).toUpperCase()+i.slice(1),u=\"get\"+s+\"AtOutCoords\",c=a.getBroadcastDims(e.shapeInfo.logicalShape,t.logicalShape),l=e.shapeInfo.logicalShape.length,p=t.logicalShape.length,h=n&&(p>l||c.length>0),d=a.broadcastDimsAreOuter(c);if(h&&!d)return function(e,t,n,r){var o=e.shapeInfo.logicalShape.length,i=t.logicalShape.length,s=\"int\";2===i?s=\"ivec2\":3===i?s=\"ivec3\":4===i&&(s=\"ivec4\");var u,c=a.getBroadcastDims(e.shapeInfo.logicalShape,t.logicalShape),l=i-o;u=0===o?\"\":i<2&&c.length>=1?\"coords = 0;\":c.map(function(e){return\"coords[\"+(e+l)+\"] = 0;\"}).join(\"\\n\");var p=\"\";return p=i<2&&o>0?\"coords\":e.shapeInfo.logicalShape.map(function(e,t){return\"coords[\"+(t+l)+\"]\"}).join(\", \"),\"\\n    float \"+r+\"() {\\n      \"+s+\" coords = getOutputCoords();\\n      \"+u+\"\\n      return get\"+n+\"(\"+p+\");\\n    }\\n  \"}(e,t,s,u);var f=t.texShape;if(o.arraysEqual(r,f))return\"\\n      float \"+u+\"() {\\n        return sample(\"+i+\", resultUV);\\n      }\\n    \";var m=o.sizeFromShape(r),v=\"\";return h&&d&&(v=\"\\n        int mainPart = index / \"+m+\";\\n        index -= mainPart * \"+m+\";\\n      \"),\"\\n    float \"+u+\"() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+f[0]+\", \"+f[1]+\"));\\n      int index = resTexRC.x * \"+f[1]+\" + resTexRC.y;\\n      \"+v+\"\\n      int texR = index / \"+r[1]+\";\\n      int texC = index - texR * \"+r[1]+\";\\n      vec2 uv = (vec2(texC, texR) + halfCR) /\\n                 vec2(\"+r[1]+\".0, \"+r[0]+\".0);\\n\\n      return sample(\"+i+\", uv);\\n    }\\n  \"}(e,t,n)),r}(e,t,i)}).join(\"\\n\"),g=t.texShape,y=function(e,t){switch(e.length){case 0:return\"\\n    int getOutputCoords() {\\n      return 0;\\n    }\\n  \";case 1:return function(e,t){return 1===t[0]?\"\\n      int getOutputCoords() {\\n        return int(resultUV.x * \"+t[1]+\".0);\\n      }\\n    \":1===t[1]?\"\\n      int getOutputCoords() {\\n        return int(resultUV.y * \"+t[0]+\".0);\\n      }\\n    \":\"\\n    int getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+t[0]+\", \"+t[1]+\"));\\n      return resTexRC.x * \"+t[1]+\" + resTexRC.y;\\n    }\\n  \"}(0,t);case 2:return function(e,t){return o.arraysEqual(e,t)?\"\\n      ivec2 getOutputCoords() {\\n        return ivec2(resultUV.yx * vec2(\"+t[0]+\", \"+t[1]+\"));\\n      }\\n    \":1===e[1]?\"\\n      ivec2 getOutputCoords() {\\n        ivec2 resTexRC = ivec2(resultUV.yx *\\n                               vec2(\"+t[0]+\", \"+t[1]+\"));\\n        int index = resTexRC.x * \"+t[1]+\" + resTexRC.y;\\n        return ivec2(index, 0);\\n      }\\n    \":1===e[0]?\"\\n      ivec2 getOutputCoords() {\\n        ivec2 resTexRC = ivec2(resultUV.yx *\\n                               vec2(\"+t[0]+\", \"+t[1]+\"));\\n        int index = resTexRC.x * \"+t[1]+\" + resTexRC.y;\\n        return ivec2(0, index);\\n      }\\n    \":\"\\n    ivec2 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+t[0]+\", \"+t[1]+\"));\\n      int index = resTexRC.x * \"+t[1]+\" + resTexRC.y;\\n      int r = index / \"+e[1]+\";\\n      int c = index - r * \"+e[1]+\";\\n      return ivec2(r, c);\\n    }\\n  \"}(e,t);case 3:return function(e,t){var n=e[1]*e[2],r=e[2];return\"\\n    ivec3 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n                             vec2(\"+t[0]+\", \"+t[1]+\"));\\n      int index = resTexRC.x * \"+t[1]+\" + resTexRC.y;\\n      int r = index / \"+n+\";\\n      index -= r * \"+n+\";\\n      int c = index / \"+r+\";\\n      int d = index - c * \"+r+\";\\n      return ivec3(r, c, d);\\n    }\\n  \"}(e,t);case 4:return function(e,t){var n=e[3],r=e[2]*n,o=e[1]*r;return\"\\n    ivec4 getOutputCoords() {\\n      ivec2 resTexRC = ivec2(resultUV.yx *\\n        vec2(\"+t[0]+\", \"+t[1]+\"));\\n      int index = resTexRC.x * \"+t[1]+\" + resTexRC.y;\\n\\n      int r = index / \"+o+\";\\n      index -= r * \"+o+\";\\n\\n      int c = index / \"+r+\";\\n      index -= c * \"+r+\";\\n\\n      int d = index / \"+n+\";\\n      int d2 = index - d * \"+n+\";\\n\\n      return ivec4(r, c, d, d2);\\n    }\\n  \"}(e,t);default:throw new Error(e.length+\"-D output sampling is not yet supported\")}}(t.logicalShape,g);return[h,d,f,m,y,v,n].join(\"\\n\")};var u=\"\\n  uniform float NaN;\\n\\n  const vec4 floatDeltas = vec4(\\n      1.0,\\n      1.0 / 255.0,\\n      1.0 / (255.0 * 255.0),\\n      1.0 / (255.0 * 255.0 * 255.0)\\n  );\\n  const float minValue = \"+i.FLOAT_MIN+\".0;\\n  const float maxValue = \"+i.FLOAT_MAX+\".0;\\n  const float range = (maxValue - minValue) / 255.0;\\n  const vec2 dotRange = vec2(1.0, range);\\n\\n  float sample(sampler2D texture, vec2 uv) {\\n    vec4 sampleValue = texture2D(texture, uv);\\n    if (all(equal(sampleValue, vec4(\"+i.BYTE_NAN_VALUE+\")))) {\\n      return NaN;\\n    }\\n\\n    vec4 encValue = floor(sampleValue * 255.0 + 0.5);\\n    float decodedValue = dot(encValue, floatDeltas);\\n    return dot(vec2(minValue, decodedValue), dotRange);\\n  }\\n\",c=\"\\n  const vec4 floatPowers = vec4(\\n    1.0,\\n    255.0,\\n    255.0 * 255.0,\\n    255.0 * 255.0 * 255.0\\n  );\\n  const vec2 recipRange = vec2(1.0/range);\\n  const vec2 recipRange255 = vec2(1.0/(maxValue - minValue));\\n\\n  void setOutput(float decodedValue) {\\n    if (isNaN(decodedValue)) {\\n      gl_FragColor = vec4(\"+i.BYTE_NAN_VALUE+\");\\n      return;\\n    }\\n\\n    float a = dot(vec2(decodedValue, -minValue), recipRange);\\n    float b = fract(a) * 255.0;\\n    float c = fract(b) * 255.0;\\n    float d = fract(c) * 255.0;\\n    gl_FragColor = floor(vec4(a, b, c, d)) / 255.0;\\n\\n    // TODO(dsmilkov): Version above gets better accuracy but probably slower\\n    // than the version below. Benchmark to determine if the accuracy is worth\\n    // the cost.\\n\\n    // float normValue = dot(vec2(decodedValue, -minValue), recipRange255);\\n    // vec4 f = normValue * floatPowers;\\n    // gl_FragColor = floor(fract(f) * 255.0) / 255.0;\\n  }\\n\",l=\"\\n  float sample(sampler2D texture, vec2 uv) {\\n    return texture2D(texture, uv).r;\\n  }\\n\",p=\"\\n  void setOutput(float val) {\\n    gl_FragColor = vec4(val, 0, 0, 0);\\n  }\\n\",h=\"\\n  precision highp float;\\n  precision highp int;\\n  varying vec2 resultUV;\\n  const vec2 halfCR = vec2(0.5, 0.5);\\n\\n  bool isNaN(float val) {\\n    float v1 = val * val;\\n    float v2 = val * val;\\n    return v1 == v2 ? false : true;\\n  }\\n\\n  bool hasNaN(vec4 values) {\\n    vec4 v1 = values * values;\\n    vec4 v2 = values * values;\\n    return any(notEqual(v1, v2));\\n  }\\n\\n  float getNaN(vec4 values) {\\n    return dot(vec4(1), values);\\n  }\\n\\n  int round(float value) {\\n    return int(floor(value + 0.5));\\n  }\\n\\n  int imod(int x, int y) {\\n    return x - y * (x / y);\\n  }\\n\\n  const vec2 randomConst = vec2(\\n    23.14069263277926, // e^pi (Gelfond's constant)\\n     2.665144142690225 // 2^sqrt(2) (Gelfond–Schneider constant)\\n  );\\n\\n  float random(float seed) {\\n      return fract(cos(dot(resultUV * seed, randomConst)) * 12345.6789);\\n  }\\n\\n  \\nvec2 UVfrom1D(int texNumR, int texNumC, int index) {\\n  int texR = index / texNumC;\\n  int texC = index - texR * texNumC;\\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\\n}\\n\\n  \\nvec2 UVfrom2D(int texNumR, int texNumC, int numC, int row, int col) {\\n  int index = row * numC + col;\\n  int texR = index / texNumC;\\n  int texC = index - texR * texNumC;\\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\\n}\\n\\n  \\nvec2 UVfrom3D(int texNumR, int texNumC, int stride0,\\n    int stride1, int row, int col, int depth) {\\n  // Explicitly use integer operations as dot() only works on floats.\\n  int index = row * stride0 + col * stride1 + depth;\\n  int texR = index / texNumC;\\n  int texC = index - texR * texNumC;\\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\\n}\\n\\n  \\nvec2 UVfrom4D(int texNumR, int texNumC, int stride0,\\n    int stride1, int stride2, int row, int col, int depth,\\n    int depth2) {\\n  // Explicitly use integer operations as dot() only works on floats.\\n  int index = row * stride0 + col * stride1 + depth * stride2 + depth2;\\n  int texR = index / texNumC;\\n  int texC = index - texR * texNumC;\\n  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);\\n}\\n\\n\";function d(e,t){var n=JSON.parse(JSON.stringify(e));return n.shapeInfo.logicalShape=t,n}function f(e,t){return t.map(function(t){return e[t]}).join(\", \")}t.getCoordsDataType=function(e){if(e<=1)return\"int\";if(2===e)return\"ivec2\";if(3===e)return\"ivec3\";if(4===e)return\"ivec4\";throw Error(\"GPU for rank \"+e+\" is not yet supported\")}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(0);t.assertParams=function(e,t,n){var o=e.length,a=t.length;r.assert(e.length===t.length,\"Error in concat\"+o+\"D: rank of x1 (\"+o+\") and x2 (\"+a+\") must be the same.\"),r.assert(n>=0&&n<o,\"Error in concat\"+o+\"D: axis must be between 0 and \"+(o-1)+\".\");for(var i=0;i<o;i++)r.assert(i===n||e[i]===t[i],\"Error in concat\"+o+\"D: Shape (\"+e+\") does not match (\"+t+\") along the non-concatenated axis \"+i+\".\")},t.computeOutShape1D=function(e,t){r.assert(1===e.length&&1===t.length,\"x1 and x2 should be 1d array.\");var n=e.slice();return n[0]+=t[0],n},t.computeOutShape=function(e,t,n){r.assert(e.length===t.length,\"x1 and x2 should have the same rank.\");var o=e.slice();return o[n]+=t[n],o},t.computeGradientSliceShapes=function(e,t){return{aBegin:[0,0],aSize:e,bBegin:[0,e[1]],bSize:t}}},function(e,t,n){\"use strict\";var r,o,a;Object.defineProperty(t,\"__esModule\",{value:!0}),function(e){e.float32=\"float32\",e.int32=\"int32\",e.bool=\"bool\"}(t.DType||(t.DType={})),function(e){e.R0=\"R0\",e.R1=\"R1\",e.R2=\"R2\",e.R3=\"R3\",e.R4=\"R4\"}(t.Rank||(t.Rank={})),function(e){e.float32=\"float32\",e.int32=\"int32\",e.bool=\"int32\"}(r||(r={})),function(e){e.float32=\"float32\",e.int32=\"int32\",e.bool=\"bool\"}(o||(o={})),function(e){e.float32=\"float32\",e.int32=\"float32\",e.bool=\"float32\"}(a||(a={}));var i={float32:a,int32:r,bool:o};function s(e,t){return i[e][t]}t.upcastType=s,t.sumOutType=function(e){return s(e,\"int32\")}},function(e,t,n){\"use strict\";function r(e,t){return e*t}function o(e,t){if(e%t!=0)throw new Error(\"unpackedSize (\"+e+\") must be a multiple of \"+t);return e/t}Object.defineProperty(t,\"__esModule\",{value:!0}),function(e){e[e.FLOAT=0]=\"FLOAT\",e[e.UNSIGNED_BYTE=1]=\"UNSIGNED_BYTE\"}(t.TextureType||(t.TextureType={})),t.getUnpackedMatrixTextureShapeWidthHeight=function(e,t){return[t,e]},t.getUnpackedArraySizeFromMatrixSize=r,t.getColorMatrixTextureShapeWidthHeight=function(e,t){return[4*t,e]},t.getMatrixSizeFromUnpackedArraySize=o,t.encodeMatrixToUnpackedArray=function(e,t,n){var o=r(e.length,n);if(t.length<o)throw new Error(\"unpackedArray length (\"+t.length+\") must be >= \"+o);for(var a=0,i=0;i<e.length;++i)t[a]=e[i],a+=n},t.FLOAT_MAX=2e4,t.FLOAT_MIN=-t.FLOAT_MAX;var a=(t.FLOAT_MAX-t.FLOAT_MIN)/255,i=[1,1/255,1/65025,1/16581375],s=[1,255,65025];function u(e,t){return[Math.ceil(t/2),Math.ceil(e/2)]}function c(e,t){var n=u(e,t);return n[0]*n[1]*4}t.BYTE_NAN_VALUE=0,t.encodeFloatArray=function(e){for(var n=new Uint8Array(4*e.length),r=function(r){var o=e[r/4];if(isNaN(o))return n[r]=t.BYTE_NAN_VALUE,n[r+1]=t.BYTE_NAN_VALUE,n[r+2]=t.BYTE_NAN_VALUE,n[r+3]=t.BYTE_NAN_VALUE,\"continue\";var i=(o-t.FLOAT_MIN)/a,u=s.map(function(e){return e*i}).map(function(e){return Math.floor(e%1*255)});n[r]=Math.floor(i),n[r+1]=u[0],n[r+2]=u[1],n[r+3]=u[2]},o=0;o<n.length;o+=4)r(o);return n},t.decodeToFloatArray=function(e){for(var n=new Float32Array(e.length/4),r=function(r){if(e[r]===t.BYTE_NAN_VALUE&&e[r+1]===t.BYTE_NAN_VALUE&&e[r+2]===t.BYTE_NAN_VALUE&&e[r+3]===t.BYTE_NAN_VALUE)return n[r/4]=NaN,\"continue\";var o=0;i.forEach(function(t,n){o+=t*e[r+n]});var s=o*a+t.FLOAT_MIN;n[r/4]=s},o=0;o<e.length;o+=4)r(o);return n},t.decodeMatrixFromUnpackedArray=function(e,t,n){var r=o(e.length,n);if(t.length<r)throw new Error(\"matrix length (\"+t.length+\") must be >= \"+r);for(var a=0,i=0;i<e.length;i+=n)t[a++]=e[i]},t.decodeMatrixFromUnpackedColorRGBAArray=function(e,t,n){var r=e.length*n/4;if(t.length<r)throw new Error(\"matrix length (\"+t.length+\") must be >= \"+r);for(var o=0,a=0;a<e.length;a+=4)for(var i=0;i<n;i++)t[o++]=e[a+i]},t.getPackedMatrixTextureShapeWidthHeight=u,t.getPackedRGBAArraySizeFromMatrixShape=c,t.encodeMatrixToPackedRGBA=function(e,t,n,r){var o=c(t,n);if(r.length<o)throw new Error(\"packedRGBA length (\"+r.length+\") must be >= \"+o);for(var a=u(t,n),i=a[0],s=a[1],l=n%2==1,p=t%2==1,h=Math.floor(n/2),d=Math.floor(t/2),f=l?4:0,m=n,v=0,g=0;g<d;++g){for(var y=2*g*n,b=0;b<h;++b){var x=y+2*b;r[v]=e[x],r[v+1]=e[x+1],r[v+2]=e[x+m],r[v+3]=e[x+m+1],v+=4}v+=f}if(l){x=n-1,v=4*(i-1);var w=2*n;for(f=4*i,g=0;g<d;++g)r[v]=e[x],r[v+2]=e[x+n],x+=w,v+=f}if(p)for(x=(t-1)*n,v=(s-1)*i*4,b=0;b<h;++b)r[v++]=e[x++],r[v++]=e[x++],v+=2;return l&&p&&(r[r.length-4]=e[e.length-1]),r},t.decodeMatrixFromPackedRGBA=function(e,t,n,r){var o=t*n;if(o<r.length)throw new Error(\"matrix length (\"+r.length+\") must be >= \"+o);for(var a=n%2==1,i=t%2==1,s=Math.floor(n/2),c=Math.floor(t/2),l=u(t,n),p=l[0],h=l[1],d=a?4:0,f=n+(a?1:0),m=0,v=0,g=n,y=0;y<c;++y){for(var b=0;b<s;++b)r[v++]=e[m++],r[v++]=e[m++],r[g++]=e[m++],r[g++]=e[m++];m+=d,v+=f,g+=f}if(a){m=4*(p-1);var x=n-1;for(d=4*p,f=2*n,y=0;y<c;++y)r[x]=e[m],r[x+n]=e[m+2],m+=d,x+=f}if(i)for(m=(h-1)*p*4,x=(t-1)*n,b=0;b<s;++b)r[x++]=e[m++],r[x++]=e[m++],m+=2;return a&&i&&(r[r.length-1]=e[e.length-4]),r}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(19),a=n(16),i=n(2),s=n(0),u=n(72),c=function(){function e(e){this.g=e}return e.prototype.dense=function(e,t,n,r,o,a,i){void 0===r&&(r=null),void 0===o&&(o=!0),void 0===a&&(a=new u.VarianceScalingInitializer),void 0===i&&(i=new u.ZerosInitializer);var s=this.g.variable(e+\"-weights\",a.initialize([t.shape[0],n],t.shape[0],n)),c=this.g.matmul(t,s);if(o){var l=this.g.variable(e+\"-bias\",i.initialize([n],t.shape[0],n));c=this.g.add(c,l)}return null!=r&&(c=r(c)),c},e}();t.GraphLayers=c;var l=function(){function e(){this.nodes=[],this.layers=new c(this)}return e.prototype.variable=function(e,t){return this.addNodeAndReturnOutput(new d(this,e,t))},e.prototype.placeholder=function(e,t){return this.addNodeAndReturnOutput(new f(this,e,t))},e.prototype.constant=function(e){var t;if(\"number\"==typeof e)t=i.Scalar.new(e);else if(e instanceof i.Tensor)t=e;else{if(!(e instanceof Array))throw new Error(\"unimplemented constant type.\");var n=s.flatten(e),r=new Float32Array(n);t=i.Tensor.make(s.inferShape(e),{values:r})}return this.addNodeAndReturnOutput(new m(this,t))},e.prototype.reshape=function(e,t){return this.addNodeAndReturnOutput(new v(this,\"Reshape\",e,t))},e.prototype.fusedLinearCombination=function(e,t,n,r){return this.addNodeAndReturnOutput(new g(this,e,t,n,r))},e.prototype.add=function(e,t){return this.addNodeAndReturnOutput(new y(this,e,t))},e.prototype.subtract=function(e,t){return this.addNodeAndReturnOutput(new b(this,e,t))},e.prototype.multiply=function(e,t){return this.addNodeAndReturnOutput(new x(this,e,t))},e.prototype.divide=function(e,t){return this.addNodeAndReturnOutput(new w(this,e,t))},e.prototype.reduceSum=function(e){return this.addNodeAndReturnOutput(new E(this,e))},e.prototype.concat1d=function(e,t){return this.addNodeAndReturnOutput(new T(this,e,t))},e.prototype.concat2d=function(e,t,n){return this.addNodeAndReturnOutput(new k(this,e,t,n))},e.prototype.concat3d=function(e,t,n){return this.addNodeAndReturnOutput(new S(this,e,t,n))},e.prototype.concat4d=function(e,t,n){return this.addNodeAndReturnOutput(new O(this,e,t,n))},e.prototype.matmul=function(e,t){return this.addNodeAndReturnOutput(new _(this,e,t))},e.prototype.conv2d=function(e,t,n,r,o,a,i){return void 0===a&&(a=1),this.addNodeAndReturnOutput(new A(this,e,t,n,r,o,a,i))},e.prototype.maxPool=function(e,t,n,r){return void 0===n&&(n=1),this.addNodeAndReturnOutput(new C(this,e,t,n,r))},e.prototype.exp=function(e){return this.addNodeAndReturnOutput(new D(this,e))},e.prototype.log=function(e){return this.addNodeAndReturnOutput(new I(this,e))},e.prototype.relu=function(e){return this.addNodeAndReturnOutput(new N(this,e))},e.prototype.leakyRelu=function(e,t){return this.addNodeAndReturnOutput(new M(this,e,t))},e.prototype.prelu=function(e,t){return this.addNodeAndReturnOutput(new P(this,e,t))},e.prototype.elu=function(e){return this.addNodeAndReturnOutput(new R(this,e))},e.prototype.tanh=function(e){return this.addNodeAndReturnOutput(new B(this,e))},e.prototype.sigmoid=function(e){return this.addNodeAndReturnOutput(new z(this,e))},e.prototype.square=function(e){return this.addNodeAndReturnOutput(new L(this,e))},e.prototype.softmax=function(e){return this.addNodeAndReturnOutput(new V(this,e))},e.prototype.softmaxCrossEntropyCost=function(e,t){return this.addNodeAndReturnOutput(new F(this,e,t))},e.prototype.meanSquaredCost=function(e,t){return this.addNodeAndReturnOutput(new G(this,e,t))},e.prototype.argmax=function(e){return this.addNodeAndReturnOutput(new U(this,e))},e.prototype.argmaxEquals=function(e,t){return this.addNodeAndReturnOutput(new j(this,e,t))},e.prototype.addNodeAndReturnOutput=function(e){return this.nodes.push(e),e.validate(),e.output},e.prototype.getNodes=function(){return this.nodes},e}();t.Graph=l;var p=function(e){function t(n){var r=e.call(this,[],\"float32\")||this;return r.shape=n,r.id=t.nextID++,r}return r(t,e),t.nextID=0,t}(i.Tensor);t.SymbolicTensor=p;var h=function(){function e(t,n,r,o){this.graph=t,this.name=n,this.inputs=r,this.output=o,this.id=e.nextID++,o.node=this}return e.nextID=0,e}();t.Node=h;var d=function(e){function t(t,n,r){var o=e.call(this,t,n,{},new p(r.shape))||this;return o.data=r,o}return r(t,e),t.prototype.validate=function(){s.assert(null!=this.data,\"Error adding variable op: Data for variable '\"+this.name+\"' is null or undefined\")},t}(h);t.VariableNode=d;var f=function(e){function t(t,n,r){return e.call(this,t,n,{},new p(r))||this}return r(t,e),t.prototype.validate=function(){},t}(h);t.PlaceholderNode=f;var m=function(e){function t(t,n){var r=e.call(this,t,\"Constant\",{},new p(n.shape))||this;return r.data=n,r}return r(t,e),t.prototype.validate=function(){s.assert(null!=this.data,\"Error adding constant: data for placeholder '\"+this.name+\"' is null or undefined\")},t}(h);t.ConstantNode=m;var v=function(e){function t(t,n,r,o){var a=e.call(this,t,n,{x:r},new p(o))||this;return a.name=n,a.x=r,a.shape=o,a}return r(t,e),t.prototype.validate=function(){var e=s.sizeFromShape(this.x.shape),t=s.sizeFromShape(this.shape);s.assert(e===t,\"Error making reshape operation: input to reshape '\"+this.name+\"' of shape (\"+this.x.shape+\") does not match size of requested shape \"+this.shape+\".\")},t.X=\"x\",t}(h);t.ReshapeNode=v;var g=function(e){function t(t,n,r,o,a){var i=e.call(this,t,\"Linear Combination\",{t1:n,t2:r,c1:o,c2:a},new p(n.shape))||this;return i.t1=n,i.t2=r,i.c1=o,i.c2=a,i}return r(t,e),t.prototype.validate=function(){if(s.assertShapesMatch(this.t1.shape,this.t2.shape),!s.isScalarShape(this.c1.shape))throw new Error(\"Error adding fusedLinearCombination: c1 is not a scalar, got shape: \"+this.c1.shape);if(!s.isScalarShape(this.c2.shape))throw new Error(\"Error adding fusedLinearCombination: c2 is not a scalar, got shape: \"+this.c2.shape)},t.T1=\"t1\",t.T2=\"t2\",t.C1=\"c1\",t.C2=\"c2\",t}(h);t.FusedLinearCombinationNode=g;var y=function(e){function t(t,n,r){var o=e.call(this,t,\"Add\",{t1:n,t2:r},new p(1===s.sizeFromShape(n.shape)?r.shape:n.shape.length<r.shape.length?r.shape:n.shape))||this;return o.t1=n,o.t2=r,o}return r(t,e),t.prototype.validate=function(){s.assert(1===s.sizeFromShape(this.t1.shape)||1===s.sizeFromShape(this.t2.shape)||s.arraysEqual(this.t1.shape,this.t2.shape)||2===this.t1.shape.length&&1===this.t2.shape.length&&this.t1.shape[1]===this.t2.shape[0]||1===this.t1.shape.length&&2===this.t2.shape.length&&this.t1.shape[0]===this.t2.shape[1],\"Error adding add operation op: one of inputs must be scalar, shapes \"+this.t1.shape+\" and \"+this.t2.shape+\" must match,or one of them can be broadcasted (2D and 1D).\")},t.T1=\"t1\",t.T2=\"t2\",t}(h);t.AddNode=y;var b=function(e){function t(t,n,r){var o=e.call(this,t,\"Subtract\",{t1:n,t2:r},new p(1===s.sizeFromShape(n.shape)?r.shape:n.shape))||this;return o.t1=n,o.t2=r,o}return r(t,e),t.prototype.validate=function(){s.assert(1===s.sizeFromShape(this.t1.shape)||1===s.sizeFromShape(this.t2.shape)||s.arraysEqual(this.t1.shape,this.t2.shape),\"Error adding subtract op: one of inputs must be scalar or the shapes \"+this.t1.shape+\" and \"+this.t2.shape+\" must match.\")},t.T1=\"t1\",t.T2=\"t2\",t}(h);t.SubtractNode=b;var x=function(e){function t(t,n,r){var o=e.call(this,t,\"Multiply\",{t1:n,t2:r},new p(1===s.sizeFromShape(n.shape)?r.shape:n.shape))||this;return o.t1=n,o.t2=r,o}return r(t,e),t.prototype.validate=function(){s.assert(1===s.sizeFromShape(this.t1.shape)||1===s.sizeFromShape(this.t2.shape)||s.arraysEqual(this.t1.shape,this.t2.shape),\"Error adding multiply op: one of inputs must be scalar or the shapes \"+this.t1.shape+\" and \"+this.t2.shape+\" must match.\")},t.T1=\"t1\",t.T2=\"t2\",t}(h);t.MultiplyNode=x;var w=function(e){function t(t,n,r){var o=e.call(this,t,\"Divide\",{t1:n,t2:r},new p(1===s.sizeFromShape(n.shape)?r.shape:n.shape))||this;return o.t1=n,o.t2=r,o}return r(t,e),t.prototype.validate=function(){s.assert(1===s.sizeFromShape(this.t1.shape)||1===s.sizeFromShape(this.t2.shape)||s.arraysEqual(this.t1.shape,this.t2.shape),\"Error adding divide op: one of inputs must be scalar or the shapes \"+this.t1.shape+\" and \"+this.t2.shape+\" must match.\")},t.T1=\"t1\",t.T2=\"t2\",t}(h);t.DivideNode=w;var E=function(e){function t(t,n){return e.call(this,t,\"ReduceSum\",{x:n},new p([]))||this}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.ReduceSumNode=E;var T=function(e){function t(t,n,r){return e.call(this,t,\"Concat1D\",{x1:n,x2:r},new p(o.computeOutShape1D(n.shape,r.shape)))||this}return r(t,e),t.prototype.validate=function(){},t.X1=\"x1\",t.X2=\"x2\",t}(h);t.Concat1DNode=T;var k=function(e){function t(t,n,r,a){var i=e.call(this,t,\"Concat2D\",{x1:n,x2:r},new p(o.computeOutShape(n.shape,r.shape,a)))||this;return i.x1=n,i.x2=r,i.axis=a,i}return r(t,e),t.prototype.validate=function(){o.assertParams(this.x1.shape,this.x2.shape,this.axis)},t.X1=\"x1\",t.X2=\"x2\",t.AXIS=\"axis\",t}(h);t.Concat2DNode=k;var S=function(e){function t(t,n,r,a){var i=e.call(this,t,\"Concat3D\",{x1:n,x2:r},new p(o.computeOutShape(n.shape,r.shape,a)))||this;return i.x1=n,i.x2=r,i.axis=a,i}return r(t,e),t.prototype.validate=function(){o.assertParams(this.x1.shape,this.x2.shape,this.axis)},t.X1=\"x1\",t.X2=\"x2\",t.AXIS=\"axis\",t}(h);t.Concat3DNode=S;var O=function(e){function t(t,n,r,a){var i=e.call(this,t,\"Concat4D\",{x1:n,x2:r},new p(o.computeOutShape(n.shape,r.shape,a)))||this;return i.x1=n,i.x2=r,i.axis=a,i}return r(t,e),t.prototype.validate=function(){o.assertParams(this.x1.shape,this.x2.shape,this.axis)},t.X1=\"x1\",t.X2=\"x2\",t.AXIS=\"axis\",t}(h);t.Concat4DNode=O;var _=function(e){function t(t,n,r){var o=e.call(this,t,\"MatMul\",{x1:n,x2:r},new p(function(e,t){return 1===e.length&&1===t.length?[1]:1===e.length&&2===t.length?[t[1]]:2===e.length&&1===t.length?[e[0]]:[e[0],t[1]]}(n.shape,r.shape)))||this;return o.x1=n,o.x2=r,o}return r(t,e),t.prototype.validate=function(){if(2===this.x1.shape.length&&2===this.x2.shape.length)s.assert(this.x1.shape[1]===this.x2.shape[0],\"Error adding matmul op: inner shapes of matrices with shapes \"+this.x1.shape+\" and \"+this.x2.shape+\" must match.\");else if(2===this.x1.shape.length&&1===this.x2.shape.length)s.assert(this.x1.shape[1]===this.x2.shape[0],\"Error adding matmul op: second dimension of matrix with shape \"+this.x1.shape.toString()+\" must match size of vector with shape \"+this.x2.shape+\".\");else{if(1!==this.x1.shape.length||2!==this.x2.shape.length)throw new Error(\"Error adding matmul op: inputs must be vectors or matrices.\");s.assert(this.x1.shape[0]===this.x2.shape[0],\"Error adding matmul op: size of vector with shape \"+this.x1.shape+\" must match first dimension of matrix with shape \"+this.x2.shape+\".\")}},t.X1=\"x1\",t.X2=\"x2\",t}(h);t.MatMulNode=_;var A=function(e){function t(t,n,r,o,i,s,u,c){void 0===u&&(u=1);var l=e.call(this,t,\"Convolution 2D\",{x:n,w:r,b:o},new p(a.computeOutputShape3D(n.shape,i,s,u,c)))||this;return l.x=n,l.w=r,l.b=o,l.fieldSize=i,l.outputDepth=s,l.stride=u,l.zeroPad=c,l}return r(t,e),t.prototype.validate=function(){s.assert(3===this.x.shape.length,\"Error adding conv2d op: input must be of rank 3, but got shape: \"+this.x.shape+\".\"),s.assert(4===this.w.shape.length,\"Error adding conv2d op: weights must be of rank 4, but got shape: \"+this.w.shape+\".\"),s.assert(1===this.b.shape.length,\"Error adding conv2d op: biases must be of rank 1, but got shape: \"+this.b.shape+\".\"),s.assert(this.x.shape[2]===this.w.shape[2],\"Error adding conv2d op: depth of input (\"+this.x.shape[2]+\") must match input depth for weights (\"+this.w.shape[2]+\").\")},t.X=\"x\",t.W=\"w\",t.B=\"b\",t}(h);t.Convolution2DNode=A;var C=function(e){function t(t,n,r,o,i){void 0===o&&(o=1);var s=e.call(this,t,\"Max pool\",{x:n},new p(a.computeOutputShape3D(n.shape,r,n.shape[2],o,i)))||this;return s.x=n,s.fieldSize=r,s.stride=o,s.zeroPad=i,s}return r(t,e),t.prototype.validate=function(){s.assert(3===this.x.shape.length,\"Error adding maxPool op: input must be of rank 3, but got shape: \"+this.x.shape+\".\")},t.X=\"x\",t}(h);t.MaxPoolNode=C;var N=function(e){function t(t,n){return e.call(this,t,\"ReLU\",{x:n},new p(n.shape))||this}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.ReLUNode=N;var M=function(e){function t(t,n,r){var o=e.call(this,t,\"LeakyReLU\",{x:n},new p(n.shape))||this;return o.alpha=r,o}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.LeakyReLUNode=M;var P=function(e){function t(t,n,r){var o=e.call(this,t,\"PReLU\",{x:n,alpha:r},new p(n.shape))||this;return o.x=n,o.alpha=r,o}return r(t,e),t.prototype.validate=function(){s.assert(s.arraysEqual(this.x.shape,this.alpha.shape),\"Error adding pRelu op: the shapes x: \"+this.x.shape+\" and alpha: \"+this.alpha.shape+\" must match.\")},t.X=\"x\",t.ALPHA=\"alpha\",t}(h);t.PReLUNode=P;var R=function(e){function t(t,n){return e.call(this,t,\"Elu\",{x:n},new p(n.shape))||this}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.EluNode=R;var D=function(e){function t(t,n){return e.call(this,t,\"Exp\",{x:n},new p(n.shape))||this}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.ExpNode=D;var I=function(e){function t(t,n){return e.call(this,t,\"Log\",{x:n},new p(n.shape))||this}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.LogNode=I;var B=function(e){function t(t,n){return e.call(this,t,\"TanH\",{x:n},new p(n.shape))||this}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.TanHNode=B;var z=function(e){function t(t,n){return e.call(this,t,\"Sigmoid\",{x:n},new p(n.shape))||this}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.SigmoidNode=z;var L=function(e){function t(t,n){return e.call(this,t,\"Square\",{x:n},new p(n.shape))||this}return r(t,e),t.prototype.validate=function(){},t.X=\"x\",t}(h);t.SquareNode=L;var F=function(e){function t(t,n,r){var o=e.call(this,t,\"SoftmaxCrossEntropyCost\",{x:n,target:r},new p([]))||this;return o.x=n,o.target=r,o}return r(t,e),t.prototype.validate=function(){s.assert(s.arraysEqual(this.x.shape,this.target.shape),\"Error adding softmaxCrossEntropyCost op: x shape (\"+this.x.shape+\") must match target shape (\"+this.target.shape+\").\")},t.X=\"x\",t.TARGET=\"target\",t}(h);t.SoftmaxCrossEntropyCostNode=F;var V=function(e){function t(t,n){var r=e.call(this,t,\"Softmax\",{x:n},new p(n.shape))||this;return r.x=n,r}return r(t,e),t.prototype.validate=function(){s.assert(1===this.x.shape.length,\"The input to a softmax must be a 1-D tensor\"),s.assert(this.x.shape[0]>=2,\"The input to a softmax must have at least 2 values\")},t.X=\"x\",t}(h);t.SoftmaxNode=V;var G=function(e){function t(t,n,r){var o=e.call(this,t,\"Mean Squared Cost\",{label:n,prediction:r},new p([]))||this;return o.label=n,o.prediction=r,o}return r(t,e),t.prototype.validate=function(){s.assert(s.arraysEqual(this.label.shape,this.prediction.shape),\"Error adding meanSquaredCost op: label shape (\"+this.label.shape+\") must match prediction shape (\"+this.prediction.shape+\").\")},t.LABEL=\"label\",t.PREDICTION=\"prediction\",t}(h);t.MeanSquaredCostNode=G;var U=function(e){function t(t,n){var r=e.call(this,t,\"ArgMax\",{x:n},new p([1]))||this;return r.x=n,r}return r(t,e),t.prototype.validate=function(){s.assert(s.sizeFromShape(this.x.shape)>0,\"Error adding argmax op: input tensor must have at least one entry.\")},t.X=\"x\",t}(h);t.ArgMaxNode=U;var j=function(e){function t(t,n,r){var o=e.call(this,t,\"ArgMaxEquals\",{x1:n,x2:r},new p([1]))||this;return o.x1=n,o.x2=r,o}return r(t,e),t.prototype.validate=function(){s.assert(s.arraysEqual(this.x1.shape,this.x2.shape),\"Error adding ArgMaxEquals op: x1 shape (\"+this.x1.shape+\") must match x2 shape (\"+this.x2.shape+\").\")},t.X1=\"x1\",t.X2=\"x2\",t}(h);t.ArgMaxEqualsNode=j},function(e,t,n){\"use strict\";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(79),a=n(80);t.contrib=a;var i=n(64);t.xhr_dataset=i;var s=n(1);t.environment=s;var u=n(1),c=n(66);t.gpgpu_util=c;var l=n(26);t.webgl_util=l;var p=n(16);t.conv_util=p;var h=n(106);t.test_util=h;var d=n(0);t.util=d;var f=n(134);t.version=f.version;var m=n(135);t.CheckpointLoader=m.CheckpointLoader;var v=n(65);t.InMemoryDataset=v.InMemoryDataset;var g=n(136);t.InCPUMemoryShuffledInputProviderBuilder=g.InCPUMemoryShuffledInputProviderBuilder,t.InGPUMemoryShuffledInputProviderBuilder=g.InGPUMemoryShuffledInputProviderBuilder;var y=n(64);t.XhrDataset=y.XhrDataset;var b=n(1);t.ENV=b.ENV,t.Environment=b.Environment;var x=n(22);t.Graph=x.Graph,t.SymbolicTensor=x.SymbolicTensor;var w=n(137);t.GraphRunner=w.GraphRunner,t.MetricReduction=w.MetricReduction;var E=n(72);t.ConstantInitializer=E.ConstantInitializer,t.OnesInitializer=E.OnesInitializer,t.RandomNormalInitializer=E.RandomNormalInitializer,t.RandomTruncatedNormalInitializer=E.RandomTruncatedNormalInitializer,t.RandomUniformInitializer=E.RandomUniformInitializer,t.TensorInitializer=E.TensorInitializer,t.VarianceScalingInitializer=E.VarianceScalingInitializer,t.ZerosInitializer=E.ZerosInitializer;var T=n(73);t.CostReduction=T.CostReduction,t.Session=T.Session;var k=n(67);t.MathBackendCPU=k.MathBackendCPU,t.NDArrayMathCPU=k.NDArrayMathCPU;var S=n(68);t.MathBackendWebGL=S.MathBackendWebGL,t.NDArrayMathGPU=S.NDArrayMathGPU;var O=n(50);t.MatrixOrientation=O.MatrixOrientation;var _=n(70);t.GPGPUContext=_.GPGPUContext;var A=n(25);t.NDArrayMath=A.NDArrayMath;var C=n(31);t.AdadeltaOptimizer=C.AdadeltaOptimizer;var N=n(32);t.AdagradOptimizer=N.AdagradOptimizer;var M=n(33);t.AdamOptimizer=M.AdamOptimizer;var P=n(34);t.AdamaxOptimizer=P.AdamaxOptimizer;var R=n(35);t.MomentumOptimizer=R.MomentumOptimizer;var D=n(14);t.Optimizer=D.Optimizer;var I=n(36);t.RMSPropOptimizer=I.RMSPropOptimizer;var B=n(27);t.SGDOptimizer=B.SGDOptimizer;var z=n(2);t.Array1D=z.Array1D,t.Array2D=z.Array2D,t.Array3D=z.Array3D,t.Array4D=z.Array4D,t.NDArray=z.NDArray,t.Scalar=z.Scalar,t.Tensor=z.Tensor,t.Tensor1D=z.Tensor1D,t.Tensor2D=z.Tensor2D,t.Tensor3D=z.Tensor3D,t.Tensor4D=z.Tensor4D,t.variable=z.variable,t.Variable=z.Variable;var L=n(20);t.Rank=L.Rank,r(n(5)),r(n(159)),r(n(3)),t.setBackend=u.Environment.setBackend,t.getBackend=u.Environment.getBackend,t.memory=u.Environment.memory,t.nextFrame=o.BrowserUtil.nextFrame},function(e,t,n){var r=n(81),o=n(82),a=n(83),i=n(84),s=n(85),u=n(86),c=n(87);c.alea=r,c.xor128=o,c.xorwow=a,c.xorshift7=i,c.xor4096=s,c.tychei=u,e.exports=c},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(1),o=n(39),a=n(41),i=n(42),s=n(43),u=n(44),c=n(45),l=n(46),p=n(47),h=n(48),d=n(49),f=n(51),m=n(5),v=n(52),g=n(53),y=n(54),b=n(55),x=n(56),w=n(57),E=n(58),T=n(38),k=n(0),S=T.Tracking.tidy,O=T.Tracking.keep,_=function(){function e(e,t){this.matMul=d.Ops.matMul,this.vectorTimesMatrix=d.Ops.vectorTimesMatrix,this.outerProduct=d.Ops.outerProduct,this.matrixTimesVector=d.Ops.matrixTimesVector,this.dotProduct=d.Ops.dotProduct,this.slice=b.Ops.slice,this.slice1D=b.Ops.slice1d,this.slice2D=b.Ops.slice2d,this.slice3D=b.Ops.slice3d,this.slice4D=b.Ops.slice4d,this.reverse=y.Ops.reverse,this.reverse1D=y.Ops.reverse1d,this.reverse2D=y.Ops.reverse2d,this.reverse3D=y.Ops.reverse3d,this.reverse4D=y.Ops.reverse4d,this.batchNormalization=a.Ops.batchNormalization,this.batchNormalization2D=a.Ops.batchNormalization2d,this.batchNormalization3D=a.Ops.batchNormalization3d,this.batchNormalization4D=a.Ops.batchNormalization4d,this.avgPool=v.Ops.avgPool,this.maxPool=v.Ops.maxPool,this.minPool=v.Ops.minPool,this.maxPoolBackprop=v.Ops.maxPoolBackprop,this.conv2dTranspose=u.Ops.conv2dTranspose,this.depthwiseConv2D=u.Ops.depthwiseConv2d,this.conv2dDerFilter=u.Ops.conv2dDerFilter,this.conv2dDerInput=u.Ops.conv2dDerInput,this.argMax=g.Ops.argMax,this.argMin=g.Ops.argMin,this.logSumExp=g.Ops.logSumExp,this.max=g.Ops.max,this.mean=g.Ops.mean,this.min=g.Ops.min,this.moments=g.Ops.moments,this.sum=g.Ops.sum,this.add=i.Ops.add,this.addStrict=i.Ops.addStrict,this.div=i.Ops.div,this.divide=this.div,this.divStrict=i.Ops.divStrict,this.divideStrict=this.divStrict,this.maximum=i.Ops.maximum,this.maximumStrict=i.Ops.maximumStrict,this.minimum=i.Ops.minimum,this.minimumStrict=i.Ops.minimumStrict,this.mul=i.Ops.mul,this.multiply=this.mul,this.mulStrict=i.Ops.mulStrict,this.multiplyStrict=this.mulStrict,this.pow=i.Ops.pow,this.powStrict=i.Ops.powStrict,this.sub=i.Ops.sub,this.subtract=this.sub,this.subStrict=i.Ops.subStrict,this.logicalNot=l.Ops.logicalNot,this.logicalAnd=l.Ops.logicalAnd,this.logicalOr=l.Ops.logicalOr,this.logicalXor=l.Ops.logicalXor,this.where=l.Ops.where,this.transpose=w.Ops.transpose,this.equal=s.Ops.equal,this.equalStrict=s.Ops.equalStrict,this.greater=s.Ops.greater,this.greaterStrict=s.Ops.greaterStrict,this.greaterEqual=s.Ops.greaterEqual,this.greaterEqualStrict=s.Ops.greaterEqualStrict,this.less=s.Ops.less,this.lessStrict=s.Ops.lessStrict,this.lessEqual=s.Ops.lessEqual,this.lessEqualStrict=s.Ops.lessEqualStrict,this.notEqual=s.Ops.notEqual,this.notEqualStrict=s.Ops.notEqualStrict,this.abs=E.Ops.abs,this.acos=E.Ops.acos,this.asin=E.Ops.asin,this.atan=E.Ops.atan,this.ceil=E.Ops.ceil,this.clip=E.Ops.clipByValue,this.cos=E.Ops.cos,this.cosh=E.Ops.cosh,this.elu=E.Ops.elu,this.exp=E.Ops.exp,this.floor=E.Ops.floor,this.leakyRelu=E.Ops.leakyRelu,this.log=E.Ops.log,this.neg=E.Ops.neg,this.prelu=E.Ops.prelu,this.relu=E.Ops.relu,this.selu=E.Ops.selu,this.sigmoid=E.Ops.sigmoid,this.sin=E.Ops.sin,this.sinh=E.Ops.sinh,this.sqrt=E.Ops.sqrt,this.square=E.Ops.square,this.step=E.Ops.step,this.tan=E.Ops.tan,this.tanh=E.Ops.tanh,this.norm=f.Ops.norm,this.basicLSTMCell=h.Ops.basicLSTMCell,this.multiRNNCell=h.Ops.multiRNNCell,this.softmax=x.Ops.softmax,this.softmaxCrossEntropy=x.Ops.softmaxCrossEntropy,this.cast=o.Ops.cast,this.clone=o.Ops.clone,this.gather=o.Ops.gather,this.reshape=o.Ops.reshape,this.tile=o.Ops.tile,this.oneHot=o.Ops.oneHot,this.multinomial=o.Ops.multinomial,this.pad1D=o.Ops.pad1d,this.pad2D=o.Ops.pad2d,this.resizeBilinear3D=c.Ops.resizeBilinear,this.localResponseNormalization3D=p.LRN.localResponseNormalization,this.localResponseNormalization4D=p.LRN.localResponseNormalization,this.keep=T.Tracking.keep,r.ENV.setMath(this,e,t),this.engine=r.ENV.engine,this.dispose=r.ENV.engine.dispose.bind(r.ENV.engine),this.registeredVariables=r.ENV.engine.registeredVariables,this.startScope=r.ENV.engine.startScope.bind(r.ENV.engine),this.endScope=r.ENV.engine.endScope.bind(r.ENV.engine)}return e.prototype.scope=function(e){var t=function(e){return O(e)},n=function(e){return e};return S(function(){return e(t,n)})},e.prototype.track=function(e){return e},e.prototype.topK=function(e,t){var n,o;return k.assert(t<=e.size,\"Error in topK: k value (\"+t+\") must be less than size of input tensor, got shape \"+e.shape+\".\"),S(\"topK\",function(){return n=r.ENV.engine.executeKernel(\"TopKValues\",{inputs:{x:e},args:{k:t}}),o=r.ENV.engine.executeKernel(\"TopKIndices\",{inputs:{x:e},args:{k:t}}),n}),{values:n,indices:o}},e.prototype.elementWiseMul=function(e,t){return e.mulStrict(t)},e.prototype.scalarDividedByArray=function(e,t){return k.assert(1===e.size,\"Error in scalarDividedByArray: first argument must be rank 0, but got Tensor of rank \"+e.rank+\".\"),e.div(t)},e.prototype.arrayDividedByScalar=function(e,t){return k.assert(1===t.size,\"Error in arrayDividedByScalar: second argument must be rank 0, but got Tensor of rank \"+t.rank+\".\"),e.div(t)},e.prototype.switchDim=function(e,t){return m.transpose(e,t)},e.prototype.scalarPlusArray=function(e,t){return k.assert(1===e.size,\"Error in scalarPlusArray: first argument must be rank 0, but got rank \"+e.rank+\".\"),this.add(e,t)},e.prototype.scalarMinusArray=function(e,t){return k.assert(1===e.size,\"Error in scalarMinusArray: first argument must be rank 0, but got rank \"+e.rank+\".\"),this.subtract(e,t)},e.prototype.arrayMinusScalar=function(e,t){return k.assert(1===t.size,\"Error in arrayMinusScalar: second argument must be rank 0, but got rank \"+t.rank+\".\"),this.subtract(e,t)},e.prototype.scaledArrayAdd=function(e,t,n,r){var o=this;return k.assert(1===e.size,\"Error in scaledArrayAdd: first argument must rank 0, but got  rank \"+e.rank+\".\"),k.assert(1===n.size,\"Error in scaledArrayAdd: third argument must be rank 0, but got Tensor of rank \"+n.rank+\".\"),k.assertShapesMatch(t.shape,r.shape,\"Error in scaledArrayAdd: \"),S(\"scaledArrayAdd\",function(){return o.add(o.multiply(e,t),o.multiply(n,r))})},e.prototype.scalarTimesArray=function(e,t){return k.assert(1===e.size,\"Error in arrayDividedByScalar: first argument must be rank 0, but got rank \"+e.rank+\".\"),this.multiply(e,t)},e.prototype.concat=function(e,t,n){return m.concat([e,t],n)},e.prototype.concat1D=function(e,t){return m.concat1d([e,t])},e.prototype.concat2D=function(e,t,n){return m.concat2d([e,t],n)},e.prototype.concat3D=function(e,t,n){return m.concat3d([e,t],n)},e.prototype.concat4D=function(e,t,n){return m.concat4d([e,t],n)},e.prototype.conv1d=function(e,t,n,r,o,a){return null!=n&&k.assert(1===n.rank,\"Error in conv1d: bias must be rank 1, but got rank \"+n.rank+\".\"),m.conv1d(e,t,r,o,a).add(n)},e.prototype.conv2d=function(e,t,n,r,o,a){return null!=n&&k.assert(1===n.rank,\"Error in conv2d: bias must be rank 1, but got rank \"+n.rank+\".\"),m.conv2d(e,t,r,o,a).add(n)},e.prototype.argMaxEquals=function(e,t){return k.assertShapesMatch(e.shape,t.shape,\"Error in argMaxEquals: \"),e.argMax().equal(t.argMax())},e}();t.NDArrayMath=_},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=null,o=n(0),a=n(1);function i(e,t){var n,r=a.ENV.get(\"WEBGL_VERSION\");if(2===r?n=e.getContext(\"webgl2\",t):1===r&&(n=e.getContext(\"webgl\",t)||e.getContext(\"experimental-webgl\",t)),0===r||null==n)throw new Error(\"This browser does not support WebGL.\");return n}function s(e,t){var n=t();return c(e),n}t.createWebGLRenderingContext=function(e){var t=document.createElement(\"canvas\");return t.width=1,t.height=1,i(t,e)},t.createWebGLRenderingContextFromCanvas=i,t.callAndCheck=s;var u=!1;function c(e){if(u){var t=e.getError();if(t!==e.NO_ERROR)throw new Error(\"WebGL Error: \"+l(e,t))}}function l(e,t){switch(t){case e.NO_ERROR:return\"NO_ERROR\";case e.INVALID_ENUM:return\"INVALID_ENUM\";case e.INVALID_VALUE:return\"INVALID_VALUE\";case e.INVALID_OPERATION:return\"INVALID_OPERATION\";case e.INVALID_FRAMEBUFFER_OPERATION:return\"INVALID_FRAMEBUFFER_OPERATION\";case e.OUT_OF_MEMORY:return\"OUT_OF_MEMORY\";case e.CONTEXT_LOST_WEBGL:return\"CONTEXT_LOST_WEBGL\";default:return\"Unknown error code \"+t}}t.enableDebugWebGLErrorChecking=function(e){u=e},t.checkWebGLError=c,t.getWebGLErrorMessage=l,t.getExtensionOrThrow=function(e,t){return m(e,function(){return e.getExtension(t)},'Extension \"'+t+'\" not supported on this browser.')},t.createVertexShader=function(e,t){var n=m(e,function(){return e.createShader(e.VERTEX_SHADER)},\"Unable to create vertex WebGLShader.\");if(s(e,function(){return e.shaderSource(n,t)}),s(e,function(){return e.compileShader(n)}),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw console.log(e.getShaderInfoLog(n)),new Error(\"Failed to compile vertex shader.\");return n},t.createFragmentShader=function(e,t){var n=m(e,function(){return e.createShader(e.FRAGMENT_SHADER)},\"Unable to create fragment WebGLShader.\");if(s(e,function(){return e.shaderSource(n,t)}),s(e,function(){return e.compileShader(n)}),!1===e.getShaderParameter(n,e.COMPILE_STATUS))throw function(e,t){var n=p.exec(t);if(null==n)return console.log(\"Couldn't parse line number in error: \"+t),void console.log(e);for(var r=+n[1],a=e.split(\"\\n\"),i=a.length.toString().length+2,s=a.map(function(e,t){return o.rightPad((t+1).toString(),i)+e}),u=0,c=0;c<s.length;c++)u=Math.max(s[c].length,u);var l=s.slice(0,r-1),h=s.slice(r-1,r),d=s.slice(r);console.log(l.join(\"\\n\")),console.log(t.split(\"\\n\")[0]),console.log(\"%c \"+o.rightPad(h[0],u),\"border:1px solid red; background-color:#e3d2d2; color:#a61717\"),console.log(d.join(\"\\n\"))}(t,e.getShaderInfoLog(n)),new Error(\"Failed to compile fragment shader.\");return n};var p=/ERROR: [0-9]+:([0-9]+):/g;function h(e){return null!=r?r:r=s(e,function(){return e.getParameter(e.MAX_TEXTURE_SIZE)})}function d(e,t,n){v(e,n),s(e,function(){return e.activeTexture(e.TEXTURE0+n)}),s(e,function(){return e.bindTexture(e.TEXTURE_2D,t)})}function f(e,t){switch(t){case e.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return\"FRAMEBUFFER_INCOMPLETE_ATTACHMENT\";case e.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return\"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT\";case e.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return\"FRAMEBUFFER_INCOMPLETE_DIMENSIONS\";case e.FRAMEBUFFER_UNSUPPORTED:return\"FRAMEBUFFER_UNSUPPORTED\";default:return\"unknown error \"+t}}function m(e,t,n){var r=s(e,function(){return t()});if(null==r)throw new Error(n);return r}function v(e,t){var n=e.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=t+e.TEXTURE0;if(r<e.TEXTURE0||r>n)throw new Error(\"textureUnit must be in \"+(\"[gl.TEXTURE0, gl.TEXTURE\"+n+\"]\")+\".\")}t.createProgram=function(e){return m(e,function(){return e.createProgram()},\"Unable to create WebGLProgram.\")},t.linkProgram=function(e,t){if(s(e,function(){return e.linkProgram(t)}),!1===e.getProgramParameter(t,e.LINK_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error(\"Failed to link vertex and fragment shaders.\")},t.validateProgram=function(e,t){if(s(e,function(){return e.validateProgram(t)}),!1===e.getProgramParameter(t,e.VALIDATE_STATUS))throw console.log(e.getProgramInfoLog(t)),new Error(\"Shader program validation failed.\")},t.createStaticVertexBuffer=function(e,t){var n=m(e,function(){return e.createBuffer()},\"Unable to create WebGLBuffer\");return s(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,n)}),s(e,function(){return e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW)}),n},t.createStaticIndexBuffer=function(e,t){var n=m(e,function(){return e.createBuffer()},\"Unable to create WebGLBuffer\");return s(e,function(){return e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n)}),s(e,function(){return e.bufferData(e.ELEMENT_ARRAY_BUFFER,t,e.STATIC_DRAW)}),n},t.queryMaxTextureSize=h,t.getChannelsPerTexture=function(){return a.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")&&2===a.ENV.get(\"WEBGL_VERSION\")?1:4},t.createTexture=function(e){return m(e,function(){return e.createTexture()},\"Unable to create WebGLTexture.\")},t.validateTextureSize=function(e,t,n){var r=h(e);if(t<=0||n<=0){var o=\"[\"+t+\"x\"+n+\"]\";throw new Error(\"Requested texture size \"+o+\" is invalid.\")}if(t>r||n>r)throw o=\"[\"+t+\"x\"+n+\"]\",new Error(\"Requested texture size \"+o+\" greater than WebGL maximum on this browser / GPU [\"+r+\"x\"+r+\"].\")},t.createFramebuffer=function(e){return m(e,function(){return e.createFramebuffer()},\"Unable to create WebGLFramebuffer.\")},t.bindVertexBufferToProgramAttribute=function(e,t,n,r,o,a,i,u){var c=-1;-1!==(c=null!=u&&n in u?u[n]:e.getAttribLocation(t,n))&&(s(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,r)}),s(e,function(){return e.vertexAttribPointer(c,o,e.FLOAT,!1,a,i)}),s(e,function(){return e.enableVertexAttribArray(c)}))},t.bindTextureUnit=d,t.unbindTextureUnit=function(e,t){v(e,t),s(e,function(){return e.activeTexture(e.TEXTURE0+t)}),s(e,function(){return e.bindTexture(e.TEXTURE_2D,null)})},t.getProgramUniformLocationOrThrow=function(e,t,n){return m(e,function(){return e.getUniformLocation(t,n)},'uniform \"'+n+'\" not present in program.')},t.getProgramUniformLocation=function(e,t,n){return e.getUniformLocation(t,n)},t.bindTextureToProgramUniformSampler=function(e,t,n,r,o){s(e,function(){return d(e,n,o)}),s(e,function(){return e.uniform1i(r,o)})},t.bindCanvasToFramebuffer=function(e){s(e,function(){return e.bindFramebuffer(e.FRAMEBUFFER,null)}),s(e,function(){return e.viewport(0,0,e.canvas.width,e.canvas.height)}),s(e,function(){return e.scissor(0,0,e.canvas.width,e.canvas.height)})},t.bindColorTextureToFramebuffer=function(e,t,n){s(e,function(){return e.bindFramebuffer(e.FRAMEBUFFER,n)}),s(e,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,t,0)})},t.unbindColorTextureFromFramebuffer=function(e,t){s(e,function(){return e.bindFramebuffer(e.FRAMEBUFFER,t)}),s(e,function(){return e.framebufferTexture2D(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,null,0)})},t.validateFramebuffer=function(e){var t=e.checkFramebufferStatus(e.FRAMEBUFFER);if(t!==e.FRAMEBUFFER_COMPLETE)throw new Error(\"Error binding framebuffer: \"+f(e,t))},t.getFramebufferErrorMessage=f,t.getTextureShapeFromLogicalShape=function(e,t){2!==t.length&&(t=o.squeezeShape(t).newShape);var n=h(e),r=o.sizeFromShape(t);return t.length<=1&&r<=n?[r,1]:2===t.length&&t[0]<=n&&t[1]<=n?t:3===t.length&&t[0]<=n&&t[1]*t[2]<=n?[t[0],t[1]*t[2]]:4===t.length&&t[0]<=n&&t[1]*t[2]*t[3]<=n?[t[0],t[1]*t[2]*t[3]]:o.sizeToSquarishShape(r)}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(10),s=n(5),u=function(e){function t(t,n){var r=e.call(this,t,n)||this;return r.learningRate=t,r.setLearningRate(t),r}return r(t,e),t.prototype.applyGradients=function(e){var t=this;Object.keys(e).forEach(function(n){var r=e[n],i=o.ENV.engine.registeredVariables[n];a.tidy(function(){var e=t.c.mul(r).add(i);i.assign(e)})})},t.prototype.setLearningRate=function(e){this.learningRate=e,null!=this.c&&this.c.dispose(),this.c=o.ENV.math.keep(s.scalar(-e))},t.prototype.dispose=function(){this.c.dispose(),null!=this.one&&this.one.dispose(),e.prototype.dispose.call(this)},t.prototype.afterBatch=function(e,t,n,r,o){var u=this;null==this.one&&(this.one=a.keep(s.scalar(1))),a.tidy(function(){u.variableNodes.forEach(function(t){var n=r.get(t.output),o=u.variableGradients.get(t.output),i=e.scaledArrayAdd(u.cGraph,o,u.one,n);r.set(t.output,a.keep(i)),t.data=i,n.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new i.TensorArrayMap},t}(n(14).Optimizer);t.SGDOptimizer=u},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(24),s=n(89),u=n(98),c=n(17),l=n(17),p=n(17),h=function(){function e(){}return e.prototype.computeStatistics=function(e,t){return o(this,void 0,void 0,function(){return a(this,function(n){return[2,u.computeDatasetStatistics(this,e,t)]})})},e.prototype.filter=function(e){var t=this,n=this;return d(function(){return o(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,n.getStream()];case 1:return[2,t.sent().filter(e)]}})})})},e.prototype.map=function(e){var t=this,n=this;return d(function(){return o(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,n.getStream()];case 1:return[2,t.sent().map(e)]}})})})},e.prototype.batch=function(e,t){return void 0===t&&(t=!0),new s.BatchDataset(this,e,t)},e.prototype.concatenate=function(e){var t=this,n=this;return d(function(){return o(t,void 0,void 0,function(){var t,r;return a(this,function(o){switch(o.label){case 0:return[4,n.getStream()];case 1:return r=(t=o.sent()).concatenate,[4,e.getStream()];case 2:return[2,r.apply(t,[o.sent()])]}})})})},e.prototype.repeat=function(e){var t=this,n=this;return d(function(){return o(t,void 0,void 0,function(){var t;return a(this,function(r){switch(r.label){case 0:return t=l.streamFromFunction(function(){return n.getStream()}),[4,c.streamFromConcatenated(t.take(e))];case 1:return[2,r.sent()]}})})})},e.prototype.take=function(e){var t=this,n=this;return d(function(){return o(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,n.getStream()];case 1:return[2,t.sent().take(e)]}})})})},e.prototype.skip=function(e){var t=this,n=this;return d(function(){return o(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,n.getStream()];case 1:return[2,t.sent().skip(e)]}})})})},e.prototype.shuffle=function(e,t,n){var r=this;void 0===n&&(n=!0);var s=this,u=i(t);return d(function(){return o(r,void 0,void 0,function(){var t;return a(this,function(r){switch(r.label){case 0:return t=u.int32(),n&&(t+=u.int32()),[4,s.getStream()];case 1:return[2,r.sent().shuffle(e,t.toString())]}})})})},e.prototype.prefetch=function(e){var t=this,n=this;return d(function(){return o(t,void 0,void 0,function(){return a(this,function(t){switch(t.label){case 0:return[4,n.getStream()];case 1:return[2,t.sent().prefetch(e)]}})})})},e}();function d(e){return new(function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return r(n,t),n.prototype.getStream=function(){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,e()]})})},n}(h))}t.Dataset=h,t.datasetFromStreamFn=d,t.datasetFromElements=function(e){var t=this;return d(function(){return o(t,void 0,void 0,function(){return a(this,function(t){return[2,Promise.resolve(p.streamFromItems(e))]})})})},t.datasetFromConcatenated=function(e){var t=this;return d(function(){return o(t,void 0,void 0,function(){var t;return a(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(e){return e.getStream()}))];case 1:return t=n.sent(),[2,c.streamFromConcatenated(p.streamFromItems(t))]}})})})}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.SELU_SCALEALPHA=1.7580993408473768,t.SELU_SCALE=1.0507009873554805},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(2),o=n(0),a=n(22),i=n(8);function s(e){return Object.keys(e.dict).map(function(t){return e.dict[+t].tensor.node})}t.getTerminatingNodesFromFeedDictionary=s,t.getOrderedEvaluationSetFromEvalTensor=function(e,t){var n=s(t),r=e.map(function(e){return e.node}),o=i.getUnorderedEvaluationSet(r,n);return i.getOrderedEvaluationSet(o)},t.addPersistentArraysToTensorArrayMap=function(e,t){e.forEach(function(e){(e instanceof a.VariableNode||e instanceof a.ConstantNode)&&t.set(e.output,e.data)})},t.getVariableNodesFromEvaluationSet=function(e){var t=[];return e.forEach(function(e){e instanceof a.VariableNode&&t.push(e)}),t},t.throwIfFeedDictionaryContainsNDArrays=function(e){Object.keys(e.dict).forEach(function(t){if(e.dict[+t].data instanceof r.Tensor)throw new Error(\"training requires FeedDictionary entries to be InputProvidersand not NDArrays.\")})},t.loadInputsFromFeedDictionaryToTensorArrayMap=function(e,t,n){Object.keys(e.dict).forEach(function(n){var a,i=e.dict[+n];a=i.data instanceof r.Tensor?i.data:i.data.getNextCopy(),o.assert(o.arraysEqual(i.tensor.shape,a.shape),\"Error loading FeedEntry: feeding NDArray of shape \"+a.shape+\" does not match Tensor (id: \"+i.tensor.id+\") shape: \"+i.tensor.shape+\".\"),t.set(i.tensor,a)})},t.releaseFeedDictionaryInputsFromTensorArrayMap=function(e,t,n){Object.keys(e.dict).forEach(function(n){var o=e.dict[+n];if(!(o.data instanceof r.Tensor)){var a=o.data,i=t.get(o.tensor);a.disposeCopy(i)}t.delete(o.tensor)})},t.removeFeedDictionaryNodesFromEvaluationSet=function(e,t){for(var n=0;n<t.length;){var r=t[n];null!=e.dict[r.output.id]?t.splice(n,1):++n}},t.disposeAndInitializeOperationOutputs=function(e,t){e.forEach(function(e){i.isInputNode(e)||(i.isPassthroughNode(e,t)||t.disposeArray(e.output),t.set(e.output,null))})},t.disposeAndInitializeOperationInputGradients=function(e,t){e.forEach(function(e){Object.keys(e.inputs).forEach(function(n){var r=e.inputs[n];t.get(r,!0)!==t.get(e.output,!0)&&t.disposeArray(r),t.nullify(r)})})},t.disposeTransientOperationArrays=function(e,t,n){e.forEach(function(e){return e.disposeTransientArrays(t,n)})},t.throwErrorIfEvaluationSetContainsPlaceholderNodes=function(e){e.forEach(function(e){if(e instanceof a.PlaceholderNode){var t=\"[\"+e.output.shape.join(\", \")+\"]\";throw new Error('Placeholder node \"'+e.name+'\" '+t+\" not present in feed dictionary.\")}})}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(10),s=n(5),u=n(2),c=n(2),l=function(e){function t(t,n,r,o){void 0===o&&(o=1e-8);var u=e.call(this,t,r)||this;return u.accumulatedGrads={},u.accumulatedUpdates={},u.accumulatedSquaredGradientsGraph=new i.TensorArrayMap,u.accumulatedUpdatesGraph=new i.TensorArrayMap,u.c=a.keep(s.scalar(-t)),u.epsilon=a.keep(s.scalar(o)),u.rho=a.keep(s.scalar(n)),u.oneMinusRho=a.keep(s.scalar(1-n)),u}return r(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var i=o.ENV.engine.registeredVariables[n];if(null==r.accumulatedGrads[n]){a.tidy(function(){t.accumulatedGrads[n]=c.variable(s.zerosLike(i),!1)})}if(null==r.accumulatedUpdates[n]){a.tidy(function(){t.accumulatedUpdates[n]=c.variable(s.zerosLike(i),!1)})}var u=e[n],l=r.accumulatedGrads[n],p=r.accumulatedUpdates[n];a.tidy(function(){var e=t.rho.mul(l).add(t.oneMinusRho.mul(u.square())),r=p.add(t.epsilon).sqrt().div(l.add(t.epsilon).sqrt()).mul(u),o=t.rho.mul(p).add(t.oneMinusRho.mul(r.square()));t.accumulatedGrads[n].assign(e),t.accumulatedUpdates[n].assign(o);var a=t.c.mul(r).add(i);i.assign(a)})},r=this;for(var i in e)n(i)},t.prototype.beforeBatch=function(t,n,r,o,a){var i=this;e.prototype.beforeBatch.call(this,t,n,r,o,a),0===this.accumulatedSquaredGradientsGraph.size()&&this.variableNodes.forEach(function(e){i.accumulatedSquaredGradientsGraph.set(e.output,u.Tensor.zeros(e.output.shape)),i.accumulatedUpdatesGraph.set(e.output,u.Tensor.zeros(e.output.shape))})},t.prototype.afterBatch=function(e,t,n,r,o){var u=this;null==this.one&&(this.one=a.keep(s.scalar(1))),a.tidy(function(){u.variableNodes.forEach(function(t){var n=r.get(t.output),o=u.variableGradients.get(t.output),i=u.accumulatedSquaredGradientsGraph.get(t.output),s=u.accumulatedUpdatesGraph.get(t.output),c=e.multiply(o,o),l=e.scaledArrayAdd(u.rho,i,e.subtract(u.one,u.rho),c),p=e.multiply(e.divide(e.sqrt(e.add(s,u.epsilon)),e.sqrt(e.add(i,u.epsilon))),o),h=e.scaledArrayAdd(u.cGraph,p,u.one,n),d=e.multiply(p,p),f=e.scaledArrayAdd(u.rho,s,e.subtract(u.one,u.rho),d);u.accumulatedSquaredGradientsGraph.set(t.output,a.keep(l)),u.accumulatedUpdatesGraph.set(t.output,a.keep(f)),r.set(t.output,a.keep(h)),t.data=h,n.dispose(),i.dispose(),s.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new i.TensorArrayMap},t.prototype.dispose=function(){var t=this;e.prototype.dispose.call(this),this.c.dispose(),this.epsilon.dispose(),this.rho.dispose(),this.oneMinusRho.dispose(),null!=this.one&&this.one.dispose(),null!=this.accumulatedSquaredGradientsGraph&&this.accumulatedSquaredGradientsGraph.dispose(),null!=this.accumulatedUpdatesGraph&&this.accumulatedUpdatesGraph.dispose(),null!=this.accumulatedUpdates&&(Object.keys(this.accumulatedUpdates).forEach(function(e){return t.accumulatedUpdates[e].dispose()}),Object.keys(this.accumulatedGrads).forEach(function(e){return t.accumulatedGrads[e].dispose()}))},t}(n(14).Optimizer);t.AdadeltaOptimizer=l},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(10),s=n(5),u=n(2),c=n(2),l=function(e){function t(t,n,r){void 0===r&&(r=.1);var o=e.call(this,t,n)||this;return o.learningRate=t,o.initialAccumulatorValue=r,o.accumulatedGrads={},o.accumulatedSquaredGradients=new i.TensorArrayMap,o.c=a.keep(s.scalar(-t)),o.epsilon=a.keep(s.scalar(1e-8)),o}return r(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var i=o.ENV.engine.registeredVariables[n];if(null==r.accumulatedGrads[n]){a.tidy(function(){t.accumulatedGrads[n]=c.variable(s.fill(i.shape,t.initialAccumulatorValue),!1)})}var u=e[n],l=r.accumulatedGrads[n];a.tidy(function(){var e=l.add(u.square());t.accumulatedGrads[n].assign(e);var r=t.c.mul(u.div(e.add(t.epsilon).sqrt())).add(i);i.assign(r)})},r=this;for(var i in e)n(i)},t.prototype.beforeBatch=function(t,n,r,o,a){var i=this;e.prototype.beforeBatch.call(this,t,n,r,o,a),0===this.accumulatedSquaredGradients.size()&&this.variableNodes.forEach(function(e){i.accumulatedSquaredGradients.set(e.output,u.Tensor.zeros(e.output.shape))})},t.prototype.afterBatch=function(e,t,n,r,o){var u=this;null==this.one&&(this.one=a.keep(s.scalar(1))),a.tidy(function(){u.variableNodes.forEach(function(t){var n=r.get(t.output),o=u.variableGradients.get(t.output),i=u.accumulatedSquaredGradients.get(t.output),s=e.multiply(o,o),c=e.add(i,s),l=e.scaledArrayAdd(u.cGraph,e.divide(o,e.add(e.sqrt(c),u.epsilon)),u.one,n);u.accumulatedSquaredGradients.set(t.output,a.keep(c)),r.set(t.output,a.keep(l)),t.data=l,n.dispose(),i.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new i.TensorArrayMap},t.prototype.dispose=function(){var t=this;e.prototype.dispose.call(this),this.epsilon.dispose(),this.c.dispose(),null!=this.one&&this.one.dispose(),null!=this.accumulatedSquaredGradients&&this.accumulatedSquaredGradients.dispose(),null!=this.accumulatedGrads&&Object.keys(this.accumulatedGrads).forEach(function(e){return t.accumulatedGrads[e].dispose()})},t}(n(14).Optimizer);t.AdagradOptimizer=l},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(10),s=n(5),u=n(2),c=n(2),l=function(e){function t(t,n,r,o,u){void 0===o&&(o=1e-8);var l=e.call(this,t,u)||this;return l.learningRate=t,l.accumulatedFirstMoment={},l.accumulatedSecondMoment={},l.firstMomentGraph=new i.TensorArrayMap,l.secondMomentGraph=new i.TensorArrayMap,l.c=a.keep(s.scalar(-t)),l.eps=a.keep(s.scalar(o)),l.beta1=a.keep(s.scalar(n)),l.beta2=a.keep(s.scalar(r)),a.tidy(function(){l.accBeta1=c.variable(s.scalar(n)),l.accBeta2=c.variable(s.scalar(r))}),l.oneMinusBeta1=a.keep(s.scalar(1-n)),l.oneMinusBeta2=a.keep(s.scalar(1-r)),l.one=a.keep(s.scalar(1)),l}return r(t,e),t.prototype.applyGradients=function(e){var t=this;a.tidy(function(){var n=t.one.sub(t.accBeta1),r=t.one.sub(t.accBeta2);for(var a in e){var i=o.ENV.engine.registeredVariables[a];if(null==t.accumulatedFirstMoment[a]){var u=!1;t.accumulatedFirstMoment[a]=c.variable(s.zerosLike(i),u)}if(null==t.accumulatedSecondMoment[a]){u=!1;t.accumulatedSecondMoment[a]=c.variable(s.zerosLike(i),u)}var l=e[a],p=t.accumulatedFirstMoment[a],h=t.accumulatedSecondMoment[a],d=t.beta1.mul(p).add(t.oneMinusBeta1.mul(l)),f=t.beta2.mul(h).add(t.oneMinusBeta2.mul(l.square())),m=d.div(n),v=f.div(r);t.accumulatedFirstMoment[a].assign(d),t.accumulatedSecondMoment[a].assign(f);var g=t.c.mul(m.div(t.eps.add(v.sqrt()))).add(i);i.assign(g)}t.accBeta1.assign(t.accBeta1.mul(t.beta1)),t.accBeta2.assign(t.accBeta2.mul(t.beta2))})},t.prototype.beforeBatch=function(t,n,r,o,a){var i=this;e.prototype.beforeBatch.call(this,t,n,r,o,a),0===this.firstMomentGraph.size()&&this.variableNodes.forEach(function(e){i.firstMomentGraph.set(e.output,u.Tensor.zeros(e.output.shape))}),0===this.secondMomentGraph.size()&&this.variableNodes.forEach(function(e){i.secondMomentGraph.set(e.output,u.Tensor.zeros(e.output.shape))})},t.prototype.afterBatch=function(e,t,n,r,o){var s=this;a.tidy(function(){var t=s.one.sub(s.accBeta1),n=s.one.sub(s.accBeta2);s.variableNodes.forEach(function(o){var i=r.get(o.output),u=s.variableGradients.get(o.output),c=s.firstMomentGraph.get(o.output),l=s.secondMomentGraph.get(o.output),p=e.scaledArrayAdd(s.beta1,c,s.oneMinusBeta1,u),h=e.scaledArrayAdd(s.beta2,l,s.oneMinusBeta2,u.square()),d=p.div(t),f=h.div(n),m=e.scaledArrayAdd(s.cGraph,d.div(s.eps.add(f.sqrt())),s.one,i);r.set(o.output,a.keep(m)),o.data=m,s.firstMomentGraph.set(o.output,a.keep(p)),s.secondMomentGraph.set(o.output,a.keep(h)),i.dispose(),u.dispose(),c.dispose(),l.dispose()}),s.accBeta1.assign(s.accBeta1.mul(s.beta1)),s.accBeta2.assign(s.accBeta2.mul(s.beta2))}),this.variableGradients.dispose(),this.variableGradients=new i.TensorArrayMap},t.prototype.dispose=function(){var t=this;e.prototype.dispose.call(this),this.c.dispose(),this.eps.dispose(),this.beta1.dispose(),this.beta2.dispose(),this.accBeta1.dispose(),this.accBeta2.dispose(),this.oneMinusBeta1.dispose(),this.oneMinusBeta2.dispose(),this.one.dispose(),null!=this.firstMomentGraph&&this.firstMomentGraph.dispose(),null!=this.secondMomentGraph&&this.secondMomentGraph.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach(function(e){return t.accumulatedFirstMoment[e].dispose()}),null!=this.accumulatedSecondMoment&&Object.keys(this.accumulatedSecondMoment).forEach(function(e){return t.accumulatedSecondMoment[e].dispose()})},t}(n(14).Optimizer);t.AdamOptimizer=l},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(10),s=n(5),u=n(2),c=n(2),l=function(e){function t(t,n,r,o,u,l){void 0===o&&(o=1e-8),void 0===u&&(u=0);var p=e.call(this,t,l)||this;return p.learningRate=t,p.accumulatedFirstMoment={},p.accumulatedWeightedInfNorm={},p.firstMomentGraph=new i.TensorArrayMap,p.weightedInfNormGraph=new i.TensorArrayMap,p.c=a.keep(s.scalar(-t)),p.eps=a.keep(s.scalar(o)),p.beta1=a.keep(s.scalar(n)),p.beta2=a.keep(s.scalar(r)),p.decay=a.keep(s.scalar(u)),a.tidy(function(){p.iteration=c.variable(s.scalar(0)),p.accBeta1=c.variable(s.scalar(n))}),p.oneMinusBeta1=a.keep(s.scalar(1-n)),p.one=a.keep(s.scalar(1)),p}return r(t,e),t.prototype.applyGradients=function(e){var t=this;a.tidy(function(){var n=t.one.sub(t.accBeta1),r=t.c.div(t.one.add(t.decay.mul(t.iteration)));for(var a in e){var i=o.ENV.engine.registeredVariables[a];if(null==t.accumulatedFirstMoment[a]){var u=!1;t.accumulatedFirstMoment[a]=c.variable(s.zerosLike(i),u)}if(null==t.accumulatedWeightedInfNorm[a]){u=!1;t.accumulatedWeightedInfNorm[a]=c.variable(s.zerosLike(i),u)}var l=e[a],p=t.accumulatedFirstMoment[a],h=t.accumulatedWeightedInfNorm[a],d=t.beta1.mul(p).add(t.oneMinusBeta1.mul(l)),f=t.beta2.mul(h),m=l.abs(),v=f.maximum(m);t.accumulatedFirstMoment[a].assign(d),t.accumulatedWeightedInfNorm[a].assign(v);var g=r.div(n).mul(d.div(t.eps.add(v))).add(i);i.assign(g)}t.iteration.assign(t.iteration.add(t.one)),t.accBeta1.assign(t.accBeta1.mul(t.beta1))})},t.prototype.beforeBatch=function(t,n,r,o,a){var i=this;e.prototype.beforeBatch.call(this,t,n,r,o,a),0===this.firstMomentGraph.size()&&this.variableNodes.forEach(function(e){i.firstMomentGraph.set(e.output,u.Tensor.zeros(e.output.shape))}),0===this.weightedInfNormGraph.size()&&this.variableNodes.forEach(function(e){i.weightedInfNormGraph.set(e.output,u.Tensor.zeros(e.output.shape))})},t.prototype.afterBatch=function(e,t,n,r,o){var s=this;a.tidy(function(){var t=s.cGraph.div(s.one.add(s.decay.mul(s.iteration)));s.variableNodes.forEach(function(n){var o=r.get(n.output),i=s.variableGradients.get(n.output),u=s.firstMomentGraph.get(n.output),c=s.weightedInfNormGraph.get(n.output),l=e.scaledArrayAdd(s.beta1,u,s.oneMinusBeta1,i),p=s.beta2.mul(c),h=i.abs(),d=p.maximum(h),f=e.scaledArrayAdd(s.one,o,t.div(s.one.sub(s.accBeta1)),l.div(s.eps.add(d)));r.set(n.output,a.keep(f)),n.data=f,s.firstMomentGraph.set(n.output,a.keep(l)),s.weightedInfNormGraph.set(n.output,a.keep(d)),o.dispose(),i.dispose(),u.dispose(),c.dispose()}),s.iteration.assign(s.iteration.add(s.one)),s.accBeta1.assign(s.accBeta1.mul(s.beta1))}),this.variableGradients.dispose(),this.variableGradients=new i.TensorArrayMap},t.prototype.dispose=function(){var t=this;e.prototype.dispose.call(this),this.c.dispose(),this.eps.dispose(),this.accBeta1.dispose(),this.beta1.dispose(),this.beta2.dispose(),this.oneMinusBeta1.dispose(),this.decay.dispose(),this.iteration.dispose(),this.one.dispose(),null!=this.firstMomentGraph&&this.firstMomentGraph.dispose(),null!=this.weightedInfNormGraph&&this.weightedInfNormGraph.dispose(),null!=this.accumulatedFirstMoment&&Object.keys(this.accumulatedFirstMoment).forEach(function(e){return t.accumulatedFirstMoment[e].dispose()}),null!=this.accumulatedWeightedInfNorm&&Object.keys(this.accumulatedWeightedInfNorm).forEach(function(e){return t.accumulatedWeightedInfNorm[e].dispose()})},t}(n(14).Optimizer);t.AdamaxOptimizer=l},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(10),s=n(5),u=n(2),c=n(2),l=function(e){function t(t,n,r){var o=e.call(this,t,r)||this;return o.learningRate=t,o.momentum=n,o.m=s.scalar(o.momentum),o.accumulations={},o}return r(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var i=o.ENV.engine.registeredVariables[n];if(null==r.accumulations[n]){a.tidy(function(){t.accumulations[n]=c.variable(s.zerosLike(i),!1)})}var u=r.accumulations[n],l=e[n];a.tidy(function(){var e=t.m.mul(u).add(l);t.accumulations[n].assign(e);var r=t.c.mul(e).add(i);i.assign(r)})},r=this;for(var i in e)n(i)},t.prototype.beforeBatch=function(t,n,r,o,a){var s=this;null==this.variableVelocitiesGraph&&(this.variableVelocitiesGraph=new i.TensorArrayMap),e.prototype.beforeBatch.call(this,t,n,r,o,a),0===this.variableVelocitiesGraph.size()&&this.variableNodes.forEach(function(e){s.variableVelocitiesGraph.set(e.output,u.Tensor.zeros(e.output.shape))})},t.prototype.afterBatch=function(e,t,n,r,o){var u=this;null==this.one&&(this.one=a.keep(s.scalar(1))),a.tidy(function(){u.variableNodes.forEach(function(t){var n=r.get(t.output),o=u.variableGradients.get(t.output),i=u.variableVelocitiesGraph.get(t.output),s=e.scaledArrayAdd(u.m,i,u.one,o),c=e.scaledArrayAdd(u.cGraph,s,u.one,n);u.variableVelocitiesGraph.set(t.output,a.keep(s)),r.set(t.output,a.keep(c)),t.data=c,n.dispose(),i.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new i.TensorArrayMap},t.prototype.dispose=function(){if(e.prototype.dispose.call(this),this.m.dispose(),null!=this.one&&this.one.dispose(),null!=this.variableVelocitiesGraph&&this.variableVelocitiesGraph.dispose(),null!=this.accumulations)for(var t in this.accumulations)this.accumulations[t].dispose()},t.prototype.setMomentum=function(e){this.momentum=e},t}(n(27).SGDOptimizer);t.MomentumOptimizer=l},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(30),s=n(10),u=n(5),c=n(2),l=n(2),p=function(e){function t(t,n,r,o,i){void 0===n&&(n=.9),void 0===r&&(r=0),void 0===i&&(i=1e-8);var c=e.call(this,t,o)||this;return c.learningRate=t,c.accumulatedMeanSquares={},c.accumulatedMoments={},c.accumulatedMeanSquaredGraph=new s.TensorArrayMap,c.accumulatedMomentGraph=new s.TensorArrayMap,c.c=a.keep(u.scalar(t)),c.epsilon=a.keep(u.scalar(i)),c.decay=a.keep(u.scalar(n)),c.momentum=a.keep(u.scalar(r)),c.oneMinusDecay=a.keep(u.scalar(1-n)),c}return r(t,e),t.prototype.applyGradients=function(e){var t=this,n=function(n){var i=o.ENV.engine.registeredVariables[n];if(null==r.accumulatedMeanSquares[n]){a.tidy(function(){t.accumulatedMeanSquares[n]=l.variable(u.zerosLike(i),!1)})}if(null==r.accumulatedMoments[n]){a.tidy(function(){t.accumulatedMoments[n]=l.variable(u.zerosLike(i),!1)})}var s=r.accumulatedMeanSquares[n],c=r.accumulatedMoments[n],p=e[n];a.tidy(function(){var e=t.decay.mul(s).add(t.oneMinusDecay.mul(p.square())),r=t.momentum.mul(c).add(t.c.mul(p).div(e.add(t.epsilon).sqrt()));t.accumulatedMeanSquares[n].assign(e),t.accumulatedMoments[n].assign(r);var o=i.sub(r);i.assign(o)})},r=this;for(var i in e)n(i)},t.prototype.beforeBatch=function(e,t,n,r,o){var a=this;this.variableNodes=null==this.specifiedVariableNodes?i.getVariableNodesFromEvaluationSet(n.nodes):this.specifiedVariableNodes,t!==this.prevBatchSize&&(null!=this.cGraph&&this.cGraph.dispose(),this.prevBatchSize=t,this.cGraph=e.keep(u.scalar(this.learningRate/t))),this.variableNodes.forEach(function(t){return a.variableGradients.set(t.output,e.keep(c.Tensor.zeros(t.output.shape)))}),0===this.accumulatedMeanSquaredGraph.size()&&this.variableNodes.forEach(function(e){a.accumulatedMeanSquaredGraph.set(e.output,c.Tensor.zeros(e.output.shape)),a.accumulatedMomentGraph.set(e.output,c.Tensor.zeros(e.output.shape))})},t.prototype.afterBatch=function(e,t,n,r,o){var i=this;a.tidy(function(){i.variableNodes.forEach(function(t){var n=r.get(t.output),o=i.variableGradients.get(t.output),s=i.accumulatedMeanSquaredGraph.get(t.output),u=i.accumulatedMomentGraph.get(t.output),c=e.scaledArrayAdd(i.decay,s,i.oneMinusDecay,o.square()),l=e.scaledArrayAdd(i.momentum,u,i.cGraph,o.div(c.add(i.epsilon).sqrt())),p=n.sub(l);i.accumulatedMeanSquaredGraph.set(t.output,a.keep(c)),i.accumulatedMomentGraph.set(t.output,a.keep(l)),r.set(t.output,a.keep(p)),t.data=p,n.dispose(),s.dispose(),u.dispose()})}),this.variableGradients.dispose(),this.variableGradients=new s.TensorArrayMap},t.prototype.dispose=function(){var t=this;e.prototype.dispose.call(this),this.c.dispose(),this.epsilon.dispose(),this.decay.dispose(),this.momentum.dispose(),this.oneMinusDecay.dispose(),null!=this.accumulatedMeanSquaredGraph&&this.accumulatedMeanSquaredGraph.dispose(),null!=this.accumulatedMomentGraph&&this.accumulatedMomentGraph.dispose(),null!=this.accumulatedMeanSquares&&Object.keys(this.accumulatedMeanSquares).forEach(function(e){return t.accumulatedMeanSquares[e].dispose()}),null!=this.accumulatedMoments&&Object.keys(this.accumulatedMoments).forEach(function(e){return t.accumulatedMoments[e].dispose()})},t}(n(14).Optimizer);t.RMSPropOptimizer=p},function(e,t){var n;n=function(){return this}();try{n=n||Function(\"return this\")()||(0,eval)(\"this\")}catch(e){\"object\"==typeof window&&(n=window)}e.exports=n},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=function(){function e(){}return e.tidy=function(e,t,n){if(void 0===n&&(n=!1),null==t){if(\"function\"!=typeof e)throw new Error(\"Please provide a function to dl.tidy()\");t=e,e=\"\"}else{if(\"string\"!=typeof e&&!(e instanceof String))throw new Error(\"When calling with two arguments, the first argument to dl.tidy() must be a string\");if(\"function\"!=typeof t)throw new Error(\"When calling with two arguments, the 2nd argument to dl.tidy() must be a function\")}a.ENV.engine.startScope(n);var r=t();return r instanceof Promise?(r.then(function(e){return a.ENV.engine.endScope(e,n)}),r):(a.ENV.engine.endScope(r,n),r)},e.keep=function(e){return a.ENV.engine.keep(e)},e.time=function(e){return a.ENV.engine.time(e)},r([o.doc({heading:\"Performance\",subheading:\"Memory\"})],e,\"tidy\",null),r([o.doc({heading:\"Performance\",subheading:\"Memory\"})],e,\"keep\",null),r([o.doc({heading:\"Performance\",subheading:\"Timing\"})],e,\"time\",null),e}();t.Tracking=i},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(2),s=n(0),u=n(40),c=n(6),l=n(94),p=function(){function e(){}return e.tensor=function(e,t,n){void 0===n&&(n=\"float32\");var r=s.inferShape(e);return null!=t&&1!==r.length&&s.assertShapesMatch(t,r,\"Error creating a new Tensor. Inferred shape (\"+r+\") does not match the provided shape (\"+t+\"). \"),s.isTypedArray(e)||Array.isArray(e)||(e=[e]),t=t||r,i.Tensor.make(t,{values:function(e,t){if(function(e,t){return e instanceof Float32Array&&\"float32\"===t||e instanceof Int32Array&&\"int32\"===t||e instanceof Uint8Array&&\"bool\"===t}(e,t))return e;Array.isArray(e)&&(e=s.flatten(e));return s.copyTypedArray(e,t)}(e,n)},n)},e.scalar=function(t,n){if(void 0===n&&(n=\"float32\"),s.isTypedArray(t)||Array.isArray(t))throw new Error(\"Error creating a new Scalar: value must be a primitive (number|boolean)\");return e.tensor(t,[],n)},e.tensor1d=function(t,n){void 0===n&&(n=\"float32\");var r=s.inferShape(t);if(1!==r.length)throw new Error(\"Error creating a new Tensor1D: values must be a flat/TypedArray\");return e.tensor(t,r,n)},e.tensor2d=function(t,n,r){void 0===r&&(r=\"float32\");var o=s.inferShape(t);if(2!==o.length&&1!==o.length)throw new Error(\"Error creating a new Tensor2D: values must be number[][] or flat/TypedArray\");return n=n||o,e.tensor(t,n,r)},e.tensor3d=function(t,n,r){void 0===r&&(r=\"float32\");var o=s.inferShape(t);if(3!==o.length&&1!==o.length)throw new Error(\"Error creating a new Tensor3D: values must be number[][][]or flat/TypedArray\");return n=n||o,e.tensor(t,n,r)},e.tensor4d=function(t,n,r){void 0===r&&(r=\"float32\");var o=s.inferShape(t);if(4!==o.length&&1!==o.length)throw new Error(\"Error creating a new Tensor4D: values must be number[][][][]or flat/TypedArray\");return n=n||o,e.tensor(t,n,r)},e.ones=function(e,t){void 0===t&&(t=\"float32\");var n=function(e,t){for(var n=h(e,t),r=0;r<n.length;r++)n[r]=1;return n}(s.sizeFromShape(e),t);return i.Tensor.make(e,{values:n},t)},e.zeros=function(e,t){void 0===t&&(t=\"float32\");var n=h(s.sizeFromShape(e),t);return i.Tensor.make(e,{values:n},t)},e.fill=function(e,t,n){void 0===n&&(n=\"float32\");var r=s.getTypedArrayFromDType(n,s.sizeFromShape(e));return r.fill(t),i.Tensor.make(e,{values:r},n)},e.onesLike=function(t){return e.ones(t.shape,t.dtype)},e.zerosLike=function(t){return e.zeros(t.shape,t.dtype)},e.clone=function(e){return i.Tensor.make(e.shape,{dataId:e.dataId},e.dtype)},e.randomNormal=function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&\"bool\"===r)throw new Error(\"Unsupported data type \"+r);var a=new l.MPRandGauss(t,n,r,!1,o);return i.Tensor.rand(e,function(){return a.nextValue()},r)},e.truncatedNormal=function(e,t,n,r,o){if(void 0===t&&(t=0),void 0===n&&(n=1),null!=r&&\"bool\"===r)throw new Error(\"Unsupported data type \"+r);var a=new l.MPRandGauss(t,n,r,!0,o);return i.Tensor.rand(e,function(){return a.nextValue()},r)},e.randomUniform=function(e,t,n,r){return void 0===t&&(t=0),void 0===n&&(n=1),void 0===r&&(r=\"float32\"),i.Tensor.rand(e,function(){return s.randUniform(t,n)},r)},e.rand=function(e,t,n){var r=s.sizeFromShape(e),o=null;if(null==n||\"float32\"===n)o=new Float32Array(r);else if(\"int32\"===n)o=new Int32Array(r);else{if(\"bool\"!==n)throw new Error(\"Unknown data type \"+n);o=new Uint8Array(r)}for(var a=0;a<r;a++)o[a]=t();return i.Tensor.make(e,{values:o},n)},e.multinomial=function(e,t,n){var r=e.size;if(r<2)throw new Error(\"Error in multinomial: you need at least 2 outcomes, but got \"+r+\".\");if(e.rank>2)throw new Error(\"Rank of probabilities must be 1 or 2, but is \"+e.rank);n=n||Math.random();var o=e.rank;1===e.rank&&(e=e.as2D(1,-1));var i=a.ENV.engine.executeKernel(\"Multinomial\",{inputs:{probs:e},args:{numSamples:t,seed:n}});return 1===o?i.as1D():i},e.oneHot=function(e,t,n,r){if(void 0===n&&(n=1),void 0===r&&(r=0),t<2)throw new Error(\"Error in oneHot: depth must be >=2, but it is \"+t);return a.ENV.engine.executeKernel(\"OneHot\",{inputs:{indices:e},args:{depth:t,onValue:n,offValue:r}})},e.fromPixels=function(e,t){if(void 0===t&&(t=3),t>4)throw new Error(\"Cannot construct Tensor with more than 4 channels from pixels.\");return a.ENV.engine.fromPixels(e,t)},e.reshape=function(e,t){t=s.inferFromImplicitShape(t,e.size),s.assert(e.size===s.sizeFromShape(t),\"new shape and old shape must have the same number of elements.\");return a.ENV.engine.executeKernel(\"Reshape\",{inputs:{x:e},args:{newShape:t}},function(t,n){return{x:function(){return t.reshape(e.shape)}}})},e.squeeze=function(t,n){return e.reshape(t,s.squeezeShape(t.shape,n).newShape)},e.cast=function(e,t){return a.ENV.engine.executeKernel(\"Cast\",{inputs:{x:e},args:{newDType:t}},function(e,t){return{x:function(){return e.reshape(e.shape)}}})},e.tile=function(e,t){return s.assert(e.rank===t.length,\"Error in transpose: rank of input \"+e.rank+\" must match length of reps \"+t+\".\"),a.ENV.engine.executeKernel(\"Tile\",{inputs:{x:e},args:{reps:t}})},e.gather=function(e,t,n){return void 0===n&&(n=0),a.ENV.engine.executeKernel(\"Gather\",{inputs:{x:e,indices:t},args:{axis:n}})},e.pad1d=function(e,t,n){return void 0===n&&(n=0),s.assert(2===t.length,\"Invalid number of paddings. Must be length of 2.\"),a.ENV.engine.executeKernel(\"Pad1D\",{inputs:{x:e},args:{paddings:t,constantValue:n}})},e.pad2d=function(e,t,n){return void 0===n&&(n=0),s.assert(2===t.length&&2===t[0].length&&2===t[1].length,\"Invalid number of paddings. Must be length of 2 each.\"),a.ENV.engine.executeKernel(\"Pad2D\",{inputs:{x:e},args:{paddings:t,constantValue:n}})},e.pad=function(t,n,r){if(void 0===r&&(r=0),0===t.rank)throw new Error(\"pad(scalar) is not defined. Pass non-scalar to pad\");if(1===t.rank)return e.pad1d(t,n[0],r);if(2===t.rank)return e.pad2d(t,n,r);throw new Error(\"pad of rank-\"+t.rank+\" tensor is not yet supported\")},e.stack=function(e,t){void 0===t&&(t=0),s.assert(e.length>=2,\"Pass at least two tensors to dl.stack\");var n=e[0].rank,r=e[0].shape,o=e[0].dtype;s.assert(t<=n,\"Axis must be <= rank of the tensor\"),e.forEach(function(e){s.assertShapesMatch(r,e.shape,\"All tensors passed to stack must have matching shapes\")}),e.forEach(function(e){s.assert(o===e.dtype,\"All tensors passed to stack must have matching dtypes\")});var a=e.map(function(e){return e.expandDims(t)});return u.Concat.concat(a,t)},e.expandDims=function(t,n){void 0===n&&(n=0),s.assert(n<=t.rank,\"Axis must be <= rank of the tensor\");var r=t.shape.slice();return r.splice(n,0,1),e.reshape(t,r)},e.linspace=function(e,t,n){if(0===n)throw new Error(\"Cannot request zero samples\");var r=(t-e)/(n-1),o=h(n,\"float32\");o[0]=e;for(var a=1;a<o.length;a++)o[a]=o[a-1]+r;return i.Tensor1D.new(o,\"float32\")},e.range=function(t,n,r,o){if(void 0===r&&(r=1),void 0===o&&(o=\"float32\"),0===r)throw new Error(\"Cannot have a step of zero\");if(t===n||t<n&&r<0||n<t&&r>1)return e.zeros([0],o);var a=h(Math.abs(Math.ceil((n-t)/r)),o);n<t&&1===r&&(r=-1),a[0]=t;for(var i=1;i<a.length;i++)a[i]=a[i-1]+r;return e.tensor1d(a,o)},e.buffer=function(e,t,n){return void 0===t&&(t=\"float32\"),new i.TensorBuffer(e,t,n)},e.print=function(e,t){void 0===t&&(t=!1);var n=new(function(){return function(){}}());n.shape=e.shape,n.values=Array.from(e.dataSync()),n.toString=function(){var n=[\"values: [\"+this.values.join(\", \")+\"]\",\"shape: [\"+e.shape.join(\", \")+\"]\",\"rank: \"+e.rank];t&&(n.push(\"dtype: '\"+this.dtype+\"'\"),n.push(\"size: \"+this.size));for(var r=0;r<n.length;r++)n[r]=\"  \"+n[r];return\"TensorInfo {\\n\"+n.join(\",\\n\")+\"\\n}\"},t&&(n.dtype=e.dtype,n.size=e.size),console.log(n)},r([o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"tensor\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"scalar\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"tensor1d\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"tensor2d\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"tensor3d\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"tensor4d\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"ones\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"zeros\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"fill\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"onesLike\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"zerosLike\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"clone\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"randomNormal\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"truncatedNormal\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"randomUniform\",null),r([c.operation],e,\"rand\",null),r([c.operation],e,\"multinomial\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"oneHot\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"}),c.operation],e,\"fromPixels\",null),r([o.doc({heading:\"Tensors\",subheading:\"Transformations\"}),c.operation],e,\"reshape\",null),r([o.doc({heading:\"Tensors\",subheading:\"Transformations\"})],e,\"squeeze\",null),r([o.doc({heading:\"Tensors\",subheading:\"Transformations\"}),c.operation],e,\"cast\",null),r([o.doc({heading:\"Tensors\",subheading:\"Slicing and Joining\"}),c.operation],e,\"tile\",null),r([o.doc({heading:\"Tensors\",subheading:\"Slicing and Joining\"}),c.operation],e,\"gather\",null),r([c.operation],e,\"pad1d\",null),r([c.operation],e,\"pad2d\",null),r([o.doc({heading:\"Tensors\",subheading:\"Transformations\"}),c.operation],e,\"pad\",null),r([o.doc({heading:\"Tensors\",subheading:\"Slicing and Joining\"}),c.operation],e,\"stack\",null),r([o.doc({heading:\"Tensors\",subheading:\"Transformations\"}),c.operation],e,\"expandDims\",null),r([c.operation,o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"linspace\",null),r([c.operation,o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"range\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"buffer\",null),r([o.doc({heading:\"Tensors\",subheading:\"Creation\"})],e,\"print\",null),e}();function h(e,t){if(null==t||\"float32\"===t)return new Float32Array(e);if(\"int32\"===t)return new Int32Array(e);if(\"bool\"===t)return new Uint8Array(e);throw new Error(\"Unknown data type $ {dtype}\")}t.Ops=p},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(19),u=n(6),c=function(){function e(){}return e.concat1d=function(t){return e.concat(t,0)},e.concat2d=function(t,n){return e.concat(t,n)},e.concat3d=function(t,n){return e.concat(t,n)},e.concat4d=function(t,n){return e.concat(t,n)},e.concat=function(e,t){void 0===t&&(t=0),i.assert(e.length>=2,\"Pass at least two tensors to concat\");for(var n=e[0],r=1;r<e.length;++r)n=l(n,e[r],t);return n},r([o.doc({heading:\"Tensors\",subheading:\"Slicing and Joining\"}),u.operation],e,\"concat\",null),e}();function l(e,t,n){s.assertParams(e.shape,t.shape,n);var r=s.computeOutShape(e.shape,t.shape,n),o=e.as2D(-1,i.sizeFromShape(e.shape.slice(n))),u=t.as2D(-1,i.sizeFromShape(t.shape.slice(n))),c=s.computeGradientSliceShapes(o.shape,u.shape),l=c.aBegin,p=c.aSize,h=c.bBegin,d=c.bSize;return a.ENV.engine.executeKernel(\"Concat\",{inputs:{a:o,b:u}},function(e){return{a:function(){return e.slice(l,p)},b:function(){return e.slice(h,d)}}}).reshape(r)}t.Concat=c},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(6),u=function(){function e(){}return e.batchNormalization2d=function(t,n,r,o,a,s){return void 0===o&&(o=.001),i.assert(2===t.rank,\"Error in batchNormalization3D: x must be rank 3 but got rank \"+t.rank+\".\"),i.assert(2===n.rank||1===n.rank,\"Error in batchNormalization2D: mean must be rank 2 or rank 1 but got rank \"+n.rank+\".\"),i.assert(2===r.rank||1===r.rank,\"Error in batchNormalization2D: variance must be rank 2 or rank 1 but got rank \"+r.rank+\".\"),null!=a&&i.assert(2===a.rank||1===a.rank,\"Error in batchNormalization2D: scale must be rank 2 or rank 1 but got rank \"+a.rank+\".\"),null!=s&&i.assert(2===s.rank||1===s.rank,\"Error in batchNormalization2D: offset must be rank 2 or rank 1 but got rank \"+s.rank+\".\"),e.batchNormalization(t,n,r,o,a,s)},e.batchNormalization3d=function(t,n,r,o,a,s){return void 0===o&&(o=.001),i.assert(3===t.rank,\"Error in batchNormalization3D: x must be rank 3 but got rank \"+t.rank+\".\"),i.assert(3===n.rank||1===n.rank,\"Error in batchNormalization3D: mean must be rank 3 or rank 1 but got rank \"+n.rank+\".\"),i.assert(3===r.rank||1===r.rank,\"Error in batchNormalization3D: variance must be rank 3 or rank 1 but got rank \"+r.rank+\".\"),null!=a&&i.assert(3===a.rank||1===a.rank,\"Error in batchNormalization3D: scale must be rank 3 or rank 1 but got rank \"+a.rank+\".\"),null!=s&&i.assert(3===s.rank||1===s.rank,\"Error in batchNormalization3D: offset must be rank 3 or rank 1 but got rank \"+s.rank+\".\"),e.batchNormalization(t,n,r,o,a,s)},e.batchNormalization4d=function(t,n,r,o,a,s){return void 0===o&&(o=.001),i.assert(4===t.rank,\"Error in batchNormalization4D: x must be rank 4 but got rank \"+t.rank+\".\"),i.assert(4===n.rank||1===n.rank,\"Error in batchNormalization4D: mean must be rank 4 or rank 1 but got rank \"+n.rank+\".\"),i.assert(4===r.rank||1===r.rank,\"Error in batchNormalization4D: variance must be rank 4 or rank 1 but got rank \"+r.rank+\".\"),null!=a&&i.assert(4===a.rank||1===a.rank,\"Error in batchNormalization4D: scale must be rank 4 or rank 1 but got rank \"+a.rank+\".\"),null!=s&&i.assert(4===s.rank||1===s.rank,\"Error in batchNormalization4D: offset must be rank 4 or rank 1 but got rank \"+s.rank+\".\"),e.batchNormalization(t,n,r,o,a,s)},e.batchNormalization=function(e,t,n,r,o,i){var s;return void 0===r&&(r=.001),s=0===e.rank||1===e.rank?e.as4D(1,1,1,e.size):2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e,a.ENV.engine.executeKernel(\"BatchNorm4D\",{inputs:{x:s,mean:c(t),variance:c(n),scale:c(o),offset:c(i)},args:{varianceEpsilon:r}}).reshape(e.shape)},r([s.operation],e,\"batchNormalization2d\",null),r([s.operation],e,\"batchNormalization3d\",null),r([s.operation],e,\"batchNormalization4d\",null),r([o.doc({heading:\"Operations\",subheading:\"Normalization\"})],e,\"batchNormalization\",null),e}();function c(e){return null==e?null:0===e.rank?e.as1D():1===e.rank?e:2===e.rank?e.as4D(1,1,e.shape[0],e.shape[1]):3===e.rank?e.as4D(1,e.shape[0],e.shape[1],e.shape[2]):e}t.Ops=u},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(12),u=n(6),c=n(5),l=function(){function e(){}return e.add=function(e,t){i.assertTypesMatch(e,t);var n=s.assertAndGetBroadcastShape(e.shape,t.shape);return a.ENV.engine.executeKernel(\"Add\",{inputs:{a:e,b:t}},function(r,o){return{a:function(){var t=r,o=s.getReductionAxes(e.shape,n);return o.length>0&&(t=t.sum(o)),t.reshape(e.shape)},b:function(){var e=r,o=s.getReductionAxes(t.shape,n);return o.length>0&&(e=e.sum(o)),e.reshape(t.shape)}}})},e.addStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in addStrict: \"),e.add(t)},e.sub=function(e,t){i.assertTypesMatch(e,t);var n=s.assertAndGetBroadcastShape(e.shape,t.shape);return a.ENV.engine.executeKernel(\"Sub\",{inputs:{a:e,b:t}},function(r,o){return{a:function(){var t=r,o=s.getReductionAxes(e.shape,n);return o.length>0&&(t=t.sum(o)),t.reshape(e.shape)},b:function(){var e=r,o=s.getReductionAxes(t.shape,n);return o.length>0&&(e=e.sum(o)),e.neg().reshape(t.shape)}}})},e.subStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in subStrict: \"),e.sub(t)},e.pow=function(e,t){i.assert(\"int32\"===t.dtype,\"only supports int32 data type for the exponent parameter.\"),s.assertAndGetBroadcastShape(e.shape,t.shape);return a.ENV.engine.executeKernel(\"Pow\",{inputs:{base:e,exp:t}},function(n,r){if(!i.arraysEqual(e.shape,t.shape)&&!i.isScalarShape(t.shape))throw new Error(\"Gradient of pow not yet supported for broadcasted shapes.\");return{base:function(){var r=t.toFloat().mul(e.pow(t.sub(c.scalar(1,\"int32\"))).toFloat());return n.mul(r)},exp:function(){throw new Error(\"Backprop through exponent not implemented yet.\")}}})},e.powStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in powStrict: \"),e.pow(t)},e.mul=function(e,t){i.assertTypesMatch(e,t);var n=s.assertAndGetBroadcastShape(e.shape,t.shape);return a.ENV.engine.executeKernel(\"Mul\",{inputs:{a:e,b:t}},function(r,o){return{a:function(){var o=r.mul(t.toFloat()),a=s.getReductionAxes(e.shape,n);return a.length>0?o.sum(a).reshape(e.shape):o},b:function(){var o=r.mul(e.toFloat()),a=s.getReductionAxes(t.shape,n);return a.length>0?o.sum(a).reshape(t.shape):o}}})},e.mulStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in multiplyStrict: \"),e.mul(t)},e.div=function(e,t){var n=s.assertAndGetBroadcastShape(e.shape,t.shape);return a.ENV.engine.executeKernel(\"Div\",{inputs:{a:e,b:t}},function(r,o){return{a:function(){var o=r.div(t.toFloat()),a=s.getReductionAxes(e.shape,n);return a.length>0?o.sum(a).reshape(e.shape):o},b:function(){var o=r.mul(e.toFloat()),a=s.getReductionAxes(t.shape,n);a.length>0&&(o=o.sum(a).reshape(t.shape));var i=t.square();return o.div(i.toFloat()).neg()}}})},e.divStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in divideStrict: \"),e.div(t)},e.minimum=function(e,t){i.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape);return a.ENV.engine.executeKernel(\"Minimum\",{inputs:{a:e,b:t}},function(n,r){return{a:function(){return n.mul(e.lessEqual(t).toFloat())},b:function(){return n.mul(e.greater(t).toFloat())}}})},e.minimumStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in minimumStrict: \"),e.minimum(t)},e.maximum=function(e,t){i.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape);return a.ENV.engine.executeKernel(\"Maximum\",{inputs:{a:e,b:t}},function(n,r){return{a:function(){return n.mul(e.greaterEqual(t).toFloat())},b:function(){return n.mul(e.less(t).toFloat())}}})},e.maximumStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in minimumStrict: \"),e.maximum(t)},r([o.doc({heading:\"Operations\",subheading:\"Arithmetic\"}),u.operation],e,\"add\",null),r([u.operation],e,\"addStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Arithmetic\"}),u.operation],e,\"sub\",null),r([u.operation],e,\"subStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Arithmetic\"}),u.operation],e,\"pow\",null),r([u.operation],e,\"powStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Arithmetic\"}),u.operation],e,\"mul\",null),r([u.operation],e,\"mulStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Arithmetic\"}),u.operation],e,\"div\",null),r([u.operation],e,\"divStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Arithmetic\"}),u.operation],e,\"minimum\",null),r([u.operation],e,\"minimumStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Arithmetic\"}),u.operation],e,\"maximum\",null),r([u.operation],e,\"maximumStrict\",null),e}();t.Ops=l},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(12),u=n(6),c=function(){function e(){}return e.notEqual=function(e,t){return i.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"NotEqual\",{inputs:{a:e,b:t}})},e.notEqualStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in notEqualStrict: \"),e.notEqual(t)},e.less=function(e,t){return i.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"Less\",{inputs:{a:e,b:t}})},e.lessStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in lessStrict: \"),e.less(t)},e.equal=function(e,t){return i.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"Equal\",{inputs:{a:e,b:t}})},e.equalStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in equalStrict: \"),e.equal(t)},e.lessEqual=function(e,t){return i.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"LessEqual\",{inputs:{a:e,b:t}})},e.lessEqualStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in lessEqualStrict: \"),e.lessEqual(t)},e.greater=function(e,t){return i.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"Greater\",{inputs:{a:e,b:t}})},e.greaterStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in greaterStrict: \"),e.greater(t)},e.greaterEqual=function(e,t){return i.assertTypesMatch(e,t),s.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"GreaterEqual\",{inputs:{a:e,b:t}})},e.greaterEqualStrict=function(e,t){return i.assertShapesMatch(e.shape,t.shape,\"Error in greaterEqualStrict: \"),e.greaterEqual(t)},r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),u.operation],e,\"notEqual\",null),r([u.operation],e,\"notEqualStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),u.operation],e,\"less\",null),r([u.operation],e,\"lessStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),u.operation],e,\"equal\",null),r([u.operation],e,\"equalStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),u.operation],e,\"lessEqual\",null),r([u.operation],e,\"lessEqualStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),u.operation],e,\"greater\",null),r([u.operation],e,\"greaterStrict\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),u.operation],e,\"greaterEqual\",null),r([u.operation],e,\"greaterEqualStrict\",null),e}();t.Ops=c},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(16),u=n(6),c=function(){function e(){}return e.conv1d=function(t,n,r,o,a){var s=t,u=!1;2===t.rank&&(u=!0,s=t.as3D(1,t.shape[0],t.shape[1])),i.assert(3===s.rank,\"Error in conv1d: input must be rank 3, but got rank \"+s.rank+\".\"),i.assert(3===n.rank,\"Error in conv1d: filter must be rank 3, but got rank \"+n.rank+\".\"),null!=a&&i.assert(i.isInt(o),\"Error in conv1d: pad must be an integer when using, dimRoundingMode \"+a+\" but got pad \"+o+\".\"),i.assert(s.shape[2]===n.shape[1],\"Error in conv1d: depth of input (\"+s.shape[2]+\") must match  input depth for filter \"+n.shape[1]+\".\");var c=n.as4D(1,n.shape[0],n.shape[1],n.shape[2]),l=s.as4D(s.shape[0],1,s.shape[1],s.shape[2]),p=[1,r],h=e.conv2d(l,c,p,o,a);return u?h.as2D(h.shape[2],h.shape[3]):h.as3D(h.shape[0],h.shape[2],h.shape[3])},e.conv2d=function(t,n,r,o,u){var c=t,l=!1;3===t.rank&&(l=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),i.assert(4===c.rank,\"Error in conv2d: input must be rank 4, but got rank \"+c.rank+\".\"),i.assert(4===n.rank,\"Error in conv2d: filter must be rank 4, but got rank \"+n.rank+\".\"),null!=u&&i.assert(i.isInt(o),\"Error in conv2d: pad must be an integer when using, dimRoundingMode \"+u+\" but got pad \"+o+\".\"),i.assert(c.shape[3]===n.shape[2],\"Error in conv2d: depth of input (\"+c.shape[3]+\") must match  input depth for filter \"+n.shape[2]+\".\");var p=s.computeConv2DInfo(c.shape,n.shape,r,o,u),h=a.ENV.engine.executeKernel(\"Conv2D\",{inputs:{x:c,filter:n},args:{convInfo:p}},function(t,a){return{x:function(){return e.conv2dDerInput(c.shape,t,n,r,o)},filter:function(){return e.conv2dDerFilter(c,t,n.shape,r,o)}}});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h},e.conv2dDerInput=function(e,t,n,r,o,u){i.assert(e.length===t.rank,\"Length of inShape (\"+e.length+\") and rank of dy (\"+t.rank+\") must match\");var c=e,l=t,p=!1;3===t.rank&&(p=!0,l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),c=[1,e[0],e[1],e[2]]);var h=c[3],d=l.shape[3];i.assert(4===c.length,\"Error in conv2dDerInput: inShape must be length 4, but got length \"+c.length+\".\"),i.assert(4===l.rank,\"Error in conv2dDerInput: dy must be rank 4, but got rank \"+l.rank),i.assert(4===n.rank,\"Error in conv2dDerInput: filter must be rank 4, but got rank \"+n.rank),i.assert(h===n.shape[2],\"Error in conv2dDerInput: depth of input (\"+h+\") must match input depth for filter \"+n.shape[2]+\".\"),i.assert(d===n.shape[3],\"Error in conv2dDerInput: depth of output (\"+d+\") mustmatch output depth for filter \"+n.shape[3]+\".\"),null!=u&&i.assert(i.isInt(o),\"Error in conv2dDerInput: pad must be an integer when using, dimRoundingMode \"+u+\" but got pad \"+o+\".\");var f=s.computeConv2DInfo(c,n.shape,r,o,u),m=a.ENV.engine.executeKernel(\"Conv2DDerInput\",{inputs:{dy:l,filter:n},args:{convInfo:f}});return p?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m},e.conv2dDerFilter=function(e,t,n,r,o,u){var c=e;3===e.rank&&(c=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var l=t;3===l.rank&&(l=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),i.assert(4===c.rank,\"Error in conv2dDerFilter: input must be rank 4, but got shape \"+c.shape+\".\"),i.assert(4===l.rank,\"Error in conv2dDerFilter: dy must be rank 4, but got shape \"+l.shape+\".\"),i.assert(4===n.length,\"Error in conv2dDerFilter: filterShape must be length 4, but got \"+n+\".\"),i.assert(c.shape[3]===n[2],\"Error in conv2dDerFilter: depth of input \"+c.shape[3]+\") must match input depth in filter (\"+n[2]+\".\"),i.assert(l.shape[3]===n[3],\"Error in conv2dDerFilter: depth of dy (\"+l.shape[3]+\") must match output depth for filter (\"+n[3]+\").\"),null!=u&&i.assert(i.isInt(o),\"Error in conv2dDerFilter: pad must be an integer when using, dimRoundingMode \"+u+\" but got pad \"+o+\".\");var p=s.computeConv2DInfo(c.shape,n,r,o,u);return a.ENV.engine.executeKernel(\"Conv2DDerFilter\",{inputs:{x:c,dy:l},args:{convInfo:p}})},e.conv2dTranspose=function(t,n,r,o,a,i){return e.conv2dDerInput(r,t,n,o,a,i)},e.depthwiseConv2d=function(e,t,n,r,o,u){void 0===o&&(o=[1,1]);var c=e,l=!1;3===e.rank&&(l=!0,c=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),i.assert(4===c.rank,\"Error in depthwiseConv2D: input must be rank 4, but got rank \"+c.rank+\".\"),i.assert(4===t.rank,\"Error in depthwiseConv2D: filter must be rank 4, but got rank \"+t.rank+\".\"),i.assert(c.shape[3]===t.shape[2],\"Error in depthwiseConv2D: number of input channels (\"+c.shape[3]+\") must match the inChannels dimension in filter \"+t.shape[2]+\".\");var p=function(e){return\"number\"==typeof e?[e,e]:e}(o=o||[1,1]),h=p[0],d=p[1];i.assert(1===h&&1===d,\"Error in depthwiseConv2D: rates greater than 1 are not yet supported. Got rates '\"+o+\"'\"),null!=u&&i.assert(i.isInt(r),\"Error in depthwiseConv2D: pad must be an integer when using, dimRoundingMode \"+u+\" but got pad \"+r+\".\");var f=s.computeConv2DInfo(c.shape,t.shape,n,r,u,!0),m=a.ENV.engine.executeKernel(\"DepthwiseConv2D\",{inputs:{x:c,filter:t},args:{convInfo:f}});return l?m.as3D(m.shape[1],m.shape[2],m.shape[3]):m},r([o.doc({heading:\"Operations\",subheading:\"Convolution\"}),u.operation],e,\"conv1d\",null),r([o.doc({heading:\"Operations\",subheading:\"Convolution\"}),u.operation],e,\"conv2d\",null),r([u.operation],e,\"conv2dDerInput\",null),r([u.operation],e,\"conv2dDerFilter\",null),r([o.doc({heading:\"Operations\",subheading:\"Convolution\"}),u.operation],e,\"conv2dTranspose\",null),r([o.doc({heading:\"Operations\",subheading:\"Convolution\"}),u.operation],e,\"depthwiseConv2d\",null),e}();t.Ops=c},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(6),u=function(){function e(){}return e.resizeBilinear=function(e,t,n){void 0===n&&(n=!1),i.assert(3===e.rank||4===e.rank,\"Error in resizeBilinear: x must be rank 3 or 4, but got rank \"+e.rank+\".\"),i.assert(2===t.length,\"Error in resizeBilinear: new shape must 2D, but got shape \"+t+\".\");var r=e,o=!1;3===e.rank&&(o=!0,r=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var s=t[0],u=t[1],c=a.ENV.engine.executeKernel(\"ResizeBilinear\",{inputs:{x:r},args:{newHeight:s,newWidth:u,alignCorners:n}});return o?c.as3D(c.shape[1],c.shape[2],c.shape[3]):c},r([o.doc({heading:\"Operations\",subheading:\"Images\",namespace:\"image\"}),s.operation],e,\"resizeBilinear\",null),e}();t.Ops=u},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(20),s=n(0),u=n(12),c=n(6),l=function(){function e(){}return e.logicalNot=function(e){return s.assert(\"bool\"===e.dtype,\"Error Array must be of type bool.\"),a.ENV.engine.executeKernel(\"LogicalNot\",{inputs:{x:e}})},e.logicalAnd=function(e,t){return s.assert(\"bool\"===e.dtype&&\"bool\"===t.dtype,\"Error Array must be of type bool.\"),u.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"LogicalAnd\",{inputs:{a:e,b:t}})},e.logicalOr=function(e,t){return s.assert(\"bool\"===e.dtype&&\"bool\"===t.dtype,\"Error Array must be of type bool.\"),u.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"LogicalOr\",{inputs:{a:e,b:t}})},e.logicalXor=function(e,t){return s.assert(\"bool\"===e.dtype&&\"bool\"===t.dtype,\"Error Array must be of type bool.\"),u.assertAndGetBroadcastShape(e.shape,t.shape),a.ENV.engine.executeKernel(\"LogicalXor\",{inputs:{a:e,b:t}})},e.where=function(e,t,n){s.assert(\"bool\"===e.dtype||\"bool\"===t.dtype||\"bool\"===n.dtype,\"Error Array must be of type bool.\"),s.assertShapesMatch(t.shape,n.shape,\"Error in where: \"),1===e.rank?s.assert(e.shape[0]===t.shape[0],\"The first dimension of `a` must match the size of `condition`.\"):s.assertShapesMatch(e.shape,n.shape,\"Error in where: \");var r=i.upcastType(t.dtype,n.dtype);return a.ENV.engine.executeKernel(\"Where\",{inputs:{condition:e,a:t,b:n},args:{dtype:r}})},r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),c.operation],e,\"logicalNot\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),c.operation],e,\"logicalAnd\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),c.operation],e,\"logicalOr\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),c.operation],e,\"logicalXor\",null),r([o.doc({heading:\"Operations\",subheading:\"Logical\"}),c.operation],e,\"where\",null),e}();t.Ops=l},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(6),u=function(){function e(){}return e.localResponseNormalization=function(e,t,n,r,o,s){void 0===t&&(t=5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===o&&(o=.5),void 0===s&&(s=\"acrossChannels\"),i.assert(4===e.rank||3===e.rank,\"Error in localResponseNormalization: x must be rank 3 or 4 but got\\n               rank \"+e.rank+\".\"),i.assert(i.isInt(t),\"Error in localResponseNormalization3D: radius must be an integer\\n                     but got radius \"+t+\".\");var u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]));var l=a.ENV.engine.executeKernel(\"LRN4D\",{inputs:{x:u},args:{radius:t,bias:n,alpha:r,beta:o,normRegion:s}});return c?l.as3D(l.shape[1],l.shape[2],l.shape[3]):l},r([o.doc({heading:\"Operations\",subheading:\"Normalization\"}),s.operation],e,\"localResponseNormalization\",null),e}();t.LRN=u},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(6),i=function(){function e(){}return e.multiRNNCell=function(e,t,n,r){for(var o=t,a=[],i=0;i<e.length;i++){var s=e[i](o,n[i],r[i]);a.push(s[0]),a.push(s[1]),o=s[1]}var u=[],c=[];for(i=0;i<a.length;i+=2)u.push(a[i]),c.push(a[i+1]);return[u,c]},e.basicLSTMCell=function(e,t,n,r,o,a){var i=r.concat(a,1).matMul(t).add(n),s=i.shape[0],u=i.shape[1]/4,c=[s,u],l=i.slice([0,0],c),p=i.slice([0,u],c),h=i.slice([0,2*u],c),d=i.slice([0,3*u],c),f=l.sigmoid().mulStrict(p.tanh()).addStrict(o.mulStrict(e.add(h).sigmoid()));return[f,f.tanh().mulStrict(d.sigmoid())]},r([o.doc({heading:\"Operations\",subheading:\"RNN\"}),a.operation],e,\"multiRNNCell\",null),r([o.doc({heading:\"Operations\",subheading:\"RNN\"}),a.operation],e,\"basicLSTMCell\",null),e}();t.Ops=i},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(50),s=n(0),u=n(6),c=function(){function e(){}return e.matMul=function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),o=[l(n),l(r)],r=o[1];var o,i=(n=o[0])?e.shape[0]:e.shape[1],u=r?t.shape[1]:t.shape[0];return s.assert(2===e.rank&&2===t.rank,\"Error in matMul: inputs must be rank 2, got ranks \"+e.rank+\" and \"+t.rank+\".\"),s.assert(i===u,\"Error in matMul: inner shapes (\"+i+\") and (\"+u+\") of Tensors with shapes \"+e.shape+\" and \"+t.shape+\" and transposeA=\"+n+\" and transposeB=\"+r+\" must match.\"),a.ENV.engine.executeKernel(\"MatMul\",{inputs:{a:e,b:t},args:{transposeA:n,transposeB:r}},function(o,a){if(n||r)throw new Error(\"Backprop for transposed MatMul not yet implemented.\");return{a:function(){return o.matMul(t.toFloat(),!1,!0)},b:function(){return e.toFloat().matMul(o,!0,!1)}}})},e.vectorTimesMatrix=function(e,t){return s.assert(1===e.rank,\"Error in vectorTimesMatrix: first input must be rank 1, but got rank \"+e.rank+\".\"),s.assert(2===t.rank,\"Error in vectorTimesMatrix: second input must be rank 2, but got rank \"+t.rank+\".\"),s.assert(e.size===t.shape[0],\"Error in vectorTimesMatrix: size of vector (\"+e.size+\") must match first dimension of matrix (\"+t.shape[0]+\")\"),e.as2D(1,-1).matMul(t).as1D()},e.matrixTimesVector=function(e,t){return s.assert(1===t.rank,\"Error in matrixTimesVector: second input must rank 1, but got rank \"+t.rank+\".\"),s.assert(2===e.rank,\"Error in matrixTimesVector: first input must be a rank 2, but got rank \"+e.rank+\".\"),s.assert(t.size===e.shape[1],\"Error in matrixTimesVector: size of first rank 1 input \"+t.size+\" must match inner dimension of second rank 2 input, but got shape \"+e.shape+\".\"),e.matMul(t.as2D(-1,1)).as1D()},e.dotProduct=function(e,t){return s.assert(1===e.rank&&1===t.rank,\"Error in dotProduct: inputs must be rank 1, but got ranks \"+e.rank+\" and \"+t.rank+\".\"),s.assert(e.size===t.size,\"Error in dotProduct: size of inputs (\"+e.size+\") and (\"+t.size+\") must match.\"),e.as2D(1,-1).matMul(t.as2D(-1,1)).asScalar()},e.outerProduct=function(e,t){return s.assert(1===e.rank&&1===t.rank,\"Error in outerProduct: inputs must be rank 1, but got ranks \"+e.rank+\" and \"+t.rank+\".\"),e.as2D(-1,1).matMul(t.as2D(1,-1))},r([o.doc({heading:\"Operations\",subheading:\"Matrices\"}),u.operation],e,\"matMul\",null),r([u.operation],e,\"vectorTimesMatrix\",null),r([u.operation],e,\"matrixTimesVector\",null),r([u.operation],e,\"dotProduct\",null),r([o.doc({heading:\"Operations\",subheading:\"Matrices\"}),u.operation],e,\"outerProduct\",null),e}();function l(e){return e!==i.MatrixOrientation.REGULAR&&(e===i.MatrixOrientation.TRANSPOSED||e)}t.Ops=c},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),function(e){e[e.REGULAR=0]=\"REGULAR\",e[e.TRANSPOSED=1]=\"TRANSPOSED\"}(t.MatrixOrientation||(t.MatrixOrientation={}))},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(13),i=n(6),s=n(5),u=function(){function e(){}return e.norm=function(e,t,n,r){void 0===t&&(t=\"euclidean\"),void 0===n&&(n=null),void 0===r&&(r=!1);var o=function e(t,n,r){void 0===r&&(r=null);if(0===t.rank)return t.abs();if(1!==t.rank&&null===r)return e(t.reshape([-1]),n,r);if(1===t.rank||\"number\"==typeof r||r instanceof Array&&1===r.length){if(1===n)return t.abs().sum(r);if(n===1/0)return t.abs().max(r);if(n===-1/0)return t.abs().min(r);if(\"euclidean\"===n||2===n)return t.abs().pow(s.scalar(2,\"int32\")).sum(r).sqrt();throw new Error(\"Error in norm: invalid ord value: \"+n)}if(r instanceof Array&&2===r.length){if(1===n)return t.abs().sum(r[0]).max(r[1]-1);if(n===1/0)return t.abs().sum(r[1]).max(r[0]);if(n===-1/0)return t.abs().sum(r[1]).min(r[0]);if(\"fro\"===n||\"euclidean\"===n)return t.square().sum(r).sqrt();throw new Error(\"Error in norm: invalid ord value: \"+n)}throw new Error(\"Error in norm: invalid axis: \"+r)}(e,t,n),i=o.shape;if(r){var u=a.parseAxisParam(n,e.shape);i=a.expandShapeToKeepDim(o.shape,u)}return o.reshape(i)},r([o.doc({heading:\"Operations\",subheading:\"Matrices\"}),i.operation],e,\"norm\",null),e}();t.Ops=u},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(16),u=n(6),c=function(){function e(){}return e.maxPool=function(t,n,r,o,u){var c=t,l=!1;3===t.rank&&(l=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),i.assert(4===c.rank,\"Error in maxPool: input must be rank 4 but got rank \"+c.rank+\".\"),null!=u&&i.assert(i.isInt(o),\"Error in maxPool: pad must be an integer when using, dimRoundingMode \"+u+\" but got pad \"+o+\".\");var p=s.computePool2DInfo(c.shape,n,r,o,u),h=a.ENV.engine.executeKernel(\"MaxPool\",{inputs:{x:c},args:{convInfo:p}},function(t,a){return{x:function(){return e.maxPoolBackprop(t,c,n,r,o)}}});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h},e.maxPoolBackprop=function(e,t,n,r,o,u){i.assert(t.rank===e.rank,\"Rank of input (\"+t.rank+\") does not match rank of dy (\"+e.rank+\")\");var c=t,l=e,p=!1;3===t.rank&&(p=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),l=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),i.assert(4===l.rank,\"Error in maxPoolBackprop: dy must be rank 4 but got rank \"+l.rank+\".\"),i.assert(4===c.rank,\"Error in maxPoolBackprop: input must be rank 4 but got rank \"+c.rank+\".\"),null!=u&&i.assert(i.isInt(o),\"Error in maxPoolBackprop: pad must be an integer when using, dimRoundingMode \"+u+\" but got pad \"+o+\".\");var h=s.computePool2DInfo(c.shape,n,r,o,u),d=a.ENV.engine.executeKernel(\"MaxPoolBackprop\",{inputs:{dy:l,x:c},args:{convInfo:h}});return p?d.as3D(d.shape[1],d.shape[2],d.shape[3]):d},e.minPool=function(e,t,n,r,o){var u=e,c=!1;3===e.rank&&(c=!0,u=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),i.assert(4===u.rank,\"Error in minPool: x must be rank 4 but got rank \"+u.rank+\".\"),null!=o&&i.assert(i.isInt(r),\"Error in minPool: pad must be an integer when using, dimRoundingMode \"+o+\" but got pad \"+r+\".\");var l=s.computePool2DInfo(u.shape,t,n,r,o),p=a.ENV.engine.executeKernel(\"MinPool\",{inputs:{x:u},args:{convInfo:l}});return c?p.as3D(p.shape[1],p.shape[2],p.shape[3]):p},e.avgPool=function(t,n,r,o,u){var c=t,l=!1;3===t.rank&&(l=!0,c=t.as4D(1,t.shape[0],t.shape[1],t.shape[2])),i.assert(4===c.rank,\"Error in avgPool: x must be rank 4 but got rank \"+c.rank+\".\"),null!=u&&i.assert(i.isInt(o),\"Error in avgPool: pad must be an integer when using, dimRoundingMode \"+u+\" but got pad \"+o+\".\");var p=s.computePool2DInfo(c.shape,n,r,o),h=a.ENV.engine.executeKernel(\"AvgPool\",{inputs:{x:c},args:{convInfo:p}},function(t,a){return{x:function(){return e.avgPoolBackprop(t,c,n,r,o)}}});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h},e.avgPoolBackprop=function(e,t,n,r,o){i.assert(t.rank===e.rank,\"Rank of input (\"+t.rank+\") does not match rank of dy (\"+e.rank+\")\");var u=t,c=e,l=!1;3===t.rank&&(l=!0,u=t.as4D(1,t.shape[0],t.shape[1],t.shape[2]),c=e.as4D(1,e.shape[0],e.shape[1],e.shape[2])),i.assert(4===c.rank,\"Error in avgPoolBackprop: dy must be rank 4 but got rank \"+c.rank+\".\"),i.assert(4===u.rank,\"Error in avgPoolBackprop: input must be rank 4 but got rank \"+u.rank+\".\");var p=s.computePool2DInfo(u.shape,n,r,o),h=a.ENV.engine.executeKernel(\"AvgPoolBackprop\",{inputs:{dy:c,x:u},args:{convInfo:p}});return l?h.as3D(h.shape[1],h.shape[2],h.shape[3]):h},r([o.doc({heading:\"Operations\",subheading:\"Convolution\"}),u.operation],e,\"maxPool\",null),r([u.operation],e,\"maxPoolBackprop\",null),r([o.doc({heading:\"Operations\",subheading:\"Convolution\"}),u.operation],e,\"minPool\",null),r([o.doc({heading:\"Operations\",subheading:\"Convolution\"}),u.operation],e,\"avgPool\",null),r([u.operation],e,\"avgPoolBackprop\",null),e}();t.Ops=c},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(3),s=n(2),u=n(0),c=n(13),l=n(6),p=n(5),h=function(){function e(){}return e.logSumExp=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=c.parseAxisParam(t,e.shape),o=e.max(r,!0),a=e.sub(o).exp().sum(r).log(),i=o.reshape(a.shape).add(a);if(n){var s=c.expandShapeToKeepDim(i.shape,r);return i.reshape(s)}return i},e.sum=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=c.parseAxisParam(t,e.shape);return i.customGrad(function(e){var t=c.getAxesPermutation(r,e.rank),o=r,i=e;null!=t&&(i=e.transpose(t),o=c.getInnerMostAxes(o.length,e.rank));var u=a.ENV.engine.executeKernel(\"Sum\",{inputs:{x:i},args:{axes:o}});if(n){var l=c.expandShapeToKeepDim(u.shape,r);u=u.reshape(l)}return{value:u,gradFunc:function(t){var n=e.shape.slice();return r.forEach(function(e){n[e]=1}),t.reshape(n).mul(s.Tensor.ones(e.shape,\"float32\"))}}})(e)},e.mean=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=c.parseAxisParam(t,e.shape),o=c.computeOutAndReduceShapes(e.shape,r)[1],a=u.sizeFromShape(o);return i.customGrad(function(e){var o=p.scalar(a);return{value:e.div(o).sum(t,n),gradFunc:function(t){var n=e.shape.slice();return r.forEach(function(e){n[e]=1}),t.reshape(n).mul(s.Tensor.ones(e.shape,\"float32\")).div(o)}}})(e)},e.min=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=c.parseAxisParam(t,e.shape),o=r,i=c.getAxesPermutation(o,e.rank);null!=i&&(e=e.transpose(i),o=c.getInnerMostAxes(o.length,e.rank));var s=a.ENV.engine.executeKernel(\"Min\",{inputs:{x:e},args:{axes:o}});if(n){var u=c.expandShapeToKeepDim(s.shape,r);return s.reshape(u)}return s},e.max=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=c.parseAxisParam(t,e.shape),o=r,i=c.getAxesPermutation(o,e.rank);null!=i&&(e=e.transpose(i),o=c.getInnerMostAxes(o.length,e.rank));var s=a.ENV.engine.executeKernel(\"Max\",{inputs:{x:e},args:{axes:o}});if(n){var u=c.expandShapeToKeepDim(s.shape,r);return s.reshape(u)}return s},e.argMin=function(e,t){void 0===t&&(t=null);var n=c.parseAxisParam(t,e.shape),r=c.getAxesPermutation(n,e.rank);return null!=r&&(e=e.transpose(r),n=c.getInnerMostAxes(n.length,e.rank)),a.ENV.engine.executeKernel(\"ArgMin\",{inputs:{x:e},args:{axes:n}})},e.argMax=function(e,t){void 0===t&&(t=null);var n=c.parseAxisParam(t,e.shape),r=c.getAxesPermutation(n,e.rank);return null!=r&&(e=e.transpose(r),n=c.getInnerMostAxes(n.length,e.rank)),a.ENV.engine.executeKernel(\"ArgMax\",{inputs:{x:e},args:{axes:n}})},e.moments=function(e,t,n){void 0===t&&(t=null),void 0===n&&(n=!1);var r=c.parseAxisParam(t,e.shape),o=e.mean(r,n),a=o.shape;return n||(a=c.expandShapeToKeepDim(o.shape,r)),{mean:o,variance:e.toFloat().sub(o.reshape(a)).square().mean(r,n)}},r([o.doc({heading:\"Operations\",subheading:\"Reduction\"}),l.operation],e,\"logSumExp\",null),r([o.doc({heading:\"Operations\",subheading:\"Reduction\"}),l.operation],e,\"sum\",null),r([o.doc({heading:\"Operations\",subheading:\"Reduction\"}),l.operation],e,\"mean\",null),r([o.doc({heading:\"Operations\",subheading:\"Reduction\"}),l.operation],e,\"min\",null),r([o.doc({heading:\"Operations\",subheading:\"Reduction\"}),l.operation],e,\"max\",null),r([o.doc({heading:\"Operations\",subheading:\"Reduction\"}),l.operation],e,\"argMin\",null),r([o.doc({heading:\"Operations\",subheading:\"Reduction\"}),l.operation],e,\"argMax\",null),r([o.doc({heading:\"Operations\",subheading:\"Normalization\"}),l.operation],e,\"moments\",null),e}();t.Ops=h},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(13),u=n(6),c=function(){function e(){}return e.reverse1d=function(t){return i.assert(1===t.rank,\"Error in reverse1D: x must be rank 1 but got\\n             rank \"+t.rank+\".\"),e.reverse(t,0)},e.reverse2d=function(t,n){return i.assert(2===t.rank,\"Error in reverse2D: x must be rank 2 but got\\n             rank \"+t.rank+\".\"),e.reverse(t,n)},e.reverse3d=function(t,n){return i.assert(3===t.rank,\"Error in reverse3D: x must be rank 3 but got\\n             rank \"+t.rank+\".\"),e.reverse(t,n)},e.reverse4d=function(t,n){return i.assert(4===t.rank,\"Error in reverse4D: x must be rank 4 but got\\n             rank \"+t.rank+\".\"),e.reverse(t,n)},e.reverse=function(e,t){var n,r=s.parseAxisParam(t,e.shape).map(function(t){return t+4-e.rank});if(0===e.rank)return e.clone();if(1===e.rank)n=e.as4D(1,1,1,e.shape[0]);else if(2===e.rank)n=e.as4D(1,1,e.shape[0],e.shape[1]);else if(3===e.rank)n=e.as4D(1,e.shape[0],e.shape[1],e.shape[2]);else{if(4!==e.rank)throw new Error(\"Reverse for rank \"+e.rank+\" is not yet implemented\");n=e}return a.ENV.engine.executeKernel(\"Reverse4D\",{inputs:{x:n},args:{axis:r}}).reshapeAs(e)},r([o.doc({heading:\"Tensors\",subheading:\"Slicing and Joining\"}),u.operation],e,\"reverse\",null),e}();t.Ops=c},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(6),s=n(95),u=function(){function e(){}return e.slice1d=function(e,t,n){return s.assertParamsValid(e,[t],[n]),a.ENV.engine.executeKernel(\"Slice1D\",{inputs:{x:e},args:{begin:t,size:n}})},e.slice2d=function(e,t,n){return s.assertParamsValid(e,t,n),a.ENV.engine.executeKernel(\"Slice2D\",{inputs:{x:e},args:{begin:t,size:n}})},e.slice3d=function(e,t,n){return s.assertParamsValid(e,t,n),a.ENV.engine.executeKernel(\"Slice3D\",{inputs:{x:e},args:{begin:t,size:n}})},e.slice4d=function(e,t,n){return s.assertParamsValid(e,t,n),a.ENV.engine.executeKernel(\"Slice4D\",{inputs:{x:e},args:{begin:t,size:n}})},e.slice=function(t,n,r){if(0===t.rank)throw new Error(\"Slicing scalar is not possible\");if(1===t.rank)return e.slice1d(t,n[0],r[0]);if(2===t.rank)return e.slice2d(t,n,r);if(3===t.rank)return e.slice3d(t,n,r);if(4===t.rank)return e.slice4d(t,n,r);throw new Error(\"Slicing for rank \"+t.rank+\" not implemented yet\")},r([i.operation],e,\"slice1d\",null),r([i.operation],e,\"slice2d\",null),r([i.operation],e,\"slice3d\",null),r([i.operation],e,\"slice4d\",null),r([o.doc({heading:\"Tensors\",subheading:\"Slicing and Joining\"}),i.operation],e,\"slice\",null),e}();t.Ops=u},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(3),i=n(0),s=n(13),u=n(6),c=n(5),l=function(){function e(){}return e.softmax=function(e,t){if(void 0===t&&(t=-1),-1===t&&(t=e.rank-1),t!==e.rank-1)throw Error(\"Softmax along a non-last dimension is not yet supported. Logits was rank \"+e.rank+\" and dim was \"+t);return a.customGrad(function(e){var n=e.logSumExp([t],!0),r=e.toFloat().sub(n).exp();return{value:r,gradFunc:function(e){var n=e.mul(r);return n.sub(n.sum([t],!0).mul(r))}}})(e)},e.softmaxCrossEntropy=function(e,t,n){if(void 0===n&&(n=-1),i.assertShapesMatch(e.shape,t.shape,\"Error in softmaxCrossEntropy: \"),-1===n&&(n=t.rank-1),n!==t.rank-1)throw Error(\"Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank \"+t.rank+\" and dim was \"+n);return a.customGrad(function(e,t){var r=t.softmax(n);return{value:c.scalar(1e-5).add(r).log().mul(e).neg().sum([n]),gradFunc:function(t){var o=s.expandShapeToKeepDim(t.shape,[n]);return[t.reshape(o).mul(e.toFloat().sub(r)),t.reshape(o).mul(r.sub(e.toFloat()))]}}})(e,t)},r([o.doc({heading:\"Operations\",subheading:\"Normalization\"}),u.operation],e,\"softmax\",null),r([o.doc({heading:\"Training\",subheading:\"Losses\",namespace:\"losses\"}),u.operation],e,\"softmaxCrossEntropy\",null),e}();t.Ops=l},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(13),u=n(6),c=function(){function e(){}return e.transpose=function(e,t){null==t&&(t=e.shape.map(function(e,t){return t}).reverse());return i.assert(e.rank===t.length,\"Error in transpose: rank of input \"+e.rank+\" must match length of perm \"+t+\".\"),a.ENV.engine.executeKernel(\"Transpose\",{inputs:{x:e},args:{perm:t}},function(e){var n=s.getUndoAxesPermutation(t);return{x:function(){return e.transpose(n)}}})},r([o.doc({heading:\"Operations\",subheading:\"Matrices\"}),u.operation],e,\"transpose\",null),e}();t.Ops=c},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(0),s=n(6),u=n(5),c=n(5),l=n(29),p=function(){function e(){}return e.neg=function(e){return a.ENV.engine.executeKernel(\"Neg\",{inputs:{x:e}},function(e,t){return{x:function(){return e.neg()}}})},e.ceil=function(e){return a.ENV.engine.executeKernel(\"Ceil\",{inputs:{x:e}},function(e,t){return{x:function(){return u.zeros(t.shape)}}})},e.floor=function(e){return a.ENV.engine.executeKernel(\"Floor\",{inputs:{x:e}},function(e,t){return{x:function(){return u.zeros(t.shape)}}})},e.exp=function(e){return a.ENV.engine.executeKernel(\"Exp\",{inputs:{x:e}},function(e,t){return{x:function(){return e.mul(t)}}})},e.log=function(e){return a.ENV.engine.executeKernel(\"Log\",{inputs:{x:e}},function(t,n){return{x:function(){return t.div(e.toFloat())}}})},e.sqrt=function(e){return a.ENV.engine.executeKernel(\"Sqrt\",{inputs:{x:e}},function(t,n){return{x:function(){return t.div(e.toFloat().sqrt().mul(u.scalar(2)))}}})},e.square=function(e){return a.ENV.engine.executeKernel(\"Square\",{inputs:{x:e}},function(t,n){return{x:function(){return t.mul(e.toFloat().mul(u.scalar(2)))}}})},e.abs=function(e){return a.ENV.engine.executeKernel(\"Abs\",{inputs:{x:e}},function(t,n){return{x:function(){return t.mul(e.toFloat().step(-1))}}})},e.clipByValue=function(e,t,n){return i.assert(t<=n,\"Error in clip: min (\"+t+\") must beless than or equal to max (\"+n+\").\"),a.ENV.engine.executeKernel(\"Clip\",{inputs:{x:e},args:{min:t,max:n}},function(r,o){return{x:function(){return r.where(e.greater(u.scalar(t)).logicalAnd(e.less(u.scalar(n))),c.zerosLike(r))}}})},e.relu=function(e){return a.ENV.engine.executeKernel(\"Relu\",{inputs:{x:e}},function(t,n){var r=e.step();return{x:function(){return t.mul(r.toFloat())}}})},e.elu=function(e){return a.ENV.engine.executeKernel(\"Elu\",{inputs:{x:e}},function(t){return{x:function(){return t.mul(function(e){return a.ENV.engine.executeKernel(\"EluDer\",{inputs:{x:e}})}(e))},alpha:function(){throw new Error(\"Derivative of prelu with respect to alpha is not implemented yet\")}}})},e.selu=function(e){return a.ENV.engine.executeKernel(\"Selu\",{inputs:{x:e}},function(t,n){return{x:function(){var n=e.greater(u.scalar(0)),r=u.scalar(l.SELU_SCALEALPHA),o=u.scalar(l.SELU_SCALE),a=t.mul(o),i=t.mul(r).mul(e.toFloat().exp());return u.where(n,a,i)}}})},e.leakyRelu=function(e,t){void 0===t&&(t=.2);return a.ENV.engine.executeKernel(\"LeakyRelu\",{inputs:{x:e},args:{alpha:t}},function(n,r){return{x:function(){return n.mul(e.step(t))}}})},e.prelu=function(e,t){return a.ENV.engine.executeKernel(\"PReLU\",{inputs:{x:e,alpha:t}},function(n){return{x:function(){return n.mul(function(e,t){return a.ENV.engine.executeKernel(\"PReLUDer\",{inputs:{x:e,alpha:t}})}(e,t))},alpha:function(){throw new Error(\"Derivative of prelu with respect to alpha is not implemented yet\")}}})},e.sigmoid=function(e){return a.ENV.engine.executeKernel(\"Sigmoid\",{inputs:{x:e}},function(e,t){return{x:function(){return e.mul(t.mul(u.scalar(1).sub(t)))}}})},e.sin=function(e){return a.ENV.engine.executeKernel(\"Sin\",{inputs:{x:e}},function(t,n){return{x:function(){return e.toFloat().cos().mul(t)}}})},e.cos=function(e){return a.ENV.engine.executeKernel(\"Cos\",{inputs:{x:e}},function(t,n){return{x:function(){return e.toFloat().sin().neg().mul(t)}}})},e.tan=function(e){return a.ENV.engine.executeKernel(\"Tan\",{inputs:{x:e}},function(t,n){return{x:function(){return t.div(e.cos().square())}}})},e.asin=function(t){return a.ENV.engine.executeKernel(\"Asin\",{inputs:{x:t}},function(n,r){return{x:function(){return n.div(e.sqrt(u.scalar(1).sub(t.toFloat().square())))}}})},e.acos=function(t){return a.ENV.engine.executeKernel(\"Acos\",{inputs:{x:t}},function(n,r){return{x:function(){return n.div(e.sqrt(u.scalar(1).sub(t.toFloat().square()))).neg()}}})},e.atan=function(e){return a.ENV.engine.executeKernel(\"Atan\",{inputs:{x:e}},function(t,n){return{x:function(){return t.div(u.scalar(1).add(e.toFloat().square()))}}})},e.sinh=function(e){return a.ENV.engine.executeKernel(\"Sinh\",{inputs:{x:e}},function(t,n){return{x:function(){return e.toFloat().cosh().mul(t)}}})},e.cosh=function(e){return a.ENV.engine.executeKernel(\"Cosh\",{inputs:{x:e}},function(t,n){return{x:function(){return e.toFloat().sinh().mul(t)}}})},e.tanh=function(e){return a.ENV.engine.executeKernel(\"Tanh\",{inputs:{x:e}},function(e,t){return{x:function(){return u.scalar(1).sub(t.square()).mul(e)}}})},e.step=function(e,t){return void 0===t&&(t=0),a.ENV.engine.executeKernel(\"Step\",{inputs:{x:e},args:{alpha:t}},function(e,t){return{x:function(){return u.zeros(t.shape)}}})},r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"neg\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"ceil\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"floor\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"exp\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"log\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"sqrt\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"square\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"abs\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"clipByValue\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"relu\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"elu\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"selu\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"leakyRelu\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"prelu\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"sigmoid\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"sin\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"cos\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"tan\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"asin\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"acos\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"atan\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"sinh\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"cosh\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"tanh\",null),r([o.doc({heading:\"Operations\",subheading:\"Basic math\"}),s.operation],e,\"step\",null),e}();t.Ops=p},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){function e(e){if(this.capacity=e,this.begin=0,this.end=0,e<1)throw new RangeError(\"Can't create ring buffer of capacity < 1.\");this.data=new Array(e),this.doubledCapacity=2*e}return e.prototype.wrap=function(e){for(;e<0;)e+=this.doubledCapacity;return e%this.doubledCapacity},e.prototype.get=function(e){if(e<0)throw new RangeError(\"Can't get item at a negative index.\");return this.data[e%this.capacity]},e.prototype.set=function(e,t){if(e<0)throw new RangeError(\"Can't set item at a negative index.\");this.data[e%this.capacity]=t},e.prototype.length=function(){var e=this.end-this.begin;return e<0&&(e=this.doubledCapacity+e),e},e.prototype.isFull=function(){return this.length()===this.capacity},e.prototype.isEmpty=function(){return 0===this.length()},e.prototype.push=function(e){if(this.isFull())throw new RangeError(\"Ring buffer is full.\");this.set(this.end,e),this.end=this.wrap(this.end+1)},e.prototype.pop=function(){if(this.isEmpty())throw new RangeError(\"Ring buffer is empty.\");this.end=this.wrap(this.end-1);var e=this.get(this.end);return this.set(this.end,void 0),e},e.prototype.unshift=function(e){if(this.isFull())throw new RangeError(\"Ring buffer is full.\");this.begin=this.wrap(this.begin-1),this.set(this.begin,e)},e.prototype.shift=function(){if(this.isEmpty())throw new RangeError(\"Ring buffer is empty.\");var e=this.get(this.begin);return this.set(this.begin,void 0),this.begin=this.wrap(this.begin+1),e},e.prototype.shuffleExcise=function(e){if(this.isEmpty())throw new RangeError(\"Ring buffer is empty.\");var t=this.wrap(this.begin+e),n=this.get(t);return this.set(t,this.pop()),n},e}();t.RingBuffer=r},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=function(e){function t(t,n){void 0===n&&(n=\"line\");var r=e.call(this)||this;return r.input=t,r.columnName=n,r}return r(t,e),t.prototype.getStream=function(){return o(this,void 0,void 0,function(){var e,t,n=this;return a(this,function(r){return e=this.input.getStream(),t=e.decodeUTF8(),[2,t.split(\"\\n\").map(function(e){return(t={})[n.columnName]=e,t;var t})]})})},t}(n(28).Dataset);t.TextLineDataset=i},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(){}}();t.DataSource=r},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.file=t,r.options=n,r.offset=n.offset||0,r.chunkSize=n.chunkSize||1048576,r}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){var e=this;return a(this,function(t){return this.offset>=this.file.size?[2,void 0]:[2,new Promise(function(t,n){var r=new FileReader;r.onload=function(e){var o=r.result;if(o instanceof ArrayBuffer&&(o=new Uint8Array(o)),!(o instanceof Uint8Array))return n(new TypeError(\"FileReader returned unknown type.\"));t(o)},r.onabort=function(e){return n(new Error(\"Aborted\"))},r.onerror=function(e){return n(new Error(e.error))};var o=e.offset+e.chunkSize,a=e.file.slice(e.offset,o);r.readAsArrayBuffer(a),e.offset=o})]})})},t}(n(63).ByteStream);t.FileReaderStream=i},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(102),s=n(17),u=n(103),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.decodeUTF8=function(){return new l(this)},t}(s.DataStream);t.ByteStream=c;var l=function(e){function t(t){var n=e.call(this)||this;return n.impl=new p(t),n}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,this.impl.next()]})})},t}(u.StringStream),p=function(e){function t(t){var n=e.call(this)||this;return n.upstream=t,n.partial=new Uint8Array([]),n.partialBytesValid=0,n}return r(t,e),t.prototype.pump=function(){return o(this,void 0,void 0,function(){var e,t,n,r,o,s,u;return a(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:if(null==(e=a.sent())){if(0===this.partial.length)return[2,!1];e=new Uint8Array([])}for(t=this.partial.length-this.partialBytesValid,r=n=t,o=0;n<e.length;)r=n,o=h(e[n]),n=r+o;return n===e.length&&(r=n),s=i.decode(String.fromCharCode.apply(null,e.slice(t,r))),t>0?(this.partial.set(e.slice(0,t),this.partialBytesValid),u=i.decode(String.fromCharCode.apply(null,this.partial)),this.outputQueue.push(u+s)):this.outputQueue.push(s),r===e.length?(this.partial=new Uint8Array([]),this.partialBytesValid=0):(this.partial=new Uint8Array(new ArrayBuffer(o)),this.partial.set(e.slice(r),0),this.partialBytesValid=e.length-r),[2,!0]}})})},t}(s.QueueStream);function h(e){return e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(2),a=n(0),i=n(65),s=1e3;t.getXhrDatasetConfig=function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open(\"GET\",e),r.onload=function(){t(JSON.parse(r.responseText))},r.onerror=function(e){n(e)},r.send()})};var u=function(e){function t(t){var n=e.call(this,t.data.map(function(e){return e.shape}))||this;return n.xhrDatasetConfig=t,n}return r(t,e),t.prototype.getTensor=function(e){var t=\"png\"===e.dataType?function(e,t){return new Promise(function(n,r){var o=new Image;o.setAttribute(\"crossOrigin\",\"\"),o.onload=function(){var e=function(e,t){var n=document.createElement(\"canvas\"),r=n.getContext(\"2d\"),o=e.height,i=a.sizeFromShape(t),u=new Uint8Array(o*i);if(e.width!==t[0]*t[1])throw new Error(\"Image width (\"+e.width+\") must be multiple of rows*columns (\"+t[0]+\"*\"+t[1]+\") of the tensor\");n.width=e.width,n.height=s;for(var p=n.width,h=n.height,d=p,f=h,m=t[2],v=0,g=Math.ceil(o/n.height),y=0;y<g;++y){var b=y*n.height;y===g-1&&o%n.height>0&&(n.height=o%n.height,h=n.height,f=h),r.drawImage(e,0,b,p,h,0,0,d,f);var x=r.getImageData(0,0,n.width,n.height).data;1===m?c(x,u,v):l(x,u,v),v+=n.height*i}return u}(o,t);o.src=\"\",o=null,n(e)},o.src=e.path})}(e,e.shape):function(e){return new Promise(function(t,n){var r=new XMLHttpRequest;r.open(\"GET\",e.path),r.responseType=\"arraybuffer\",r.onload=function(n){var o=\"float32\"===e.dataType?new Float32Array(r.response):new Uint8Array(r.response);t(o)},r.onerror=function(e){return n(e)},r.send()})}(e),n=a.sizeFromShape(e.shape);return t.then(function(t){for(var r=[],a=0;a<t.length/n;a++){var i=t.subarray(a*n,(a+1)*n),s=o.Tensor.make(e.shape,{values:new Float32Array(i)},\"float32\");r.push(s)}return r})},t.prototype.fetchData=function(){var e=this;return new Promise(function(t,n){var r=e.xhrDatasetConfig.data.map(function(t){return e.getTensor(t)});Promise.all(r).then(function(n){e.dataset=n,t()})})},t}(i.InMemoryDataset);function c(e,t,n){for(var r=n,o=0;o<e.length;o+=4)t[r++]=e[o]}function l(e,t,n){for(var r=n,o=0;o<e.length;o+=4)t[r]=e[o],t[r+1]=e[o+1],t[r+2]=e[o+2],r+=3}t.XhrDataset=u},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(2),o=n(0),a=function(){function e(e){this.dataShapes=e,this.normalizationInfo={}}return e.prototype.getDataShape=function(e){return this.dataShapes[e]},e.prototype.getData=function(){return this.dataset},e.prototype.getStats=function(){var e=this;if(null==this.dataset)throw new Error(\"Data is null.\");return this.dataset.map(function(t){return e.getStatsForData(t)})},e.prototype.getStatsForData=function(e){var t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,r=e.map(function(e,t){return t});o.shuffle(r),r=r.slice(.1*r.length);for(var a=0;a<r.length;a++)for(var i=e[r[a]].dataSync(),s=0;s<i.length;s++)t=Math.min(t,i[s]),n=Math.max(n,i[s]);return{inputMin:t,inputMax:n,exampleCount:e.length,shape:e[0].shape}},e.prototype.normalizeExamplesToRange=function(e,t,n,a,i){var s=n instanceof Float32Array&&t instanceof Float32Array,u=a instanceof Float32Array&&i instanceof Float32Array,c=o.sizeFromShape(e[0].shape),l=[];return e.forEach(function(e){for(var o=e.dataSync(),p=new Float32Array(c),h=0;h<c;h++){var d=s?t[h]:t,f=(s?n[h]:n)-d,m=u?a[h]:a,v=(u?i[h]:i)-m;p[h]=0===f?m:m+v*(o[h]-d)/f}l.push(r.Tensor.make(e.shape,{values:p},\"float32\"))}),l},e.prototype.computeBounds=function(e){var t=this;if(null==this.dataset)throw new Error(\"Data is null.\");var n=o.sizeFromShape(this.dataset[e][0].shape);this.normalizationInfo[e]={isNormalized:!1,minValues:new Float32Array(n),maxValues:new Float32Array(n)};for(var r=0;r<n;r++)this.normalizationInfo[e].minValues[r]=Number.POSITIVE_INFINITY,this.normalizationInfo[e].maxValues[r]=Number.NEGATIVE_INFINITY;this.dataset[e].forEach(function(r){for(var o=r.dataSync(),a=0;a<n;a++)t.normalizationInfo[e].minValues[a]=Math.min(t.normalizationInfo[e].minValues[a],o[a]),t.normalizationInfo[e].maxValues[a]=Math.max(t.normalizationInfo[e].maxValues[a],o[a])})},e.prototype.normalizeWithinBounds=function(e,t,n){if(null==this.dataset)throw new Error(\"Data is null.\");if(e>=this.dataset.length)throw new Error(\"dataIndex out of bounds.\");var r,o;null==this.normalizationInfo[e]&&this.computeBounds(e),this.normalizationInfo[e].isNormalized?(r=this.normalizationInfo[e].lowerBound,o=this.normalizationInfo[e].upperBound):(r=this.normalizationInfo[e].minValues,o=this.normalizationInfo[e].maxValues),this.dataset[e]=this.normalizeExamplesToRange(this.dataset[e],r,o,t,n),this.normalizationInfo[e].isNormalized=!0,this.normalizationInfo[e].lowerBound=t,this.normalizationInfo[e].upperBound=n},e.prototype.isNormalized=function(e){return null!=this.normalizationInfo&&this.normalizationInfo[e].isNormalized},e.prototype.removeNormalization=function(e){if(null==this.dataset)throw new Error(\"Training or test data is null.\");this.isNormalized(e)&&(this.dataset[e]=this.normalizeExamplesToRange(this.dataset[e],this.normalizationInfo[e].lowerBound,this.normalizationInfo[e].upperBound,this.normalizationInfo[e].minValues,this.normalizationInfo[e].maxValues),this.normalizationInfo[e].isNormalized=!1)},e.prototype.unnormalizeExamples=function(e,t){return this.isNormalized(t)?this.normalizeExamplesToRange(e,this.normalizationInfo[t].lowerBound,this.normalizationInfo[t].upperBound,this.normalizationInfo[t].minValues,this.normalizationInfo[t].maxValues):e},e.prototype.dispose=function(){if(null!=this.dataset){for(var e=0;e<this.dataset.length;e++)for(var t=0;t<this.dataset[e].length;t++)this.dataset[e][t].dispose();this.dataset=[]}},e}();t.InMemoryDataset=a},function(e,t,n){\"use strict\";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(1),i=n(21),s=n(26);function u(){return{alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0}}function c(e,t){return a.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")&&2===a.ENV.get(\"WEBGL_VERSION\")?4===t?e.RGBA:e.RED:e.RGBA}function l(e){return a.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")?e.FLOAT:e.UNSIGNED_BYTE}function p(e,t,n,r){s.validateTextureSize(e,t,n);var o=s.createTexture(e),i=e.TEXTURE_2D,u=function(e,t){return a.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")&&2===a.ENV.get(\"WEBGL_VERSION\")?4===t?e.RGBA32F:e.R32F:e.RGBA}(e,r),p=c(e,r);return s.callAndCheck(e,function(){return e.bindTexture(i,o)}),s.callAndCheck(e,function(){return e.texParameteri(i,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE)}),s.callAndCheck(e,function(){return e.texParameteri(i,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)}),s.callAndCheck(e,function(){return e.texParameteri(i,e.TEXTURE_MIN_FILTER,e.NEAREST)}),s.callAndCheck(e,function(){return e.texParameteri(i,e.TEXTURE_MAG_FILTER,e.NEAREST)}),s.callAndCheck(e,function(){return e.texImage2D(i,0,u,t,n,0,p,l(e),null)}),s.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)}),o}function h(e,t,n,r,o,a){var i=c(e,a);s.validateTextureSize(e,n,r),s.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,t)}),s.callAndCheck(e,function(){return e.texSubImage2D(e.TEXTURE_2D,0,0,0,n,r,i,l(e),o)}),s.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)})}function d(e,t,n){return a.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")?new Float32Array(i.getUnpackedArraySizeFromMatrixSize(e*t,n)):new Uint8Array(e*t*n)}function f(e,t,n,r){if(a.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")){var o=new Float32Array(t*n);return i.decodeMatrixFromUnpackedArray(e,o,r),o}return i.decodeToFloatArray(e)}t.getWebGLContextAttributes=u,t.createWebGLContext=function(e){var t,n={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};return t=null!=e?s.createWebGLRenderingContextFromCanvas(e,n):s.createWebGLRenderingContext(n),s.callAndCheck(t,function(){return t.disable(t.DEPTH_TEST)}),s.callAndCheck(t,function(){return t.disable(t.STENCIL_TEST)}),s.callAndCheck(t,function(){return t.disable(t.BLEND)}),s.callAndCheck(t,function(){return t.disable(t.DITHER)}),s.callAndCheck(t,function(){return t.disable(t.POLYGON_OFFSET_FILL)}),s.callAndCheck(t,function(){return t.disable(t.SAMPLE_COVERAGE)}),s.callAndCheck(t,function(){return t.enable(t.SCISSOR_TEST)}),s.callAndCheck(t,function(){return t.enable(t.CULL_FACE)}),s.callAndCheck(t,function(){return t.cullFace(t.BACK)}),t},t.createVertexShader=function(e){return s.createVertexShader(e,\"\\n    precision highp float;\\n    attribute vec3 clipSpacePos;\\n    attribute vec2 uv;\\n    varying vec2 resultUV;\\n\\n    void main() {\\n      gl_Position = vec4(clipSpacePos, 1);\\n      resultUV = uv;\\n    }\")},t.createVertexBuffer=function(e){var t=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return s.createStaticVertexBuffer(e,t)},t.createIndexBuffer=function(e){var t=new Uint16Array([0,1,2,2,1,3]);return s.createStaticIndexBuffer(e,t)},t.createMatrixTexture=function(e,t,n){var r=i.getUnpackedMatrixTextureShapeWidthHeight(t,n);return p(e,r[0],r[1],1)},t.createColorMatrixTexture=function(e,t,n){var r=i.getColorMatrixTextureShapeWidthHeight(t,n);return p(e,r[0],r[1],4)},t.createPackedMatrixTexture=function(e,t,n){var r=i.getPackedMatrixTextureShapeWidthHeight(t,n);return p(e,r[0],r[1],4)},t.bindVertexProgramAttributeStreams=function(e,t,n,r){s.callAndCheck(e,function(){return e.bindBuffer(e.ARRAY_BUFFER,n)}),s.bindVertexBufferToProgramAttribute(e,t,\"clipSpacePos\",n,3,20,0,r),s.bindVertexBufferToProgramAttribute(e,t,\"uv\",n,2,20,12,r)},t.uploadPixelDataToTexture=function(e,t,n){s.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,t)}),s.callAndCheck(e,function(){return e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,n)}),s.callAndCheck(e,function(){return e.bindTexture(e.TEXTURE_2D,null)})},t.uploadMatrixToTexture=function(e,t,n,r,o,u){var c,l=i.getUnpackedMatrixTextureShapeWidthHeight(n,r),p=l[0],d=l[1];if(a.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")){var f=1===u?s.getChannelsPerTexture():u;1===f?c=o:(c=new Float32Array(i.getUnpackedArraySizeFromMatrixSize(o.length,f)),i.encodeMatrixToUnpackedArray(o,c,f))}else c=i.encodeFloatArray(o);h(e,t,p,d,c,u)},t.uploadMatrixToPackedTexture=function(e,t,n,r,o){var a=i.getPackedMatrixTextureShapeWidthHeight(n,r),s=a[0],u=a[1],c=new Float32Array(i.getPackedRGBAArraySizeFromMatrixShape(n,r));i.encodeMatrixToPackedRGBA(o,n,r,c),h(e,t,s,u,c,4)},t.downloadMatrixFromOutputTextureAsync=function(e,t,n,a){return r(this,void 0,void 0,function(){var r,i,u,c,p;return o(this,function(o){switch(o.label){case 0:return r=e,u=d(n,a,i=4),c=u instanceof Float32Array?4*u.length:u,p=e.createBuffer(),s.callAndCheck(e,function(){return e.bindBuffer(r.PIXEL_PACK_BUFFER,p)}),s.callAndCheck(e,function(){return e.bufferData(r.PIXEL_PACK_BUFFER,c,e.STATIC_DRAW)}),s.callAndCheck(e,function(){return r.readPixels(0,0,a,n,e.RGBA,l(e),0)}),[4,t.getBufferSubDataAsync(r.PIXEL_PACK_BUFFER,0,u)];case 1:return o.sent(),[2,f(u,n,a,i)]}})})},t.downloadMatrixFromOutputTexture=function(e,t,n){var r=i.getUnpackedMatrixTextureShapeWidthHeight(t,n),o=r[0],a=r[1],u=d(t,n,4);return s.callAndCheck(e,function(){return e.readPixels(0,0,o,a,e.RGBA,l(e),u)}),f(u,t,n,4)},t.downloadMatrixFromRGBAColorTexture=function(e,t,n,r){var o=t*n*4,a=new Uint8Array(o);s.callAndCheck(e,function(){return e.readPixels(0,0,n,t,e.RGBA,e.UNSIGNED_BYTE,a)});for(var u=new Float32Array(o),c=0;c<a.length;c++)u[c]=a[c];var l=new Float32Array(t*n*r);return i.decodeMatrixFromUnpackedColorRGBAArray(u,l,r),l},t.downloadMatrixFromPackedOutputTexture=function(e,t,n){var r=i.getPackedMatrixTextureShapeWidthHeight(t,n),o=r[0],a=r[1],u=new Float32Array(i.getPackedRGBAArraySizeFromMatrixShape(t,n));s.callAndCheck(e,function(){return e.readPixels(0,0,o,a,e.RGBA,l(e),u)});var c=new Float32Array(t*n);return i.decodeMatrixFromPackedRGBA(u,t,n,c)}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(24),s=n(1),u=n(25),c=n(13),l=n(12),p=n(19),h=n(5),d=n(5),f=n(29),m=n(2),v=n(20),g=n(0),y=function(){function e(){this.data=new WeakMap,\"undefined\"!=typeof document&&(this.canvas=document.createElement(\"canvas\"))}return e.prototype.register=function(e,t,n){if(this.data.has(e))throw new Error(\"Data buffer is already registered\");this.data.set(e,null)},e.prototype.write=function(e,t){if(null==t)throw new Error(\"MathBackendCPU.write(): values can not be null\");this.throwIfNoData(e),this.data.set(e,t)},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error(\"MathBackendCPU.writePixels(): pixels can not be null\");var n,r;if(e instanceof ImageData)n=e.data;else if(e instanceof HTMLCanvasElement)n=e.getContext(\"2d\").getImageData(0,0,e.width,e.height).data;else{if(!(e instanceof HTMLImageElement||e instanceof HTMLVideoElement))throw new Error(\"pixels is of unknown type: \"+e.constructor.name);if(null==this.canvas)throw new Error(\"Can't read pixels from HTMLImageElement outside the browser.\");this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.getContext(\"2d\").drawImage(e,0,0,e.width,e.height),n=this.canvas.getContext(\"2d\").getImageData(0,0,e.width,e.height).data}if(4===t)r=new Int32Array(n);else{var o=e.width*e.height;r=new Int32Array(o*t);for(var a=0;a<o;a++)for(var i=0;i<t;++i)r[a*t+i]=n[4*a+i]}var s=[e.height,e.width,t];return d.tensor3d(r,s,\"int32\")},e.prototype.read=function(e){return o(this,void 0,void 0,function(){return a(this,function(t){return[2,this.readSync(e)]})})},e.prototype.readSync=function(e){return this.throwIfNoData(e),this.data.get(e)},e.prototype.disposeData=function(e){this.data.has(e)&&this.data.delete(e)},e.prototype.time=function(e){return o(this,void 0,void 0,function(){var t;return a(this,function(n){return t=performance.now(),e(),[2,{kernelMs:performance.now()-t}]})})},e.prototype.memory=function(){return{unreliable:!0}},e.prototype.throwIfNoData=function(e){if(!this.data.has(e))throw new Error(\"CPU backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends\")},e.prototype.slice1D=function(e,t,n){var r=e.dataSync().slice(t,t+n);return h.tensor1d(r,e.dtype)},e.prototype.slice2D=function(e,t,n){for(var r=h.buffer(n,e.dtype),o=t[0],a=t[1],i=0;i<n[0];++i)for(var s=0;s<n[1];++s){var u=e.get(i+o,s+a);r.set(u,i,s)}return r.toTensor()},e.prototype.slice3D=function(e,t,n){for(var r=h.buffer(n,e.dtype),o=t[0],a=t[1],i=t[2],s=0;s<n[0];++s)for(var u=0;u<n[1];++u)for(var c=0;c<n[2];++c){var l=e.get(s+o,u+a,c+i);r.set(l,s,u,c)}return r.toTensor()},e.prototype.slice4D=function(e,t,n){for(var r=h.buffer(n,e.dtype),o=t[0],a=t[1],i=t[2],s=t[3],u=0;u<n[0];++u)for(var c=0;c<n[1];++c)for(var l=0;l<n[2];++l)for(var p=0;p<n[3];++p){var d=e.get(u+o,c+a,l+i,p+s);r.set(d,u,c,l,p)}return r.toTensor()},e.prototype.reverse4D=function(e,t){for(var n=h.buffer(e.shape,e.dtype),r=function(n){return-1!==t.indexOf(n)&&1!==e.shape[n]},o=0;o<e.shape[0];++o)for(var a=0;a<e.shape[1];++a)for(var i=0;i<e.shape[2];++i)for(var s=0;s<e.shape[3];++s){var u=r(0)?e.shape[0]-o-1:o,c=r(1)?e.shape[1]-a-1:a,l=r(2)?e.shape[2]-i-1:i,p=r(3)?e.shape[3]-s-1:s,d=e.get(u,c,l,p);n.set(d,o,a,i,s)}return n.toTensor()},e.prototype.concat=function(e,t){var n=p.computeOutShape(e.shape,t.shape,1),r=h.buffer(n,e.dtype);if(1===e.shape[0]&&1===t.shape[0]){var o=e.dataSync(),a=t.dataSync(),i=r.values;return i.set(o,0),i.set(a,e.size),r.toTensor()}for(var s=0;s<n[0];++s){for(var u=0;u<e.shape[1];++u)r.set(e.get(s,u),s,u);for(u=0;u<t.shape[1];++u)r.set(t.get(s,u),s,u+e.shape[1])}return r.toTensor()},e.prototype.neg=function(e){return this.multiply(h.scalar(-1),e)},e.prototype.add=function(e,t){return this.broadcastedBinaryOp(e,t,v.upcastType(e.dtype,t.dtype),function(e,t){return e+t})},e.prototype.subtract=function(e,t){return this.broadcastedBinaryOp(e,t,v.upcastType(e.dtype,t.dtype),function(e,t){return e-t})},e.prototype.pow=function(e,t){return this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.pow(e,t)})},e.prototype.matMul=function(e,t,n,r){for(var o=n?e.shape[0]:e.shape[1],a=n?e.shape[1]:e.shape[0],i=r?t.shape[0]:t.shape[1],s=function(e,t,n){return e.get(t,n)},u=function(e,t,n){return e.get(n,t)},c=n?u:s,l=r?u:s,p=new Float32Array(a*i),d=0,f=0;f<a;++f)for(var m=0;m<i;++m){for(var v=0,g=0;g<o;++g)v+=c(e,f,g)*l(t,g,m);p[d++]=v}return h.tensor2d(p,[a,i])},e.prototype.multiply=function(e,t){return this.broadcastedBinaryOp(e,t,v.upcastType(e.dtype,t.dtype),function(e,t){return e*t})},e.prototype.divide=function(e,t){return this.broadcastedBinaryOp(e,t,\"float32\",function(e,t){return e/t})},e.prototype.sum=function(e,t){c.assertAxesAreInnerMostDims(\"sum\",t,e.rank);for(var n=c.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=v.upcastType(e.dtype,\"int32\"),i=h.zeros(r,a),s=g.sizeFromShape(o),u=i.dataSync(),l=e.dataSync(),p=0;p<u.length;++p){for(var d=p*s,f=0,m=0;m<s;++m)f+=l[d+m];u[p]=f}return i},e.prototype.argMin=function(e,t){c.assertAxesAreInnerMostDims(\"argMin\",t,e.rank);for(var n=c.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.zeros(r,\"int32\"),i=g.sizeFromShape(o),s=a.dataSync(),u=e.dataSync(),l=0;l<s.length;++l){for(var p=l*i,d=u[p],f=0,m=0;m<i;++m){var v=u[p+m];if(isNaN(v)){f=g.NAN_INT32;break}v<d&&(d=v,f=m)}s[l]=f}return a},e.prototype.argMax=function(e,t){c.assertAxesAreInnerMostDims(\"argMax\",t,e.rank);for(var n=c.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.zeros(r,\"int32\"),i=g.sizeFromShape(o),s=a.dataSync(),u=e.dataSync(),l=0;l<s.length;++l){for(var p=l*i,d=u[p],f=0,m=0;m<i;++m){var v=u[p+m];if(isNaN(v)){f=g.NAN_INT32;break}v>d&&(d=v,f=m)}s[l]=f}return a},e.prototype.equal=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n===r?1:0})},e.prototype.notEqual=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n!==r?1:0})},e.prototype.less=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n<r?1:0})},e.prototype.lessEqual=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n<=r?1:0})},e.prototype.greater=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n>r?1:0})},e.prototype.greaterEqual=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n>=r?1:0})},e.prototype.logicalNot=function(e){for(var t=e.dataSync(),n=new Int32Array(t.length),r=0;r<t.length;++r)g.isValNaN(t[r],e.dtype)?n[r]=g.getNaN(\"bool\"):n[r]=t[r]?0:1;return m.Tensor.make(e.shape,{values:n},\"bool\")},e.prototype.logicalAnd=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n&&r})},e.prototype.logicalOr=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n||r})},e.prototype.logicalXor=function(e,t){return this.broadcastedBinaryOp(e,t,\"bool\",function(n,r){return g.isValNaN(n,e.dtype)||g.isValNaN(r,t.dtype)?g.getNaN(\"bool\"):n^r})},e.prototype.where=function(e,t,n,r){for(var o=e.dataSync(),a=t.dataSync(),i=n.dataSync(),s=h.zeros(t.shape,r),u=s.dataSync(),c=0,l=0===e.rank||e.rank>1||1===t.rank?1:t.shape[1],p=0;p<o.length;p++)for(var d=0;d<l;d++)1===o[p]?u[c++]=a[p]:u[c++]=i[p];return s},e.prototype.topKValues=function(e,t){return this.topK(e,t).values},e.prototype.topKIndices=function(e,t){return this.topK(e,t).indices},e.prototype.topK=function(e,t){for(var n=e.dataSync(),r=[],o=0;o<n.length;o++)r.push({value:n[o],index:o});r.sort(function(e,t){return t.value-e.value});var a=g.getTypedArrayFromDType(e.dtype,t),i=new Int32Array(t);for(o=0;o<t;o++)a[o]=r[o].value,i[o]=r[o].index;return{values:h.tensor1d(a,e.dtype),indices:m.Tensor1D.new(i)}},e.prototype.min=function(e,t){c.assertAxesAreInnerMostDims(\"min\",t,e.rank);for(var n=c.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.zeros(r,e.dtype),i=g.sizeFromShape(o),s=a.dataSync(),u=e.dataSync(),l=0;l<s.length;++l){for(var p=l*i,d=u[0],f=0;f<i;++f){var m=u[p+f];if(isNaN(m)){d=Number.NaN;break}m<d&&(d=m)}s[l]=d}return a},e.prototype.minimum=function(e,t){return this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.min(e,t)})},e.prototype.max=function(e,t){c.assertAxesAreInnerMostDims(\"max\",t,e.rank);for(var n=c.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.zeros(r,e.dtype),i=g.sizeFromShape(o),s=a.dataSync(),u=e.dataSync(),l=0;l<s.length;++l){for(var p=l*i,d=u[p],f=0;f<i;++f){var m=u[p+f];if(isNaN(m)){d=Number.NaN;break}m>d&&(d=m)}s[l]=d}return a},e.prototype.maximum=function(e,t){return this.broadcastedBinaryOp(e,t,e.dtype,function(e,t){return Math.max(e,t)})},e.prototype.ceil=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.ceil(t[r]);return m.Tensor.make(e.shape,{values:n})},e.prototype.floor=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.floor(t[r]);return m.Tensor.make(e.shape,{values:n})},e.prototype.exp=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r)n[r]=Math.exp(t[r]);return m.Tensor.make(e.shape,{values:n})},e.prototype.log=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.log(o)}return m.Tensor.make(e.shape,{values:n})},e.prototype.sqrt=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=Math.sqrt(o)}return m.Tensor.make(e.shape,{values:n})},e.prototype.square=function(e){for(var t=e.dataSync(),n=new Float32Array(t.length),r=0;r<t.length;++r){var o=t[r];n[r]=o*o}return m.Tensor.make(e.shape,{values:n})},e.prototype.relu=function(e){for(var t=h.zeros(e.shape,e.dtype),n=t.dataSync(),r=e.dataSync(),o=0;o<r.length;++o){var a=r[o];g.isValNaN(a,e.dtype)?n[o]=g.getNaN(t.dtype):n[o]=Math.max(0,r[o])}return t},e.prototype.elu=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?o:Math.exp(o)-1}return m.Tensor.make(e.shape,{values:t})},e.prototype.eluDer=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r){var o=n[r];t[r]=o>=0?1:Math.exp(o)}return m.Tensor.make(e.shape,{values:t})},e.prototype.selu=function(e){for(var t=f.SELU_SCALEALPHA,n=f.SELU_SCALE,r=new Float32Array(e.size),o=e.dataSync(),a=0;a<o.length;++a){var i=o[a];r[a]=i>=0?n*i:t*(Math.exp(i)-1)}return m.Tensor.make(e.shape,{values:r})},e.prototype.leakyRelu=function(e,t){for(var n=new Float32Array(e.size),r=e.dataSync(),o=0;o<r.length;o++){var a=r[o];n[o]=a>=0?a:t*a}return m.Tensor.make(e.shape,{values:n})},e.prototype.prelu=function(e,t){for(var n=new Float32Array(e.size),r=e.dataSync(),o=t.dataSync(),a=0;a<r.length;a++){var i=r[a];n[a]=i>=0?i:o[a]*i}return m.Tensor.make(e.shape,{values:n})},e.prototype.preluDer=function(e,t){for(var n=new Float32Array(e.size),r=e.dataSync(),o=t.dataSync(),a=0;a<r.length;a++){var i=r[a];n[a]=i>0?1:i<0?o[a]:i}return m.Tensor.make(e.shape,{values:n})},e.prototype.clip=function(e,t,n){for(var r=new Float32Array(e.size),o=e.dataSync(),a=0;a<o.length;++a)r[a]=Math.min(n,Math.max(t,o[a]));return m.Tensor.make(e.shape,{values:r})},e.prototype.abs=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.abs(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.int=function(e){for(var t=new Int32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=n[r];return m.Tensor.make(e.shape,{values:t},\"int32\")},e.prototype.sigmoid=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=1/(1+Math.exp(-n[r]));return m.Tensor.make(e.shape,{values:t})},e.prototype.sin=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.sin(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.cos=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.cos(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.tan=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.tan(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.asin=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.asin(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.acos=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.acos(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.atan=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.atan(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.sinh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.sinh(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.cosh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=Math.cosh(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.tanh=function(e){for(var t=new Float32Array(e.size),n=e.dataSync(),r=0;r<n.length;++r)t[r]=g.tanh(n[r]);return m.Tensor.make(e.shape,{values:t})},e.prototype.step=function(e,t){void 0===t&&(t=0);for(var n=new Float32Array(e.size),r=e.dataSync(),o=0;o<r.length;++o){var a=r[o];g.isValNaN(a,e.dtype)?n[o]=g.getNaN(e.dtype):n[o]=a>0?1:t}return m.Tensor.make(e.shape,{values:n})},e.prototype.conv2d=function(e,t,n){for(var r=n.filterHeight,o=n.filterWidth,a=n.padInfo.left,i=n.padInfo.top,s=h.buffer(n.outShape,e.dtype),u=0;u<n.batchSize;++u)for(var c=0;c<n.outChannels;++c)for(var l=0;l<n.outHeight;++l)for(var p=l*n.strideHeight-a,d=Math.max(0,p),f=Math.min(n.inHeight,r+p),m=0;m<n.outWidth;++m){for(var v=m*n.strideWidth-i,g=Math.max(0,v),y=Math.min(n.inWidth,o+v),b=0,x=d;x<f;++x)for(var w=x-p,E=g;E<y;++E)for(var T=E-v,k=0;k<n.inChannels;++k){b+=e.get(u,x,E,k)*t.get(w,T,k,c)}s.set(b,u,l,m,c)}return s.toTensor()},e.prototype.conv2dDerInput=function(e,t,n){for(var r=n.filterHeight,o=n.filterWidth,a=r-1-n.padInfo.top,i=o-1-n.padInfo.left,s=n.strideHeight,u=n.strideWidth,c=h.buffer(n.inShape,\"float32\"),l=0;l<n.batchSize;++l)for(var p=0;p<n.inChannels;++p)for(var d=0;d<n.inHeight;++d)for(var f=d-i,m=Math.max(0,Math.ceil(f/s)),v=Math.min(n.outHeight,(r+f)/s),g=0;g<n.inWidth;++g){for(var y=g-a,b=Math.max(0,Math.ceil(y/u)),x=Math.min(n.outWidth,(o+y)/u),w=0,E=m;E<v;++E)for(var T=E*s-f,k=b;k<x;++k)for(var S=k*u-y,O=0;O<n.outChannels;++O){w+=e.get(l,E,k,O)*t.get(r-1-T,o-1-S,p,O)}c.set(w,l,d,g,p)}return c.toTensor()},e.prototype.conv2dDerFilter=function(e,t,n){for(var r=n.strideHeight,o=n.strideWidth,a=n.filterHeight,i=n.filterWidth,s=h.buffer(n.filterShape,\"float32\"),u=n.padInfo.left,c=n.padInfo.top,l=0;l<a;++l)for(var p=Math.max(0,Math.ceil((c-l)/r)),d=Math.min(n.outHeight,(n.inHeight+c-l)/r),f=0;f<i;++f)for(var m=Math.max(0,Math.ceil((u-f)/o)),v=Math.min(n.outWidth,(n.inWidth+u-f)/o),g=0;g<n.inChannels;++g)for(var y=0;y<n.outChannels;++y){for(var b=0,x=0;x<n.batchSize;++x)for(var w=p;w<d;++w)for(var E=l+w*r-c,T=m;T<v;++T){var k=f+T*o-u;b+=e.get(x,E,k,g)*t.get(x,w,T,y)}s.set(b,l,f,g,y)}return s.toTensor()},e.prototype.depthwiseConv2D=function(e,t,n){for(var r=n.filterHeight,o=n.filterWidth,a=n.padInfo.left,i=n.padInfo.top,s=n.outChannels/n.inChannels,u=h.buffer(n.outShape,e.dtype),c=0;c<n.batchSize;++c)for(var l=0;l<n.inChannels;++l)for(var p=0;p<n.outHeight;++p)for(var d=p*n.strideHeight-a,f=Math.max(0,d),m=Math.min(n.inHeight,r+d),v=0;v<n.outWidth;++v)for(var g=v*n.strideWidth-i,y=Math.max(0,g),b=Math.min(n.inWidth,o+g),x=0;x<s;++x){for(var w=0,E=f;E<m;++E)for(var T=E-d,k=y;k<b;++k){var S=k-g;w+=e.get(c,E,k,l)*t.get(T,S,l,x)}u.set(w,c,p,v,l*s+x)}return u.toTensor()},e.prototype.tile=function(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[r]*t[r];var o=h.buffer(n,e.dtype),a=e.dataSync();for(r=0;r<o.values.length;++r){for(var i=o.indexToLoc(r),s=new Array(e.rank),u=0;u<s.length;u++)s[u]=i[u]%e.shape[u];var c=e.locToIndex(s);o.values[r]=a[c]}return o.toTensor()},e.prototype.pad1D=function(e,t,n){for(var r=t[0],o=t[1],a=e.dataSync(),i=h.zeros([r+a.length+o],e.dtype),s=i.dataSync(),u=0,c=0;c<s.length;c++)c>=r&&c<r+a.length?s[c]=a[u++]:s[c]=n;return i},e.prototype.pad2D=function(e,t,n){for(var r=t[0][0],o=t[0][1],a=t[1][0],i=t[1][1],s=[r+e.shape[0]+o,a+e.shape[1]+i],u=h.zeros(s,e.dtype),c=u.dataSync(),l=e.dataSync(),p=0,d=0;d<s[0];d++){var f=-1,m=-1;d>=r&&d<s[0]-o&&(m=(f=d*s[1]+a)+e.shape[1]-1);for(var v=0;v<s[1];v++){var g=d*s[1]+v;c[g]=g>=f&&g<=m?l[p++]:n}}return u},e.prototype.transpose=function(e,t){for(var n=new Array(e.rank),r=0;r<n.length;r++)n[r]=e.shape[t[r]];var o=new Float32Array(e.size),a=e.dataSync(),i=m.Tensor.make(n,{values:o});for(r=0;r<e.size;++r){for(var s=e.indexToLoc(r),u=new Array(s.length),c=0;c<u.length;c++)u[c]=s[t[c]];o[i.locToIndex(u)]=a[r]}return i},e.prototype.gather=function(e,t,n){var r=e.shape.slice(),o=t.dataSync();r[n]=o.length;for(var a=h.zeros(r,e.dtype),i=e.dataSync(),s=a.dataSync(),u=0;u<a.size;++u){var c=a.indexToLoc(u),l=c.slice();l[n]=o[c[n]];var p=e.locToIndex(l);s[u]=i[p]}return a},e.prototype.pool=function(e,t,n){for(var r=t.strideHeight,o=t.strideWidth,a=t.filterHeight,i=t.filterWidth,s=h.buffer(t.outShape,\"float32\"),u=t.padInfo.top,c=t.padInfo.left,l=0;l<t.batchSize;++l)for(var p=0;p<t.inChannels;++p)for(var d=0;d<t.outHeight;++d)for(var f=d*r-u,m=Math.max(0,f),v=Math.min(t.inHeight,a+f),g=0;g<t.outWidth;++g){for(var y=g*o-c,b=Math.max(0,y),x=Math.min(t.inWidth,i+y),w=\"max\"===n?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,E=0,T=m;T<v;++T){for(var k=b;k<x;++k){var S=e.get(l,T,k,p);if(isNaN(S)){w=NaN,E=NaN;break}\"max\"===n&&S>w||\"min\"===n&&S<w?w=S:\"avg\"===n&&(E+=S/(a*i))}if(isNaN(w))break}s.set(\"avg\"===n?E:w,l,d,g,p)}return s.toTensor()},e.prototype.maxPool=function(e,t){return this.pool(e,t,\"max\")},e.prototype.maxPoolPositions=function(e,t){for(var n=h.buffer(t.outShape,\"int32\"),r=t.strideHeight,o=t.strideWidth,a=t.filterHeight,i=t.filterWidth,s=t.padInfo.top,u=t.padInfo.left,c=0;c<t.batchSize;++c)for(var l=0;l<t.inChannels;++l)for(var p=0;p<t.outHeight;++p)for(var d=p*r-s,f=Math.max(0,d),m=Math.min(t.inHeight,a+d),v=0;v<t.outWidth;++v){for(var g=v*o-u,y=Math.max(0,g),b=Math.min(t.inWidth,i+g),x=Number.NEGATIVE_INFINITY,w=-1,E=f;E<m;++E)for(var T=E-d,k=y;k<b;++k){var S=k-g,O=e.get(c,E,k,l);O>x&&(x=O,w=T*i+S)}n.set(w,c,p,v,l)}return n.toTensor()},e.prototype.maxPoolBackprop=function(e,t,n){for(var r=this.maxPoolPositions(t,n),o=n.strideHeight,a=n.strideWidth,i=n.filterHeight,s=n.filterWidth,u=s-1-n.padInfo.left,c=i-1-n.padInfo.top,l=h.buffer(t.shape,\"float32\"),p=0;p<n.batchSize;++p)for(var d=0;d<n.inChannels;++d)for(var f=0;f<n.inHeight;++f)for(var m=0;m<n.inWidth;++m){for(var v=f-c,g=m-u,y=0,b=0;b<i;++b){var x=(v+b)/o;if(!(x<0||x>=n.outHeight||Math.floor(x)!==x))for(var w=0;w<s;++w){var E=(g+w)/a;if(!(E<0||E>=n.outWidth||Math.floor(E)!==E)){var T=i*s-1-r.get(p,x,E,d)===b*s+w?1:0;if(0!==T)y+=e.get(p,x,E,d)*T}}}l.set(y,p,f,m,d)}return l.toTensor()},e.prototype.avgPoolBackprop=function(e,t,n){for(var r=n.strideHeight,o=n.strideWidth,a=n.filterHeight,i=n.filterWidth,s=i-1-n.padInfo.left,u=a-1-n.padInfo.top,c=h.buffer(t.shape,\"float32\"),l=1/(a*i),p=0;p<n.batchSize;++p)for(var d=0;d<n.inChannels;++d)for(var f=0;f<n.inHeight;++f)for(var m=0;m<n.inWidth;++m){for(var v=f-u,g=m-s,y=0,b=0;b<a;++b){var x=(v+b)/r;if(!(x<0||x>=n.outHeight||Math.floor(x)!==x))for(var w=0;w<i;++w){var E=(g+w)/o;if(!(E<0||E>=n.outWidth||Math.floor(E)!==E))y+=e.get(p,x,E,d)}}c.set(y*l,p,f,m,d)}return c.toTensor()},e.prototype.minPool=function(e,t){return this.pool(e,t,\"min\")},e.prototype.avgPool=function(e,t){return this.pool(e,t,\"avg\").toFloat()},e.prototype.resizeBilinear=function(e,t,n,r){for(var o=e.shape,a=o[0],i=o[1],s=o[2],u=o[3],c=h.buffer([a,t,n,u],e.dtype),l=r?[i-1,s-1]:[i,s],p=r?[t-1,n-1]:[t,n],d=0;d<a;d++)for(var f=0;f<t;f++)for(var m=0;m<n;m++)for(var v=0;v<u;v++){var g=l[0]*f/p[0],y=l[1]*m/p[1],b=Math.floor(g),x=Math.min(i-1,Math.ceil(g)),w=Math.floor(y),E=Math.min(s-1,Math.ceil(y)),T=e.get(d,b,w,v),k=e.get(d,x,w,v),S=y-w,O=T+(e.get(d,b,E,v)-T)*S,_=O+(k+(e.get(d,x,E,v)-k)*S-O)*(g-b);c.set(_,d,f,m,v)}return c.toTensor()},e.prototype.batchNormalization4D=function(e,t,n,r,o,a){for(var i=e.dataSync(),s=t.dataSync(),u=n.dataSync(),c=o?o.dataSync():new Float32Array([1]),l=a?a.dataSync():new Float32Array([0]),p=new Float32Array(i.length),h=0;h<i.length;h++)p[h]=l[h%l.length]+(i[h]-s[h%s.length])*c[h%c.length]/Math.sqrt(u[h%u.length]+r);return d.tensor4d(p,e.shape)},e.prototype.localResponseNormalization4D=function(e,t,n,r,o,a){for(var i=h.buffer(e.shape,\"float32\"),s=t,u=i.shape[1]-1,c=i.shape[2]-1,l=i.shape[3]-1,p=function(t,n,r,o){for(var a=0,i=Math.max(0,o-s);i<=Math.min(o+s,l);i++){var u=e.get(t,n,r,i);a+=u*u}return a},d=function(t,n,r,o){for(var a=0,i=Math.max(0,n-s);i<=Math.min(n+s,u);i++)for(var l=Math.max(0,r-s);l<=Math.min(r+s,c);l++)a+=Math.pow(e.get(t,i,l,o),2);return a},f=0;f<i.shape[0];f++)for(var m=0;m<=i.shape[1];m++)for(var v=0;v<i.shape[2];v++)for(var g=0;g<i.shape[3];g++){var y=\"withinChannel\"===a?d(f,m,v,g):p(f,m,v,g),b=e.get(f,m,v,g)*Math.pow(n+r*y,-o);i.set(b,f,m,v,g)}return i.toTensor()},e.prototype.multinomial=function(e,t,n){for(var r=e.shape[0],o=e.shape[1],a=h.zeros([r,t],\"int32\"),s=a.dataSync(),u=e.dataSync(),c=0;c<r;++c){var l=c*o,p=new Float32Array(o-1);p[0]=u[l];for(var d=1;d<p.length;++d)p[d]=p[d-1]+u[l+d];for(var f=i.alea(n.toString()),m=c*t,v=0;v<t;++v){var g=f();s[m+v]=p.length;for(var y=0;y<p.length;y++)if(g<p[y]){s[m+v]=y;break}}}return a},e.prototype.oneHot=function(e,t,n,r){var o=new Float32Array(e.size*t);o.fill(r);for(var a=0;a<e.size;++a)o[a*t+e.get(a)]=n;return h.tensor2d(o,[e.size,t])},e.prototype.broadcastedBinaryOp=function(e,t,n,r){for(var o=l.assertAndGetBroadcastShape(e.shape,t.shape),a=h.buffer(o,n),i=e.dataSync(),s=t.dataSync(),u=l.getBroadcastDims(e.shape,o),c=l.getBroadcastDims(t.shape,o),p=function(n){var o=a.indexToLoc(n),l=o.slice(-e.rank);u.forEach(function(e){return l[e]=0});var p=e.locToIndex(l),h=o.slice(-t.rank);c.forEach(function(e){return h[e]=0});var d=t.locToIndex(h);a.values[n]=r(i[p],s[d])},d=0;d<a.values.length;++d)p(d);return a.toTensor()},e.prototype.dispose=function(){},e}();t.MathBackendCPU=y,s.ENV.registerBackend(\"cpu\",function(){return new y});var b=function(e){function t(t){void 0===t&&(t=!1);return console.warn(\"new NDArrayMathCPU() is deprecated. Please use dl.setBackend('cpu').\"),e.call(this,\"cpu\",t)||this}return r(t,e),t}(u.NDArrayMath);t.NDArrayMathCPU=b},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(1),s=n(25),u=n(13),c=n(107),l=n(2),p=n(20),h=n(0),d=n(108),f=n(109),m=n(110),v=n(69),g=n(69),y=n(111),b=n(112),x=n(113),w=n(114),E=n(115),T=n(116),k=n(117),S=n(70),O=n(118),_=n(119),A=n(120),C=n(121),N=n(122),M=n(123),P=n(124),R=n(125),D=n(126),I=n(127),B=n(128),z=n(129),L=n(130),F=n(21),V=n(131),G=n(132),U=n(133),j=n(71),q=n(71),W=n(26),X=function(){function e(e,t){if(void 0===t&&(t=!0),this.gpgpu=e,this.delayedStorage=t,this.texData=new WeakMap,this.uploadWaitMs=0,this.downloadWaitMs=0,this.binaryCache={},this.disposed=!1,i.ENV.get(\"WEBGL_VERSION\")<1)throw new Error(\"WebGL is not supported on this device\");null==e?(this.gpgpu=new S.GPGPUContext,this.gpgpuCreatedLocally=!0):this.gpgpuCreatedLocally=!1,\"undefined\"!=typeof document&&(this.canvas=document.createElement(\"canvas\")),this.textureManager=new V.TextureManager(this.gpgpu)}return e.prototype.register=function(e,t,n){if(this.texData.has(e))throw new Error(\"Data buffer is already registered\");this.texData.set(e,{shape:t,dtype:n,values:null,texture:null,texShape:null,texType:F.TextureType.FLOAT})},e.prototype.fromPixels=function(e,t){if(null==e)throw new Error(\"MathBackendWebGL.writePixels(): pixels can not be null\");var n=[e.height,e.width],r=[e.height,e.width,t];if(e instanceof HTMLVideoElement){if(null==this.canvas)throw new Error(\"Can't read pixels from HTMLImageElement outside the browser.\");this.canvas.width=e.width,this.canvas.height=e.height,this.canvas.getContext(\"2d\").drawImage(e,0,0,e.width,e.height),e=this.canvas}var o=l.Tensor.make(n,{},\"int32\");this.texData.get(o.dataId).texType=F.TextureType.UNSIGNED_BYTE,this.gpgpu.uploadPixelDataToTexture(this.getTexture(o.dataId),e);var a=new T.FromPixelsProgram(r),i=this.compileAndRun(a,[o]);return o.dispose(),i},e.prototype.write=function(e,t){if(null==t)throw new Error(\"MathBackendWebGL.write(): values can not be null\");this.throwIfNoData(e);var n=this.texData.get(e),r=n.texture,o=n.texShape,a=n.texType;null!=r&&(this.textureManager.releaseTexture(r,o,a),n.texture=null,n.texShape=null),n.values=t,this.delayedStorage||this.uploadToGPU(e)},e.prototype.readSync=function(e){this.throwIfNoData(e);var t=this.texData.get(e),n=t.texture,r=t.values,o=t.texShape;if(null!=r)return this.cacheOnCPU(e),r;var a,i=null!=this.activeTimers;i&&(a=performance.now());var s=this.gpgpu.downloadMatrixFromTexture(n,o[0],o[1]);return i&&(this.downloadWaitMs+=performance.now()-a),this.cacheOnCPU(e,s),t.values},e.prototype.read=function(e){return o(this,void 0,void 0,function(){var t,n,r,o,s;return a(this,function(a){switch(a.label){case 0:return this.throwIfNoData(e),t=this.texData.get(e),n=t.texture,r=t.values,o=t.texShape,null!=r?(this.cacheOnCPU(e),[2,r]):i.ENV.get(\"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED\")?[4,this.gpgpu.downloadMatrixFromTextureAsync(n,o[0],o[1])]:[3,2];case 1:return s=a.sent(),this.cacheOnCPU(e,s),[2,t.values];case 2:return 0===i.ENV.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")?[2,this.readSync(e)]:[4,this.gpgpu.runQuery(function(){})];case 3:return a.sent(),[2,this.readSync(e)]}})})},e.prototype.time=function(e){return o(this,void 0,void 0,function(){var t,n,r,o,i,s;return a(this,function(a){switch(a.label){case 0:return t=this.activeTimers,n=[],r=!1,null==this.programTimersStack?(this.programTimersStack=n,r=!0):this.activeTimers.push(n),this.activeTimers=n,e(),o=h.flatten(this.activeTimers),this.activeTimers=t,r&&(this.programTimersStack=null),[4,Promise.all(o).then(function(e){var t=0;return e.forEach(function(e){return t+=e}),t})];case 1:return i=a.sent(),s={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:i,wallMs:null},this.uploadWaitMs=0,this.downloadWaitMs=0,[2,s]}})})},e.prototype.memory=function(){return{unreliable:!1}},e.prototype.startTimer=function(){return i.ENV.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")>0?this.gpgpu.beginQuery():{startMs:performance.now(),endMs:null}},e.prototype.endTimer=function(e){return i.ENV.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")>0?(this.gpgpu.endQuery(),e):(e.endMs=performance.now(),e)},e.prototype.getQueryTime=function(e){return o(this,void 0,void 0,function(){var t;return a(this,function(n){return i.ENV.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")>0?[2,this.gpgpu.pollQueryTime(e)]:[2,(t=e).endMs-t.startMs]})})},e.prototype.disposeData=function(e){if(this.texData.has(e)){var t=this.texData.get(e),n=t.texture,r=t.texShape,o=t.texType;null!=n&&this.textureManager.releaseTexture(n,r,o),this.texData.delete(e)}},e.prototype.getTexture=function(e){return this.uploadToGPU(e),this.texData.get(e).texture},e.prototype.getTextureData=function(e){return this.uploadToGPU(e),this.texData.get(e)},e.prototype.getGPGPUContext=function(){return this.gpgpu},e.prototype.slice1D=function(e,t,n){var r=new L.SliceProgram([n]),o=r.getCustomSetupFunc([t]);return this.compileAndRun(r,[e],null,o)},e.prototype.slice2D=function(e,t,n){var r=new L.SliceProgram(n),o=r.getCustomSetupFunc(t);return this.compileAndRun(r,[e],null,o)},e.prototype.slice3D=function(e,t,n){var r=new L.SliceProgram(n),o=r.getCustomSetupFunc(t);return this.compileAndRun(r,[e],null,o)},e.prototype.slice4D=function(e,t,n){var r=new L.SliceProgram(n),o=r.getCustomSetupFunc(t);return this.compileAndRun(r,[e],null,o)},e.prototype.reverse4D=function(e,t){var n=new z.ReverseProgram(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.concat=function(e,t){var n=new b.ConcatProgram(e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.neg=function(e){var t=new q.UnaryOpProgram(e.shape,j.NEG);return this.compileAndRun(t,[e])},e.prototype.matMul=function(e,t,n,r){var o=new N.MatMulProgram(e.shape,t.shape,n,r);return this.compileAndRun(o,[e,t])},e.prototype.multiply=function(e,t){var n=new g.BinaryOpProgram(v.MUL,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,p.upcastType(e.dtype,t.dtype));return this.compileAndRun(n,[e,t],r)},e.prototype.batchNormalization4D=function(e,t,n,r,o,a){var i=[e,t,n],s=null;null!=a&&(s=a.shape,i.push(a));var u=null;null!=o&&(u=o.shape,i.push(o));var c=new m.BatchNormProgram(e.shape,t.shape,n.shape,s,u,r);return this.compileAndRun(c,i)},e.prototype.localResponseNormalization4D=function(e,t,n,r,o,a){var i=new A.LRNProgram(e.shape,t,n,r,o,a);return this.compileAndRun(i,[e])},e.prototype.tile=function(e,t){var n=new G.TileProgram(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.pad1D=function(e,t,n){var r=new R.Pad1DProgram(e.shape,t,n);return this.compileAndRun(r,[e])},e.prototype.pad2D=function(e,t,n){var r=new R.Pad2DProgram(e.shape,t,n);return this.compileAndRun(r,[e])},e.prototype.transpose=function(e,t){var n=new U.TransposeProgram(e.shape,t);return this.compileAndRun(n,[e])},e.prototype.gather=function(e,t,n){var r=new k.GatherProgram(e.shape,t.size,n);return this.compileAndRun(r,[e,t])},e.prototype.reduce=function(e,t,n){var r=e.shape[0],o=e.shape[1],a={windowSize:c.computeOptimalWindowSize(o),inSize:o,batchSize:r},i=new I.ReduceProgram(a,t),s=i.outputShape,u=s[0],l=s[1],p=this.makeOutputArray([u,l],n);return this.compileAndRun(i,[e],p),1===p.shape[1]?p:this.reduce(p,t,n)},e.prototype.argReduce=function(e,t,n){void 0===n&&(n=null);var r=e.shape[0],o=e.shape[1];null!=n&&(r=n.shape[0],o=n.shape[1]);var a={windowSize:c.computeOptimalWindowSize(o),inSize:o,batchSize:r},i=new d.ArgMinMaxProgram(a,t,null==n),s=i.outputShape,u=s[0],l=s[1],p=this.makeOutputArray([u,l],\"int32\"),h=[e];return null!=n&&h.push(n),this.compileAndRun(i,h,p),1===p.shape[1]?p:this.argReduce(e,t,p)},e.prototype.sum=function(e,t){u.assertAxesAreInnerMostDims(\"sum\",t,e.rank);var n=u.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.sizeFromShape(o),i=e.as2D(-1,a),s=p.sumOutType(e.dtype);return this.reduce(i,\"sum\",s).reshape(r)},e.prototype.argMin=function(e,t){u.assertAxesAreInnerMostDims(\"argMin\",t,e.rank);var n=u.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.sizeFromShape(o),i=e.as2D(-1,a);return this.argReduce(i,\"min\").reshape(r)},e.prototype.argMax=function(e,t){u.assertAxesAreInnerMostDims(\"argMax\",t,e.rank);var n=u.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.sizeFromShape(o),i=e.as2D(-1,a);return this.argReduce(i,\"max\").reshape(r)},e.prototype.equal=function(e,t){var n=new g.BinaryOpProgram(v.EQUAL,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.notEqual=function(e,t){var n=new g.BinaryOpProgram(v.NOT_EQUAL,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.less=function(e,t){var n=new g.BinaryOpProgram(v.LESS,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.lessEqual=function(e,t){var n=new g.BinaryOpProgram(v.LESS_EQUAL,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.greater=function(e,t){var n=new g.BinaryOpProgram(v.GREATER,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.greaterEqual=function(e,t){var n=new g.BinaryOpProgram(v.GREATER_EQUAL,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.logicalNot=function(e){var t=new q.UnaryOpProgram(e.shape,j.LOGICAL_NOT);return this.compileAndRun(t,[e])},e.prototype.logicalAnd=function(e,t){var n=new g.BinaryOpProgram(v.LOGICAL_AND,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.logicalOr=function(e,t){var n=new g.BinaryOpProgram(v.LOGICAL_OR,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.logicalXor=function(e,t){var n=new g.BinaryOpProgram(v.LOGICAL_XOR,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"bool\");return this.compileAndRun(n,[e,t],r)},e.prototype.where=function(e,t,n,r){var o=new _.WhereProgram(e.rank,t.shape,t.rank),a=this.makeOutputArray(o.outputShape,r);return this.compileAndRun(o,[e,t,n],a)},e.prototype.topKValues=function(e,t){throw new Error(\"topKValues GPU not yet implemented!\")},e.prototype.topKIndices=function(e,t){throw new Error(\"topKIndices GPU not yet implemented!\")},e.prototype.min=function(e,t){u.assertAxesAreInnerMostDims(\"min\",t,e.rank);var n=u.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.sizeFromShape(o),i=e.as2D(-1,a);return this.reduce(i,\"min\",i.dtype).reshape(r)},e.prototype.minimum=function(e,t){var n=new g.BinaryOpProgram(v.MIN,e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.max=function(e,t){u.assertAxesAreInnerMostDims(\"max\",t,e.rank);var n=u.computeOutAndReduceShapes(e.shape,t),r=n[0],o=n[1],a=h.sizeFromShape(o),i=e.as2D(-1,a);return this.reduce(i,\"max\",i.dtype).reshape(r)},e.prototype.maximum=function(e,t){var n=new g.BinaryOpProgram(v.MAX,e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.divide=function(e,t){var n=new g.BinaryOpProgram(v.DIV,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,\"float32\");return this.compileAndRun(n,[e,t],r)},e.prototype.add=function(e,t){var n=new g.BinaryOpProgram(v.ADD,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,p.upcastType(e.dtype,t.dtype));return this.compileAndRun(n,[e,t],r)},e.prototype.subtract=function(e,t){var n=new g.BinaryOpProgram(v.SUB,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,p.upcastType(e.dtype,t.dtype));return this.compileAndRun(n,[e,t],r)},e.prototype.pow=function(e,t){var n=new g.BinaryOpProgram(v.POW,e.shape,t.shape),r=this.makeOutputArray(n.outputShape,p.upcastType(e.dtype,t.dtype));return this.compileAndRun(n,[e,t],r)},e.prototype.ceil=function(e){var t=new q.UnaryOpProgram(e.shape,j.CEIL);return this.compileAndRun(t,[e])},e.prototype.floor=function(e){var t=new q.UnaryOpProgram(e.shape,j.FLOOR);return this.compileAndRun(t,[e])},e.prototype.exp=function(e){var t=new q.UnaryOpProgram(e.shape,j.EXP);return this.compileAndRun(t,[e])},e.prototype.log=function(e){var t=new q.UnaryOpProgram(e.shape,j.LOG);return this.compileAndRun(t,[e])},e.prototype.sqrt=function(e){var t=new q.UnaryOpProgram(e.shape,j.SQRT);return this.compileAndRun(t,[e])},e.prototype.square=function(e){var t=new q.UnaryOpProgram(e.shape,j.SQUARE);return this.compileAndRun(t,[e])},e.prototype.relu=function(e){var t=new q.UnaryOpProgram(e.shape,j.RELU);return this.compileAndRun(t,[e])},e.prototype.elu=function(e){var t=new q.UnaryOpProgram(e.shape,j.ELU);return this.compileAndRun(t,[e])},e.prototype.eluDer=function(e){var t=new q.UnaryOpProgram(e.shape,j.ELU_DER);return this.compileAndRun(t,[e])},e.prototype.selu=function(e){var t=new q.UnaryOpProgram(e.shape,j.SELU);return this.compileAndRun(t,[e])},e.prototype.leakyRelu=function(e,t){var n=new q.UnaryOpProgram(e.shape,j.LEAKY_RELU(t));return this.compileAndRun(n,[e])},e.prototype.prelu=function(e,t){var n=new g.BinaryOpProgram(v.PRELU,e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.preluDer=function(e,t){var n=new g.BinaryOpProgram(v.PRELU_DER,e.shape,t.shape);return this.compileAndRun(n,[e,t])},e.prototype.int=function(e){var t=new q.UnaryOpProgram(e.shape,j.TO_INT),n=this.makeOutputArray(t.outputShape,\"int32\");return this.compileAndRun(t,[e],n)},e.prototype.clip=function(e,t,n){var r=new y.ClipProgram(e.shape,t,n);return this.compileAndRun(r,[e])},e.prototype.abs=function(e){var t=new q.UnaryOpProgram(e.shape,j.ABS);return this.compileAndRun(t,[e])},e.prototype.sigmoid=function(e){var t=new q.UnaryOpProgram(e.shape,j.SIGMOID);return this.compileAndRun(t,[e])},e.prototype.sin=function(e){var t=new q.UnaryOpProgram(e.shape,j.SIN);return this.compileAndRun(t,[e])},e.prototype.cos=function(e){var t=new q.UnaryOpProgram(e.shape,j.COS);return this.compileAndRun(t,[e])},e.prototype.tan=function(e){var t=new q.UnaryOpProgram(e.shape,j.TAN);return this.compileAndRun(t,[e])},e.prototype.asin=function(e){var t=new q.UnaryOpProgram(e.shape,j.ASIN);return this.compileAndRun(t,[e])},e.prototype.acos=function(e){var t=new q.UnaryOpProgram(e.shape,j.ACOS);return this.compileAndRun(t,[e])},e.prototype.atan=function(e){var t=new q.UnaryOpProgram(e.shape,j.ATAN);return this.compileAndRun(t,[e])},e.prototype.sinh=function(e){var t=new q.UnaryOpProgram(e.shape,j.SINH);return this.compileAndRun(t,[e])},e.prototype.cosh=function(e){var t=new q.UnaryOpProgram(e.shape,j.COSH);return this.compileAndRun(t,[e])},e.prototype.tanh=function(e){var t=new q.UnaryOpProgram(e.shape,j.TANH);return this.compileAndRun(t,[e])},e.prototype.step=function(e,t){var n=new q.UnaryOpProgram(e.shape,j.STEP(t));return this.compileAndRun(n,[e])},e.prototype.conv2d=function(e,t,n){var r=new w.Conv2DProgram(n);return this.compileAndRun(r,[e,t])},e.prototype.conv2dDerInput=function(e,t,n){var r=new x.Conv2DDerInputProgram(n);return this.compileAndRun(r,[e,t])},e.prototype.conv2dDerFilter=function(e,t,n){var r=new x.Conv2DDerFilterProgram(n);return this.compileAndRun(r,[e,t])},e.prototype.depthwiseConv2D=function(e,t,n){var r=new E.DepthwiseConv2DProgram(n);return this.compileAndRun(r,[e,t])},e.prototype.maxPool=function(e,t){var n=new D.Pool2DProgram(t,\"max\",!1),r=this.makeOutputArray(n.outputShape,e.dtype);return this.compileAndRun(n,[e],r)},e.prototype.minPool=function(e,t){var n=new D.Pool2DProgram(t,\"min\",!1),r=this.makeOutputArray(n.outputShape,e.dtype);return this.compileAndRun(n,[e],r)},e.prototype.avgPool=function(e,t){var n=new D.Pool2DProgram(t,\"avg\",!1),r=this.makeOutputArray(n.outputShape,\"float32\");return this.compileAndRun(n,[e],r)},e.prototype.maxPoolBackprop=function(e,t,n){var r=new D.Pool2DProgram(n,\"max\",!0),o=this.compileAndRun(r,[t]),a=new C.MaxPool2DBackpropProgram(n),i=this.makeOutputArray(a.outputShape,t.dtype),s=this.compileAndRun(a,[e,o],i);return o.dispose(),s},e.prototype.avgPoolBackprop=function(e,t,n){var r=new f.AvgPool2DBackpropProgram(n),o=this.makeOutputArray(r.outputShape,t.dtype);return this.compileAndRun(r,[e],o)},e.prototype.resizeBilinear=function(e,t,n,r){var o=new B.ResizeBilinearProgram(e.shape,t,n,r);return this.compileAndRun(o,[e])},e.prototype.multinomial=function(e,t,n){var r=e.shape[0],o=e.shape[1],a=new M.MultinomialProgram(r,o,t),i=this.makeOutputArray(a.outputShape,\"int32\"),s=a.getCustomSetupFunc(n);return this.compileAndRun(a,[e],i,s)},e.prototype.oneHot=function(e,t,n,r){var o=new P.OneHotProgram(e.size,t,n,r);return this.compileAndRun(o,[e])},e.prototype.makeOutputArray=function(e,t){return l.Tensor.make(e,{},t)},e.prototype.compileAndRun=function(e,t,n,r){var o=this;null==n&&(n=this.makeOutputArray(e.outputShape,t[0].dtype));var a=t.map(function(e){return o.uploadToGPU(e.dataId),{tensor:e,texData:o.texData.get(e.dataId)}});this.uploadToGPU(n.dataId);var i,s={tensor:n,texData:this.texData.get(n.dataId)},u=O.makeShaderKey(e,a,s),c=this.getAndSaveBinary(u,function(){return O.compileProgram(o.gpgpu,e,a,s)}),l=null!=this.activeTimers;return l&&(i=this.startTimer()),O.runProgram(c,a,s,r),l&&(i=this.endTimer(i),this.activeTimers.push(this.getQueryTime(i))),n},e.prototype.getAndSaveBinary=function(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]},e.prototype.getTextureManager=function(){return this.textureManager},e.prototype.dispose=function(){if(!this.disposed){for(var e in this.binaryCache)this.gpgpu.deleteProgram(this.binaryCache[e].webGLProgram);this.textureManager.dispose(),this.canvas.remove(),this.gpgpuCreatedLocally&&this.gpgpu.dispose(),this.disposed=!0}},e.prototype.throwIfNoData=function(e){if(!this.texData.has(e))throw new Error(\"WebGL backend: No data found for this tensor. Did you change your backend in the middle of the program? New backends can't use Tensors created with previous backends\")},e.prototype.uploadToGPU=function(e){this.throwIfNoData(e);var t=this.texData.get(e),n=t.shape,r=t.values,o=t.texture,a=t.dtype,i=t.texType;if(null==o){var s,u=null!=this.activeTimers;u&&(s=performance.now());var c=W.getTextureShapeFromLogicalShape(this.gpgpu.gl,n);t.texShape=c;var l=this.textureManager.acquireTexture(c,i);t.texture=l,null!=r&&(this.gpgpu.uploadMatrixToTexture(l,c[0],c[1],function(e,t){if(e instanceof Float32Array)return e;for(var n=new Float32Array(e.length),r=0;r<n.length;r++){var o=e[r];n[r]=h.isValNaN(o,t)?NaN:o}return n}(r,a)),t.values=null,u&&(this.uploadWaitMs+=performance.now()-s))}},e.prototype.cacheOnCPU=function(e,t){var n=this.delayedStorage,r=this.texData.get(e),o=r.texture,a=r.texShape,i=r.dtype,s=r.texType;n&&null!=o&&(this.textureManager.releaseTexture(o,a,s),r.texture=null,r.texShape=null),null!=t&&(r.values=function(e,t){if(\"float32\"===t)return e;if(\"int32\"===t||\"bool\"===t){for(var n=\"int32\"===t?new Int32Array(e.length):new Uint8Array(e.length),r=0;r<n.length;++r){var o=e[r];o=isNaN(o)?h.getNaN(t):Math.round(o),n[r]=o}return n}throw new Error(\"Unknown dtype \"+t)}(t,i))},e}();t.MathBackendWebGL=X,i.ENV.registerBackend(\"webgl\",function(){return new X});var K=function(e){function t(t,n){void 0===n&&(n=!1);return console.warn(\"new NDArrayMathGPU() is deprecated. Please use dl.setBackend('webgl').\"),e.call(this,new X(t),n)||this}return r(t,e),t.prototype.getGPGPUContext=function(){return this.engine.backend.getGPGPUContext()},t.prototype.getTextureManager=function(){return this.engine.backend.getTextureManager()},t}(s.NDArrayMath);t.NDArrayMathGPU=K},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(12),o=\"\\n  if (isNaN(a)) return a;\\n  if (isNaN(b)) return b;\\n\";t.ADD=\"return a + b;\",t.SUB=\"return a - b;\",t.MUL=\"return a * b;\",t.DIV=\"return a / b;\",t.POW=\"\\n  return (round(mod(b, 2.0)) == 0 || round(mod(b, 2.0)) == 2) ?\\n      pow(abs(a), b) : sign(a) * pow(abs(a), b);\\n\",t.EQUAL=o+\"\\n  return float(a == b);\\n\",t.NOT_EQUAL=o+\"\\n  return float(a != b);\\n\",t.LESS=o+\"\\n  return float(a < b);\\n\",t.LESS_EQUAL=o+\"\\n  return float(a <= b);\\n\",t.GREATER=o+\"\\n  return float(a > b);\\n\",t.GREATER_EQUAL=o+\"\\n  return float(a >= b);\\n\",t.LOGICAL_AND=o+\"\\n  return float(a >= 1.0 && b >= 1.0);\\n\",t.LOGICAL_OR=o+\"\\n  return float(a >= 1.0 || b >= 1.0);\\n\",t.LOGICAL_XOR=o+\"\\n  return float(a >= 1.0 ^^ b >= 1.0);\\n\",t.PRELU=\"\\n  return (a >= 0.0) ? a : b * a;\\n\",t.PRELU_DER=\"\\n  return (a > 0.0) ? 1.0 : ((a < 0.0) ? b : a);\\n\",t.MAX=o+\"\\n  return max(a, b);\\n\",t.MIN=o+\"\\n  return min(a, b);\\n\";var a=function(){return function(e,t,n){this.variableNames=[\"A\",\"B\"],this.supportsBroadcasting=!0,this.outputShape=r.assertAndGetBroadcastShape(t,n),this.userCode=\"\\n      float binaryOperation(float a, float b) {\\n        \"+e+\"\\n      }\\n\\n      void main() {\\n        float a = getAAtOutCoords();\\n        float b = getBAtOutCoords();\\n        setOutput(binaryOperation(a, b));\\n      }\\n    \"}}();t.BinaryOpProgram=a},function(e,t,n){\"use strict\";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(1),i=n(0),s=n(66),u=n(21),c=n(26),l=function(){function e(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.autoDebugValidate=!1,this.gl=null!=e?e:s.createWebGLContext(),1===a.ENV.get(\"WEBGL_VERSION\")?(this.textureFloatExtension=c.getExtensionOrThrow(this.gl,\"OES_texture_float\"),this.colorBufferFloatExtension=this.gl.getExtension(\"WEBGL_color_buffer_float\")):this.colorBufferFloatExtension=c.getExtensionOrThrow(this.gl,\"EXT_color_buffer_float\"),this.loseContextExtension=c.getExtensionOrThrow(this.gl,\"WEBGL_lose_context\"),a.ENV.get(\"WEBGL_GET_BUFFER_SUB_DATA_ASYNC_EXTENSION_ENABLED\")&&(this.getBufferSubDataAsyncExtension=this.gl.getExtension(\"WEBGL_get_buffer_sub_data_async\")),this.vertexBuffer=s.createVertexBuffer(this.gl),this.indexBuffer=s.createIndexBuffer(this.gl),this.framebuffer=c.createFramebuffer(this.gl)}return e.prototype.dispose=function(){var e=this;if(!this.disposed){null!=this.program&&console.warn(\"Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing.\"),null!=this.outputTexture&&console.warn(\"Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.\");var t=this.gl;c.callAndCheck(t,function(){return t.finish()}),c.callAndCheck(t,function(){return t.bindFramebuffer(t.FRAMEBUFFER,null)}),c.callAndCheck(t,function(){return t.deleteFramebuffer(e.framebuffer)}),c.callAndCheck(t,function(){return t.bindBuffer(t.ARRAY_BUFFER,null)}),c.callAndCheck(t,function(){return t.deleteBuffer(e.vertexBuffer)}),c.callAndCheck(t,function(){return t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null)}),c.callAndCheck(t,function(){return t.deleteBuffer(e.indexBuffer)}),this.loseContextExtension.loseContext(),this.disposed=!0}},e.prototype.enableAutomaticDebugValidation=function(e){this.autoDebugValidate=e,c.enableDebugWebGLErrorChecking(e)},e.prototype.createMatrixTexture=function(e,t){return this.throwIfDisposed(),s.createMatrixTexture(this.gl,e,t)},e.prototype.uploadPixelDataToTexture=function(e,t){this.throwIfDisposed(),s.uploadPixelDataToTexture(this.gl,e,t)},e.prototype.createPackedMatrixTexture=function(e,t){return this.throwIfDisposed(),s.createPackedMatrixTexture(this.gl,e,t)},e.prototype.deleteMatrixTexture=function(e){var t=this;this.throwIfDisposed(),this.outputTexture===e&&(c.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer),this.outputTexture=null),c.callAndCheck(this.gl,function(){return t.gl.deleteTexture(e)})},e.prototype.uploadMatrixToTexture=function(e,t,n,r){this.throwIfDisposed();return s.uploadMatrixToTexture(this.gl,e,t,n,r,1)},e.prototype.uploadMatrixToPackedTexture=function(e,t,n,r){return this.throwIfDisposed(),s.uploadMatrixToPackedTexture(this.gl,e,t,n,r)},e.prototype.downloadMatrixFromTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return s.downloadMatrixFromOutputTexture(r.gl,t,n)})},e.prototype.downloadMatrixFromTextureAsync=function(e,t,n){return r(this,void 0,void 0,function(){var r=this;return o(this,function(o){if(null==this.getBufferSubDataAsyncExtension)throw new Error(\"Cannot download matrix from output texture asynchronously, WEBGL_get_buffer_sub_data_async is not enabled.\");return[2,this.downloadMatrixDriverAsync(e,function(){return s.downloadMatrixFromOutputTextureAsync(r.gl,r.getBufferSubDataAsyncExtension,t,n)})]})})},e.prototype.downloadMatrixFromRGBAColorTexture=function(e,t,n,r){var o=this;return this.downloadMatrixDriver(e,function(){return s.downloadMatrixFromRGBAColorTexture(o.gl,t,n,r)})},e.prototype.downloadMatrixFromPackedTexture=function(e,t,n){var r=this;return this.downloadMatrixDriver(e,function(){return s.downloadMatrixFromPackedOutputTexture(r.gl,t,n)})},e.prototype.createProgram=function(e){this.throwIfDisposed();var t=this.gl,n=c.createFragmentShader(t,e),r=s.createVertexShader(t),o=c.createProgram(t);return c.callAndCheck(t,function(){return t.attachShader(o,r)}),c.callAndCheck(t,function(){return t.attachShader(o,n)}),c.linkProgram(t,o),this.autoDebugValidate&&c.validateProgram(t,o),o},e.prototype.deleteProgram=function(e){var t=this;this.throwIfDisposed(),e===this.program&&(this.program=null),null!=e&&c.callAndCheck(this.gl,function(){return t.gl.deleteProgram(e)})},e.prototype.setProgram=function(e){var t=this;this.throwIfDisposed(),this.program=e,null!=this.program&&this.autoDebugValidate&&c.validateProgram(this.gl,this.program),c.callAndCheck(this.gl,function(){return t.gl.useProgram(e)})},e.prototype.getUniformLocation=function(e,t,n){return void 0===n&&(n=!0),this.throwIfDisposed(),n?c.getProgramUniformLocationOrThrow(this.gl,e,t):c.getProgramUniformLocation(this.gl,e,t)},e.prototype.getAttributeLocation=function(e,t){var n=this;return this.throwIfDisposed(),c.callAndCheck(this.gl,function(){return n.gl.getAttribLocation(e,t)})},e.prototype.getUniformLocationNoThrow=function(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)},e.prototype.setInputMatrixTexture=function(e,t,n){this.throwIfDisposed(),this.throwIfNoProgram(),c.bindTextureToProgramUniformSampler(this.gl,this.program,e,t,n)},e.prototype.setOutputMatrixTexture=function(e,t,n){this.setOutputMatrixTextureDriver(e,n,t)},e.prototype.setOutputPackedMatrixTexture=function(e,t,n){this.throwIfDisposed();var r=u.getPackedMatrixTextureShapeWidthHeight(t,n),o=r[0],a=r[1];this.setOutputMatrixTextureDriver(e,o,a)},e.prototype.setOutputMatrixWriteRegion=function(e,t,n,r){this.setOutputMatrixWriteRegionDriver(n,e,r,t)},e.prototype.setOutputPackedMatrixWriteRegion=function(e,t,n,r){throw new Error(\"setOutputPackedMatrixWriteRegion not implemented.\")},e.prototype.debugValidate=function(){null!=this.program&&c.validateProgram(this.gl,this.program),c.validateFramebuffer(this.gl)},e.prototype.executeProgram=function(e){this.throwIfDisposed(),this.throwIfNoProgram();var t=this.gl;s.bindVertexProgramAttributeStreams(t,this.program,this.vertexBuffer,e),this.autoDebugValidate&&this.debugValidate(),c.callAndCheck(t,function(){return t.drawElements(t.TRIANGLES,6,t.UNSIGNED_SHORT,0)})},e.prototype.blockUntilAllProgramsCompleted=function(){var e=this;this.throwIfDisposed(),c.callAndCheck(this.gl,function(){return e.gl.finish()})},e.prototype.getQueryTimerExtension=function(){return null==this.disjointQueryTimerExtension&&(this.disjointQueryTimerExtension=c.getExtensionOrThrow(this.gl,2===a.ENV.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")?\"EXT_disjoint_timer_query_webgl2\":\"EXT_disjoint_timer_query\")),this.disjointQueryTimerExtension},e.prototype.getQueryTimerExtensionWebGL2=function(){return this.getQueryTimerExtension()},e.prototype.getQueryTimerExtensionWebGL1=function(){return this.getQueryTimerExtension()},e.prototype.runQuery=function(e){var t=this.beginQuery();return e(),this.endQuery(),this.pollQueryTime(t)},e.prototype.beginQuery=function(){if(2===a.ENV.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2(),n=e.createQuery();return e.beginQuery(t.TIME_ELAPSED_EXT,n),n}n=(t=this.getQueryTimerExtensionWebGL1()).createQueryEXT();return t.beginQueryEXT(t.TIME_ELAPSED_EXT,n),n},e.prototype.endQuery=function(){if(2===a.ENV.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\")){var e=this.gl,t=this.getQueryTimerExtensionWebGL2();e.endQuery(t.TIME_ELAPSED_EXT)}else{(t=this.getQueryTimerExtensionWebGL1()).endQueryEXT(t.TIME_ELAPSED_EXT)}},e.prototype.isQueryAvailable=function(e,t){if(0===t)return!0;if(2===t){var n=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=n.getQueryParameter(e,n.QUERY_RESULT_AVAILABLE),a=this.gl.getParameter(r.GPU_DISJOINT_EXT);return o&&!a}o=(r=this.getQueryTimerExtensionWebGL1()).getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT),a=this.gl.getParameter(r.GPU_DISJOINT_EXT);return o&&!a},e.prototype.pollQueryTime=function(e){var t=this;return new Promise(function(n,r){var o=a.ENV.get(\"WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION\");i.repeatedTry(function(){return t.isQueryAvailable(e,o)}).then(function(){return n(t.getQueryTime(e,o))}).catch(function(){console.warn(\"Disjoint query timer never available.\"),n(-1)})})},e.prototype.getQueryTime=function(e,t){if(0===t)return null;if(2===t){var n=this.gl;return n.getQueryParameter(e,n.QUERY_RESULT)/1e6}var r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6},e.prototype.downloadMatrixDriverSetup=function(e){this.throwIfDisposed(),c.bindColorTextureToFramebuffer(this.gl,e,this.framebuffer),this.autoDebugValidate&&c.validateFramebuffer(this.gl)},e.prototype.downloadMatrixDriverTeardown=function(){null!=this.outputTexture?(c.bindColorTextureToFramebuffer(this.gl,this.outputTexture,this.framebuffer),this.autoDebugValidate&&c.validateFramebuffer(this.gl)):c.unbindColorTextureFromFramebuffer(this.gl,this.framebuffer)},e.prototype.downloadMatrixDriver=function(e,t){this.downloadMatrixDriverSetup(e);var n=t();return this.downloadMatrixDriverTeardown(),n},e.prototype.downloadMatrixDriverAsync=function(e,t){return r(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return this.downloadMatrixDriverSetup(e),[4,t()];case 1:return n=r.sent(),this.downloadMatrixDriverTeardown(),[2,n]}})})},e.prototype.setOutputMatrixTextureDriver=function(e,t,n){this.throwIfDisposed();var r=this.gl;c.bindColorTextureToFramebuffer(r,e,this.framebuffer),this.autoDebugValidate&&c.validateFramebuffer(r),this.outputTexture=e,c.callAndCheck(r,function(){return r.viewport(0,0,t,n)}),c.callAndCheck(r,function(){return r.scissor(0,0,t,n)})},e.prototype.setOutputMatrixWriteRegionDriver=function(e,t,n,r){var o=this;this.throwIfDisposed(),c.callAndCheck(this.gl,function(){return o.gl.scissor(e,t,n,r)})},e.prototype.throwIfDisposed=function(){if(this.disposed)throw new Error(\"Attempted to use disposed GPGPUContext.\")},e.prototype.throwIfNoProgram=function(){if(null==this.program)throw new Error(\"No GPU program is currently set.\")},e}();t.GPGPUContext=l},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(29),o=function(){return function(e,t){this.variableNames=[\"A\"],this.outputShape=e,this.userCode=\"\\n      float unaryOperation(float x) {\\n        \"+t+\"\\n      }\\n\\n      void main() {\\n        float x = getAAtOutCoords();\\n        float y = unaryOperation(x);\\n\\n        setOutput(y);\\n      }\\n    \"}}();t.UnaryOpProgram=o;var a=\"\\n  if (isNaN(x)) return x;\\n\";t.ABS=\"\\n  return abs(x);\\n\",t.RELU=a+\"\\n  return (x < 0.0) ? 0.0 : x;\\n\",t.ELU=\"\\n  return (x >= 0.0) ? x : (exp(x) - 1.0);\\n\",t.ELU_DER=\"\\n  return (x >= 0.0) ? 1.0 : exp(x);\\n\",t.SELU=\"\\n  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.\\n  // see: https://arxiv.org/abs/1706.02515\\n  float scaleAlpha = \"+r.SELU_SCALEALPHA+\";\\n  float scale = \"+r.SELU_SCALE+\";\\n  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);\\n\",t.LEAKY_RELU=function(e){return\"\\n    return (x >= 0.0) ? x : \"+e+\" * x;\\n  \"},t.STEP=function(e){return void 0===e&&(e=0),a+\"\\n    return x > 0.0 ? 1.0 : float(\"+e+\");\\n  \"},t.NEG=\"\\n  return -x;\\n\",t.CEIL=\"\\n  return ceil(x);\\n\",t.FLOOR=\"\\n  return floor(x);\\n\",t.EXP=\"\\n  return exp(x);\\n\",t.LOG=\"\\n  return log(x);\\n\",t.SQRT=a+\"\\n  return sqrt(x);\\n\",t.SIGMOID=\"\\n  return 1.0 / (1.0 + exp(-1.0 * x));\\n\",t.SIN=a+\"\\n  return sin(x);\\n\",t.COS=a+\"\\n  return cos(x);\\n\",t.TAN=\"\\n  return tan(x);\\n\",t.ASIN=a+\"\\n  return asin(x);\\n\",t.ACOS=a+\"\\n  return acos(x);\\n\",t.ATAN=a+\"\\n  return atan(x);\\n\",t.SINH=\"\\n  float e2x = exp(x);\\n  return (e2x - 1.0 / e2x) / 2.0;\\n\",t.COSH=\"\\n  float e2x = exp(-x);\\n  return (e2x + 1.0 / e2x) / 2.0;\\n\",t.TANH=\"\\n  float e2x = exp(-2.0 * abs(x));\\n  return sign(x) * (1.0 - e2x) / (1.0 + e2x);\\n\",t.SQUARE=\"\\n  return x * x;\\n\",t.LOGICAL_NOT=a+\"\\n  return float(!(x >= 1.0));\\n\",t.TO_INT=\"\\n  return float(int(x));\\n\"},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(5),o=function(){function e(e,t,n){void 0===e&&(e=1),void 0===t&&(t=\"fan_in\"),void 0===n&&(n=\"normal\"),this.scale=e,this.mode=t,this.distribution=n}return e.prototype.initialize=function(e,t,n){var o=0;if(\"fan_in\"===this.mode)o=t;else if(\"fan_out\"===this.mode)o=n;else{if(\"fan_avg\"!==this.mode)throw new Error(\"Unexpected mode for variance scaling initializer: \"+this.mode);o=(t+n)/2}if(\"normal\"===this.distribution)return r.truncatedNormal(e,0,Math.sqrt(this.scale/o));if(\"uniform\"===this.distribution)return r.randomUniform(e,0,Math.sqrt(3*this.scale/o));throw new Error(\"Unexpected distribution for variance scaling initializer: \"+this.distribution)},e}();t.VarianceScalingInitializer=o;var a=function(){function e(){}return e.prototype.initialize=function(e,t,n){return r.zeros(e)},e}();t.ZerosInitializer=a;var i=function(){function e(){}return e.prototype.initialize=function(e,t,n){return r.ones(e)},e}();t.OnesInitializer=i;var s=function(){function e(e){void 0===e&&(e=0),this.value=e}return e.prototype.initialize=function(e,t,n){return r.fill(e,this.value)},e}();t.ConstantInitializer=s;var u=function(){function e(e){this.tensor=e}return e.prototype.initialize=function(e,t,n){return this.tensor},e}();t.TensorInitializer=u;var c=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=.05),this.mean=e,this.stdev=t}return e.prototype.initialize=function(e,t,n){return r.randomNormal(e,this.mean,this.stdev)},e}();t.RandomNormalInitializer=c;var l=function(){function e(e,t){void 0===e&&(e=0),void 0===t&&(t=.05),this.mean=e,this.stdev=t}return e.prototype.initialize=function(e,t,n){return r.truncatedNormal(e,this.mean,this.stdev)},e}();t.RandomTruncatedNormalInitializer=l;var p=function(){function e(e,t){void 0===e&&(e=-.05),void 0===t&&(t=.05),this.minval=e,this.maxval=t}return e.prototype.initialize=function(e,t,n){return r.randomUniform(e,this.minval,this.maxval)},e}();t.RandomUniformInitializer=p},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r,o=n(3),a=n(2),i=n(0),s=n(138),u=n(30),c=n(10),l=function(){return function(e){var t=this;this.dict={},e&&e.forEach(function(e){return t.dict[e.tensor.id]=e})}}();t.FeedDictionary=l,function(e){e[e.NONE=0]=\"NONE\",e[e.SUM=1]=\"SUM\",e[e.MEAN=2]=\"MEAN\"}(r=t.CostReduction||(t.CostReduction={}));var p=function(){function e(e,t){this.math=t,this.activationArrayMap=new c.TensorArrayMap,this.runtimeCache={},this.oneScalar=a.Scalar.new(1),this.gradientArrayMap=new c.SummedTensorArrayMap(this.math)}return e.prototype.dispose=function(){var e=this;this.activationArrayMap.dispose(),Object.keys(this.runtimeCache).forEach(function(t){var n=e.runtimeCache[t];n.operations&&n.operations.forEach(function(e){return e.dispose()})}),this.runtimeCache={},null!=this.batchSizeScalar&&this.batchSizeScalar.dispose(),this.oneScalar.dispose()},e.prototype.evalAll=function(e,t){var n=this;return o.tidy(function(){var r=new l(t),o=n.getOrCreateRuntime(e,r),a=n.activationArrayMap;u.disposeAndInitializeOperationOutputs(o.nodes,a),u.disposeTransientOperationArrays(o.operations,n.activationArrayMap,n.gradientArrayMap),u.addPersistentArraysToTensorArrayMap(o.nodes,a),u.loadInputsFromFeedDictionaryToTensorArrayMap(r,a,n.math),o.operations.forEach(function(e){return e.feedForward(n.math,a)});var i=e.map(function(e){return a.get(e)});return e.forEach(function(e){return a.delete(e)}),u.releaseFeedDictionaryInputsFromTensorArrayMap(r,a,n.math),i})},e.prototype.eval=function(e,t){return this.evalAll([e],t)[0]},e.prototype.train=function(e,t,n,s,c){var p=this;void 0===c&&(c=r.NONE),i.assert(i.isScalarShape(e.shape),\"Cost tensor for training must be a scalar value.\"),this.prevBatchSize!==n&&(this.prevBatchSize=n,null!=this.batchSizeScalar&&this.batchSizeScalar.dispose(),this.batchSizeScalar=this.math.keep(a.Scalar.new(n)));var h=new l(t);u.throwIfFeedDictionaryContainsNDArrays(h);var d=this.getOrCreateRuntime([e],h),f=d.operations,m=d.operations.slice().reverse(),v=this.activationArrayMap,g=this.gradientArrayMap;return g.nullify(e),g.add(e,this.oneScalar),u.addPersistentArraysToTensorArrayMap(d.nodes,v),s.beforeBatch(this.math,n,d,v,g),o.tidy(function(){for(var t=a.Scalar.new(0),r=0;r<n;++r)u.disposeAndInitializeOperationOutputs(d.nodes,v),u.disposeAndInitializeOperationInputGradients(d.nodes,g),u.disposeTransientOperationArrays(d.operations,v,g),u.loadInputsFromFeedDictionaryToTensorArrayMap(h,v,p.math),f.forEach(function(e){return e.feedForward(p.math,v)}),m.forEach(function(e){return e.backProp(p.math,v,g)}),s.afterExample(p.math,d,v,g),u.releaseFeedDictionaryInputsFromTensorArrayMap(h,v,p.math),t=p.updateCostForExample(t,v.get(e),c);return s.afterBatch(p.math,n,d,v,g),p.updateCostForBatch(t,c)})},e.prototype.updateCostForExample=function(e,t,n){return n===r.MEAN||n===r.SUM?this.math.add(e,t):e},e.prototype.updateCostForBatch=function(e,t){return t===r.MEAN?this.math.divide(e,this.batchSizeScalar):e},e.prototype.getOrCreateRuntime=function(e,t){var n=this.makeRuntimeCacheKey(e,t),r=this.runtimeCache[n];if(void 0===r){var o=u.getOrderedEvaluationSetFromEvalTensor(e,t);u.removeFeedDictionaryNodesFromEvaluationSet(t,o),u.throwErrorIfEvaluationSetContainsPlaceholderNodes(o),r={nodes:o,operations:s.emitFromGraphNodes(o)},this.runtimeCache[n]=r}return r},e.prototype.makeRuntimeCacheKey=function(e,t){return e.map(function(e){return e.id}).sort().join(\"_\")+\"__\"+Object.keys(t.dict).sort().join(\"_\")},e}();t.Session=p},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.defaultCompare=function(e,t){return e===t?0:e<t?-1:1};var r=function(){function e(e,t){this.comparator=e,this.indexObserver=t,this.heap=[]}return e.prototype.enqueue=function(e){this.heap.push(e),this.onIndexChanged(e,this.heap.length-1),this.siftUp(this.heap.length-1)},e.prototype.dequeue=function(){if(this.empty())throw new Error(\"dequeue called on empty priority queue.\");var e=this.heap[0];return this.swap(0,this.heap.length-1),this.heap.pop(),this.siftDown(0),e},e.prototype.update=function(e,t){var n=t===this.heap.length-1;n||this.swap(t,this.heap.length-1),this.heap.pop(),n||(-1!==this.siftUpIndex(t)?this.siftUp(t):-1!==this.siftDownIndex(t)&&this.siftDown(t)),this.enqueue(e)},e.prototype.empty=function(){return 0===this.heap.length},e.prototype.onIndexChanged=function(e,t){this.indexObserver&&this.indexObserver(e,t)},e.prototype.getParentIndex=function(e){return 0===e?-1:Math.floor((e-1)/2)},e.prototype.getLeftChildIndex=function(e){var t=2*e+1;return t<this.heap.length?t:-1},e.prototype.getRightChildIndex=function(e){var t=2*e+2;return t<this.heap.length?t:-1},e.prototype.siftUpIndex=function(e){var t=this.getParentIndex(e);return-1===t?-1:this.compare(t,e)>0?t:-1},e.prototype.siftUp=function(e){for(var t=this.siftUpIndex(e);-1!==t;)this.swap(e,t),e=t,t=this.siftUpIndex(e)},e.prototype.siftDownIndex=function(e){if(e>=this.heap.length)return-1;var t=e,n=this.getLeftChildIndex(e);-1!==n&&this.compare(n,t)<0&&(t=n);var r=this.getRightChildIndex(e);return-1!==r&&this.compare(r,t)<0&&(t=r),t===e?-1:t},e.prototype.siftDown=function(e){for(var t=this.siftDownIndex(e);-1!==t;)this.swap(e,t),e=t,t=this.siftDownIndex(e)},e.prototype.compare=function(e,t){return this.comparator(this.heap[e],this.heap[t])},e.prototype.swap=function(e,t){var n=this.heap[e];this.heap[e]=this.heap[t],this.heap[t]=n,this.onIndexChanged(this.heap[e],e),this.onIndexChanged(this.heap[t],t)},e}();t.PriorityQueue=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(78);t.KNNImageClassifier=r.KNNImageClassifier},function(e,t,n){n(77),e.exports=n(166)},function(e,t,n){\"use strict\";n.r(t);var r=n(75),o=n(23);!function(){var e=new Error(\"Cannot find module '@tensorflow-models/mobilenet'\");throw e.code=\"MODULE_NOT_FOUND\",e}();const a=227,i=227,s=10,u=.98;var c=[\"클로바\",\"안녕\",\"어때?\"],l=[\"안녕\"];class p{constructor(){this.modalWindow=document.getElementById(\"launchModal\"),this.closeBtn=document.getElementById(\"close-modal\"),this.closeBtn.addEventListener(\"click\",e=>{this.modalWindow.style.display=\"none\"}),window.addEventListener(\"click\",e=>{e.target==this.modalWindow&&(this.modalWindow.style.display=\"none\")}),this.modalWindow.style.display=\"block\",this.modalWindow.style.zIndex=500}}class h{constructor(){this.synth=window.speechSynthesis,this.voices=[],this.pitch=1,this.rate=1,this.textLine=document.getElementById(\"text\"),this.ansText=document.getElementById(\"answerText\"),this.loader=document.getElementById(\"loader\"),this.lang=\"ko-KR\",this.selectedVoice=48,this.currentPredictedWords=[],this.waitTimeForQuery=5e3,this.synth.onvoiceschanged=(()=>{this.populateVoiceList()})}populateVoiceList(){\"undefined\"!=typeof speechSynthesis?this.voices=this.synth.getVoices():console.log(\"no synth\")}clearPara(e){this.textLine.innerText=\"\",this.ansText.innerText=\"\",e?this.loader.style.display=\"block\":(this.loader.style.display=\"none\",this.ansText.innerText=\"No query detected\",f.previousPrediction=-1),this.currentPredictedWords=[]}speak(e){if(\"클로바\"==e&&(console.log(\"clear para\"),this.clearPara(!0),setTimeout(()=>{1==this.currentPredictedWords.length&&this.clearPara(!1)},this.waitTimeForQuery)),\"클로바\"!=e&&0==this.currentPredictedWords.length)return console.log(\"첫 단어는 클로바여야 합니다\"),void console.log(e);if(this.currentPredictedWords.includes(e))console.log(\"word already been detected in current phrase\");else{this.currentPredictedWords.push(e),this.textLine.innerText+=\" \"+e;var t=new SpeechSynthesisUtterance(e);t.onend=(t=>{if(l.includes(e)){console.log(\"this was the last word\"),f.setStatusText(\"Status: Waiting for Response\");new d}}),t.onerror=(e=>{console.log(\"Error speaking\")}),t.lang=\"ko-KR\",t.pitch=this.pitch,t.rate=this.rate,this.synth.speak(t)}}}class d{constructor(){this.interimTextLine=document.getElementById(\"interimText\"),this.textLine=document.getElementById(\"answerText\"),this.loader=document.getElementById(\"loader\"),this.finalTranscript=\"\",this.recognizing=!1,this.recognition=new webkitSpeechRecognition,this.recognition.continuous=!0,this.recognition.interimResults=!0,this.recognition.lang=\"ko-KR\",this.cutOffTime=15e3,this.recognition.onstart=(()=>{this.recognizing=!0,console.log(\"started recognizing\"),f.setStatusText(\"Status: Transcribing\")}),this.recognition.onerror=(e=>{console.log(e+\" recogn error\")}),this.recognition.onend=(()=>{console.log(\"stopped recognizing\"),0==this.finalTranscript.length&&this.type(\"No response detected\"),this.recognizing=!1,f.setStatusText(\"Status: Finished Transcribing\"),setTimeout(()=>{f.startPredicting()},1e3)}),this.recognition.onresult=(e=>{var t=\"\";if(void 0!==e.results){for(var n=e.resultIndex;n<e.results.length;++n)e.results[n].isFinal?this.finalTranscript+=e.results[n][0].transcript:t+=e.results[n][0].transcript;this.interimType(t),this.type(this.finalTranscript)}}),setTimeout(()=>{this.startListening()},0),setTimeout(()=>{this.stopListening()},this.cutOffTime)}startListening(){this.recognizing?this.recognition.stop():(console.log(\"listening\"),f.pausePredicting(),this.recognition.start())}stopListening(){if(console.log(\"STOP LISTENING\"),this.recognizing)return console.log(\"stop speech to text\"),this.recognition.stop(),void f.startPredicting()}interimType(e){this.loader.style.display=\"none\",this.interimTextLine.innerText=e}type(e){this.loader.style.display=\"none\",this.textLine.innerText=e}}var f=null;window.addEventListener(\"load\",()=>{var e=navigator.userAgent.toLowerCase();-1!=e.indexOf(\"chrome\")||-1!=e.indexOf(\"firefox\")?f=new class{constructor(){this.infoTexts=[],this.training=-1,this.videoPlaying=!1,this.previousPrediction=-1,this.currentPredictedWords=[],this.now,this.then=Date.now(),this.startTime=this.then,this.fps=5,this.fpsInterval=1e3/this.fps,this.elapsed=0,this.trainingListDiv=document.getElementById(\"training-list\"),this.exampleListDiv=document.getElementById(\"example-list\"),this.knn=null,this.mobilenet,this.textLine=document.getElementById(\"text\"),this.video=document.getElementById(\"video\"),this.addWordForm=document.getElementById(\"add-word\"),this.statusText=document.getElementById(\"status-text\"),this.video.addEventListener(\"mousedown\",()=>{f.pausePredicting(),this.trainingListDiv.style.display=\"block\"}),this.addWordForm.addEventListener(\"submit\",e=>{e.preventDefault();let t=document.getElementById(\"new-word\").value.trim().toLowerCase(),n=document.getElementById(\"is-terminal-word\");t&&!c.includes(t)?(c.splice(c.length-1,0,t),this.createButtonList(!1),this.updateExampleCount(),n.checked&&l.push(t),document.getElementById(\"new-word\").value=\"\",n.checked=!1):alert(\"벌써 입력한 단어거나 단어를 입력하지 않았습니다.\")}),new p,this.updateExampleCount(),document.getElementById(\"status\").style.display=\"none\",this.createTrainingBtn(),this.createButtonList(!1),this.tts=new h}createPredictBtn(){var e=document.getElementById(\"action-btn\");e.innerHTML=\"\";const t=document.createElement(\"button\");t.innerText=\"예측하기 >>>\",e.appendChild(t),t.addEventListener(\"mousedown\",()=>{console.log(\"start predicting\");const e=this.knn.getClassExampleCount();if(Math.max(...e)>0){if(0==e[0])return void alert(\"호출어 (클로바)의 예시를 추가하지 않았습니다. 예시를 추가해주세요.\");if(0==e[c.length-1])return void alert(\"[그 외]의 예시를 추가하지 않았습니다. 두 손을 내리고 쉬고있는 자세의 예시를 추가해주세요\");if(!this.areTerminalWordsTrained(e))return void alert(` 맺음말의 예시를 추가하지 않았습니다. 맺음말: ${l} 의 예시를 추가해주세`);this.trainingListDiv.style.display=\"none\",this.textLine.classList.remove(\"intro-steps\"),this.textLine.innerText=\"무엇을 도와드릴까요?\",this.startPredicting()}else alert(\"단어의 예시를 더하지 않았습니다. 각 단어별로 [예시 더하기] 버튼을 누른 상태로 예시를 더해주세요.\")})}createTrainingBtn(){var e=document.getElementById(\"action-btn\");e.innerHTML=\"\";const t=document.createElement(\"button\");t.innerText=\"학습시키기 >>\",e.appendChild(t),t.addEventListener(\"mousedown\",()=>{if(c.length>3&&1==l.length)return console.log(\"no terminal word added\"),void alert(\"맺음말을 더하지 않았습니다. \\n 맺음말을 더해서 문장이 언제 끝나는지 알려주세요.\");if(3==c.length&&1==l.length&&!confirm(\"다른 단어를 더하지 않았습니다. 지금 할 수 있는 명령은 클로바 어때? 밖에 없습니다. \\n 단어를 더 더해서 다양한 명령을 만들어 보세요 :) \"))return;this.startWebcam(),console.log(\"ready to train\"),this.createButtonList(!0),this.addWordForm.innerHTML=\"\";let e=document.createElement(\"p\");e.innerText=\" 각 단어 옆에있는 [예시 더하기] 버튼을 누른 상태로 단어에 해당하는 모션을 여러번 취해주세요. 각 단어당 적어도 30개 이상의 예시를 만들어주세요! \\n [그 외] 단어에는 두 손을 내리고 편하게 \\n      쉬고있는 자세를 취해주세요.\",this.addWordForm.appendChild(e),this.loadKNN(),this.createPredictBtn(),this.textLine.innerText=\"2 단계: 학습시키기\";let t=document.createElement(\"span\");t.innerHTML=\"<br/>단어와 모션을 연결할 시간입니다!\",t.classList.add(\"subtext\"),this.textLine.appendChild(t)})}areTerminalWordsTrained(e){for(var t=0,n=0;n<c.length;n++)l.includes(c[n])&&e[n]>0&&(t+=1);return t}startWebcam(){navigator.mediaDevices.getUserMedia({video:{facingMode:\"user\"},audio:!1}).then(e=>{this.video.srcObject=e,this.video.width=i,this.video.height=a,this.video.addEventListener(\"playing\",()=>this.videoPlaying=!0),this.video.addEventListener(\"paused\",()=>this.videoPlaying=!1)})}loadKNN(){this.knn=new r.KNNImageClassifier(c.length,s),this.mobilenet=!function(){var e=new Error(\"Cannot find module '@tensorflow-models/mobilenet'\");throw e.code=\"MODULE_NOT_FOUND\",e}()(),this.knn.load().then(()=>this.startTraining())}updateExampleCount(){document.getElementById(\"count\").innerText=`입력 단어: ${c.length} 개`}createButtonList(e){this.exampleListDiv.innerHTML=\"\";for(let t=0;t<c.length;t++)this.createButton(t,e)}createButton(e,t){const n=document.createElement(\"div\");this.exampleListDiv.appendChild(n),n.style.marginBottom=\"10px\";const r=document.createElement(\"span\");if(0!=e||t?e!=c.length-1||t?(r.innerText=c[e].toUpperCase()+\" \",r.style.fontWeight=\"bold\"):r.innerText=c[e].toUpperCase()+\" (그 외) \":r.innerText=c[e].toUpperCase()+\" (호출어) \",n.appendChild(r),t){const t=document.createElement(\"button\");t.innerText=\"예시 더하기\",n.appendChild(t),t.addEventListener(\"mousedown\",()=>this.training=e),t.addEventListener(\"mouseup\",()=>this.training=-1);const r=document.createElement(\"button\");r.innerText=\"예시 지우기\",n.appendChild(r),r.addEventListener(\"mousedown\",()=>{console.log(\"clear training data for this label\"),this.knn.clearClass(e),this.infoTexts[e].innerText=\" 0 개\"});const o=document.createElement(\"span\");o.innerText=\" 0 개\",n.appendChild(o),this.infoTexts.push(o)}}startTraining(){this.timer&&this.stopTraining();var e=this.video.play();void 0!==e&&e.then(e=>{console.log(\"Autoplay started\")}).catch(e=>{console.log(\"Autoplay prevented\")}),this.timer=requestAnimationFrame(this.train.bind(this))}stopTraining(){this.video.pause(),cancelAnimationFrame(this.timer)}train(){if(this.videoPlaying){const e=o.fromPixels(this.video);let t;const n=()=>mobilenet.infer(e,\"conv_preds\");-1!=this.training&&(t=n(),this.knn.addImage(t,this.training));const r=this.knn.getClassExampleCount();if(Math.max(...r)>0)for(let e=0;e<c.length;e++)r[e]>0&&(this.infoTexts[e].innerText=` ${r[e]} 개`)}this.timer=requestAnimationFrame(this.train.bind(this))}startPredicting(){this.timer&&this.stopTraining(),document.getElementById(\"status\").style.background=\"deepskyblue\",this.setStatusText(\"준비 됐습니다!\"),this.video.play(),this.pred=requestAnimationFrame(this.predict.bind(this))}pausePredicting(){console.log(\"pause predicting\"),this.setStatusText(\"Status: Paused Predicting\"),cancelAnimationFrame(this.pred)}predict(){if(this.now=Date.now(),this.elapsed=this.now-this.then,this.elapsed>this.fpsInterval&&(this.then=this.now-this.elapsed%this.fpsInterval,this.videoPlaying)){const e=this.knn.getClassExampleCount(),t=o.fromPixels(this.video);Math.max(...e)>0?this.knn.predictClass(t).then(e=>{for(let t=0;t<c.length;t++)e.classIndex==t&&e.confidences[t]>u&&e.classIndex!=this.previousPrediction&&e.classIndex!=c.length-1&&(this.tts.speak(c[t]),this.previousPrediction=e.classIndex)}).then(()=>t.dispose()):t.dispose()}this.pred=requestAnimationFrame(this.predict.bind(this))}setStatusText(e){document.getElementById(\"status\").style.display=\"block\",this.statusText.innerText=e}}:alert(\"Please visit in the latest Chrome or Firefox\")})},function(e,t,n){\"use strict\";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(23),i=n(161),s=n(165),u=function(){function e(e,t){this.numClasses=e,this.k=t,this.classLogitsMatrices=[],this.classExampleCount=[],this.varsLoaded=!1,this.squashLogitsDenominator=a.scalar(300);for(var n=0;n<this.numClasses;n++)this.classLogitsMatrices.push(null),this.classExampleCount.push(0);this.squeezeNet=new i.SqueezeNet}return e.prototype.load=function(){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.squeezeNet.load()];case 1:return e.sent(),this.varsLoaded=!0,[2]}})})},e.prototype.clearClass=function(e){e>=this.numClasses?console.log(\"Cannot clear invalid class ${classIndex}\"):(this.classLogitsMatrices[e]=null,this.classExampleCount[e]=0,this.clearTrainLogitsMatrix())},e.prototype.addImage=function(e,t){var n=this;this.varsLoaded?(t>=this.numClasses&&console.warn(\"Cannot add to invalid class ${classIndex}\"),this.clearTrainLogitsMatrix(),a.tidy(function(){var r=n.squeezeNet.predict(e),o=n.normalizeVector(r),i=o.shape[0];if(null==n.classLogitsMatrices[t])n.classLogitsMatrices[t]=o.as2D(1,i);else{var s=n.classLogitsMatrices[t].as2D(n.classExampleCount[t],i).concat(o.as2D(1,i),0);n.classLogitsMatrices[t].dispose(),n.classLogitsMatrices[t]=s}a.keep(n.classLogitsMatrices[t]),n.classExampleCount[t]++})):console.warn(\"Cannot add images until vars have been loaded.\")},e.prototype.predict=function(e){var t=this;if(!this.varsLoaded)throw new Error(\"Cannot predict until vars have been loaded.\");return a.tidy(function(){var n=t.squeezeNet.predict(e),r=t.normalizeVector(n),o=r.shape[0];if(null==t.trainLogitsMatrix){for(var i=null,s=0;s<t.numClasses;s++)i=t.concatWithNulls(i,t.classLogitsMatrices[s]);t.trainLogitsMatrix=i}if(null==t.trainLogitsMatrix)return console.warn(\"Cannot predict without providing training images.\"),null;a.keep(t.trainLogitsMatrix);var u=t.getNumExamples();return t.trainLogitsMatrix.as2D(u,o).matMul(r.as2D(o,1)).as1D()})},e.prototype.predictClass=function(e){return r(this,void 0,void 0,function(){var t,n,r,a,i,u,c,l,p,h,d,f,m,v,g,y;return o(this,function(o){switch(o.label){case 0:if(t=-1,n=new Array(this.numClasses),!this.varsLoaded)throw new Error(\"Cannot predict until vars have been loaded.\");return r=this.predict(e).asType(\"float32\"),a=this.getNumExamples(),i=Math.min(this.k,a),l=(c=s).topK,[4,r.data()];case 1:if(u=l.apply(c,[o.sent(),i]),r.dispose(),null==(p=u.indices))return[2,{classIndex:t,confidences:n}];for(h=[],d=[],g=0;g<this.numClasses;g++)d.push(0),f=this.classExampleCount[g],g>0&&(f+=h[g-1]),h.push(f);for(g=0;g<p.length;g++)for(m=0;m<h.length;m++)if(p[g]<h[m]){d[m]++;break}for(v=0,g=0;g<this.numClasses;g++)(y=d[g]/i)>v&&(v=y,t=g),n[g]=y;return[2,{classIndex:t,confidences:n}]}})})},e.prototype.getClassExampleCount=function(){return this.classExampleCount},e.prototype.getClassLogitsMatrices=function(){return this.classLogitsMatrices},e.prototype.setClassLogitsMatrices=function(e){this.classLogitsMatrices=e,this.classExampleCount=e.map(function(e){return null!=e?e.shape[0]:0}),this.clearTrainLogitsMatrix()},e.prototype.clearTrainLogitsMatrix=function(){null!=this.trainLogitsMatrix&&(this.trainLogitsMatrix.dispose(),this.trainLogitsMatrix=null)},e.prototype.concatWithNulls=function(e,t){return null==e&&null==t?null:null==e?t.clone():null===t?e.clone():e.concat(t,0)},e.prototype.normalizeVector=function(e){var t=a.div(e,this.squashLogitsDenominator),n=t.square().sum().sqrt();return a.div(t,n)},e.prototype.getNumExamples=function(){for(var e=0,t=0;t<this.classExampleCount.length;t++)e+=this.classExampleCount[t];return e},e.prototype.dispose=function(){this.squeezeNet.dispose(),this.clearTrainLogitsMatrix(),this.classLogitsMatrices.forEach(function(e){return e.dispose()}),this.squashLogitsDenominator.dispose()},e}();t.KNNImageClassifier=u},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=function(){function e(){}return e.nextFrame=function(){return new Promise(function(e){return requestAnimationFrame(function(){return e()})})},r([o.doc({heading:\"Performance\",subheading:\"Timing\"})],e,\"nextFrame\",null),e}();t.BrowserUtil=a},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(28);t.Dataset=r.Dataset;var o=n(100);t.CSVDataset=o.CSVDataset;var a=n(60);t.TextLineDataset=a.TextLineDataset;var i=n(101);t.FileDataSource=i.FileDataSource;var s=n(104);t.URLDataSource=s.URLDataSource},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function s(e,t){var n=new function(e){var t=this,n=function(){var e=4022871197;return function(t){t=t.toString();for(var n=0;n<t.length;n++){var r=.02519603282416938*(e+=t.charCodeAt(n));r-=e=r>>>0,e=(r*=e)>>>0,e+=4294967296*(r-=e)}return 2.3283064365386963e-10*(e>>>0)}}();t.next=function(){var e=2091639*t.s0+2.3283064365386963e-10*t.c;return t.s0=t.s1,t.s1=t.s2,t.s2=e-(t.c=0|e)},t.c=1,t.s0=n(\" \"),t.s1=n(\" \"),t.s2=n(\" \"),t.s0-=n(e),t.s0<0&&(t.s0+=1),t.s1-=n(e),t.s1<0&&(t.s1+=1),t.s2-=n(e),t.s2<0&&(t.s2+=1),n=null}(e),r=t&&t.state,o=n.next;return o.int32=function(){return 4294967296*n.next()|0},o.double=function(){return o()+1.1102230246251565e-16*(2097152*o()|0)},o.quick=o,r&&(\"object\"==typeof r&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(15)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.alea=s}(0,e,n(9))}).call(this,n(11)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t}function s(e,t){var n=new function(e){var t=this,n=\"\";t.x=0,t.y=0,t.z=0,t.w=0,t.next=function(){var e=t.x^t.x<<11;return t.x=t.y,t.y=t.z,t.z=t.w,t.w^=t.w>>>19^e^e>>>8},e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(\"object\"==typeof r&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(15)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xor128=s}(0,e,n(9))}).call(this,n(11)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e,t){return t.x=e.x,t.y=e.y,t.z=e.z,t.w=e.w,t.v=e.v,t.d=e.d,t}function s(e,t){var n=new function(e){var t=this,n=\"\";t.next=function(){var e=t.x^t.x>>>2;return t.x=t.y,t.y=t.z,t.z=t.w,t.w=t.v,(t.d=t.d+362437|0)+(t.v=t.v^t.v<<4^e^e<<1)|0},t.x=0,t.y=0,t.z=0,t.w=0,t.v=0,e===(0|e)?t.x=e:n+=e;for(var r=0;r<n.length+64;r++)t.x^=0|n.charCodeAt(r),r==n.length&&(t.d=t.x<<10^t.x>>>4),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(\"object\"==typeof r&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(15)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xorwow=s}(0,e,n(9))}).call(this,n(11)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e,t){return t.x=e.x.slice(),t.i=e.i,t}function s(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.x,o=t.i;return e=r[o],n=(e^=e>>>7)^e<<24,n^=(e=r[o+1&7])^e>>>10,n^=(e=r[o+3&7])^e>>>3,n^=(e=r[o+4&7])^e<<7,e=r[o+7&7],n^=(e^=e<<13)^e<<9,r[o]=n,t.i=o+1&7,n},function(e,t){var n,r=[];if(t===(0|t))r[0]=t;else for(t=\"\"+t,n=0;n<t.length;++n)r[7&n]=r[7&n]<<15^t.charCodeAt(n)+r[n+1&7]<<13;for(;r.length<8;)r.push(0);for(n=0;n<8&&0===r[n];++n);for(8==n?r[7]=-1:r[n],e.x=r,e.i=0,n=256;n>0;--n)e.next()}(t,e)}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.x&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(15)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xorshift7=s}(0,e,n(9))}).call(this,n(11)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e,t){return t.i=e.i,t.w=e.w,t.X=e.X.slice(),t}function s(e,t){null==e&&(e=+new Date);var n=new function(e){var t=this;t.next=function(){var e,n,r=t.w,o=t.X,a=t.i;return t.w=r=r+1640531527|0,n=o[a+34&127],e=o[a=a+1&127],n^=n<<13,e^=e<<17,n^=n>>>15,e^=e>>>12,n=o[a]=n^e,t.i=a,n+(r^r>>>16)|0},function(e,t){var n,r,o,a,i,s=[],u=128;for(t===(0|t)?(r=t,t=null):(t+=\"\\0\",r=0,u=Math.max(u,t.length)),o=0,a=-32;a<u;++a)t&&(r^=t.charCodeAt((a+32)%t.length)),0===a&&(i=r),r^=r<<10,r^=r>>>15,r^=r<<4,r^=r>>>13,a>=0&&(i=i+1640531527|0,o=0==(n=s[127&a]^=r+i)?o+1:0);for(o>=128&&(s[127&(t&&t.length||0)]=-1),o=127,a=512;a>0;--a)r=s[o+34&127],n=s[o=o+1&127],r^=r<<13,n^=n<<17,r^=r>>>15,n^=n>>>12,s[o]=r^n;e.w=i,e.X=s,e.i=o}(t,e)}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(r.X&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(15)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.xor4096=s}(0,e,n(9))}).call(this,n(11)(e))},function(e,t,n){(function(e){var r;!function(e,o,a){function i(e,t){return t.a=e.a,t.b=e.b,t.c=e.c,t.d=e.d,t}function s(e,t){var n=new function(e){var t=this,n=\"\";t.next=function(){var e=t.b,n=t.c,r=t.d,o=t.a;return e=e<<25^e>>>7^n,n=n-r|0,r=r<<24^r>>>8^o,o=o-e|0,t.b=e=e<<20^e>>>12^n,t.c=n=n-r|0,t.d=r<<16^n>>>16^o,t.a=o-e|0},t.a=0,t.b=0,t.c=-1640531527,t.d=1367130551,e===Math.floor(e)?(t.a=e/4294967296|0,t.b=0|e):n+=e;for(var r=0;r<n.length+20;r++)t.b^=0|n.charCodeAt(r),t.next()}(e),r=t&&t.state,o=function(){return(n.next()>>>0)/4294967296};return o.double=function(){do{var e=((n.next()>>>11)+(n.next()>>>0)/4294967296)/(1<<21)}while(0===e);return e},o.int32=n.next,o.quick=o,r&&(\"object\"==typeof r&&i(r,n),o.state=function(){return i(n,{})}),o}o&&o.exports?o.exports=s:n(9)&&n(15)?void 0===(r=function(){return s}.call(t,n,t,o))||(o.exports=r):this.tychei=s}(0,e,n(9))}).call(this,n(11)(e))},function(e,t,n){var r;!function(o,a){var i,s=this,u=256,c=6,l=\"random\",p=a.pow(u,c),h=a.pow(2,52),d=2*h,f=u-1;function m(e,t,n){var r=[],m=g(function e(t,n){var r,o=[],a=typeof t;if(n&&\"object\"==a)for(r in t)try{o.push(e(t[r],n-1))}catch(e){}return o.length?o:\"string\"==a?t:t+\"\\0\"}((t=1==t?{entropy:!0}:t||{}).entropy?[e,y(o)]:null==e?function(){try{var e;return i&&(e=i.randomBytes)?e=e(u):(e=new Uint8Array(u),(s.crypto||s.msCrypto).getRandomValues(e)),y(e)}catch(e){var t=s.navigator,n=t&&t.plugins;return[+new Date,s,n,s.screen,y(o)]}}():e,3),r),b=new function(e){var t,n=e.length,r=this,o=0,a=r.i=r.j=0,i=r.S=[];n||(e=[n++]);for(;o<u;)i[o]=o++;for(o=0;o<u;o++)i[o]=i[a=f&a+e[o%n]+(t=i[o])],i[a]=t;(r.g=function(e){for(var t,n=0,o=r.i,a=r.j,i=r.S;e--;)t=i[o=f&o+1],n=n*u+i[f&(i[o]=i[a=f&a+t])+(i[a]=t)];return r.i=o,r.j=a,n})(u)}(r),x=function(){for(var e=b.g(c),t=p,n=0;e<h;)e=(e+n)*u,t*=u,n=b.g(1);for(;e>=d;)e/=2,t/=2,n>>>=1;return(e+n)/t};return x.int32=function(){return 0|b.g(4)},x.quick=function(){return b.g(4)/4294967296},x.double=x,g(y(b.S),o),(t.pass||n||function(e,t,n,r){return r&&(r.S&&v(r,b),e.state=function(){return v(b,{})}),n?(a[l]=e,t):e})(x,m,\"global\"in t?t.global:this==a,t.state)}function v(e,t){return t.i=e.i,t.j=e.j,t.S=e.S.slice(),t}function g(e,t){for(var n,r=e+\"\",o=0;o<r.length;)t[f&o]=f&(n^=19*t[f&o])+r.charCodeAt(o++);return y(t)}function y(e){return String.fromCharCode.apply(0,e)}if(a[\"seed\"+l]=m,g(a.random(),o),e.exports){e.exports=m;try{i=n(88)}catch(e){}}else void 0===(r=function(){return m}.call(t,n,t,e))||(e.exports=r)}([],Math)},function(e,t){},function(e,t,n){\"use strict\";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(2),i=n(0),s=function(){function e(e,t,n){void 0===n&&(n=!0),this.base=e,this.batchSize=t,this.smallLastBatch=n}return e.prototype.getStream=function(){return r(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,this.base.getStream()];case 1:return[2,e.sent().batch(this.batchSize,this.smallLastBatch).map(u)]}})})},e}();function u(e){var t={},n=e[0],r=Object.keys(n);r.forEach(function(e){t[e]=[]});for(var o=function(e){r.forEach(function(n){var r=e[n];t[n].push(r)})},a=0,i=e;a<i.length;a++){o(i[a])}for(var s={},u=0,l=r;u<l.length;u++){var p=l[u];if(t[p].length!==e.length)throw new Error(\"Batching failed to get a '\"+p+\"' value for each element.\");\"string\"==typeof t[p][0]?s[p]=t[p]:s[p]=c(t[p])}return s}function c(e){for(var t=l(e[0])[0],n=[e.length].concat(t),r=new Float32Array(n.reduce(function(e,t){return e*t})),o=0,s=0,u=e;s<u.length;s++){var c=l(u[s]),p=c[0],h=c[1];if(!i.arraysEqual(p,t))throw new Error(\"Elements must have the same shape to be batched\");r.set(h,o),o+=h.length}return a.Tensor.make(n,{values:r})}function l(e){return e instanceof a.Tensor?[e.shape,e.dataSync()]:Array.isArray(e)?[[e.length],e]:[[],[e]]}t.BatchDataset=s},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.isMobile=function(){var e=navigator.userAgent||navigator.vendor||window.opera;return/(android|bb\\d+|meego).+mobile|avantgo|bada\\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\\-(n|u)|c55\\/|capi|ccwa|cdm\\-|cell|chtm|cldc|cmd\\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\\-s|devi|dica|dmob|do(c|p)o|ds(12|\\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\\-|_)|g1 u|g560|gene|gf\\-5|g\\-mo|go(\\.w|od)|gr(ad|un)|haie|hcit|hd\\-(m|p|t)|hei\\-|hi(pt|ta)|hp( i|ip)|hs\\-c|ht(c(\\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\\-(20|go|ma)|i230|iac( |\\-|\\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\\/)|klon|kpt |kwc\\-|kyo(c|k)|le(no|xi)|lg( g|\\/(k|l|u)|50|54|\\-[a-w])|libw|lynx|m1\\-w|m3ga|m50\\/|ma(te|ui|xo)|mc(01|21|ca)|m\\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\\-2|po(ck|rt|se)|prox|psio|pt\\-g|qa\\-a|qc(07|12|21|32|60|\\-[2-7]|i\\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\\-|oo|p\\-)|sdk\\/|se(c(\\-|0|1)|47|mc|nd|ri)|sgh\\-|shar|sie(\\-|m)|sk\\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\\-|v\\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\\-|tdg\\-|tel(i|m)|tim\\-|t\\-mo|to(pl|sh)|ts(70|m\\-|m3|m5)|tx\\-9|up(\\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\\-|your|zeto|zte\\-/i.test(e.substr(0,4))}},function(e,t,n){\"use strict\";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(1),i=n(3),s=n(93),u=n(5),c=n(96),l=n(97),p=n(2),h=n(0),d=function(){function e(e,t,n){this.backend=e,this.customBackend=t,this.safeMode=n,this.registeredVariables={},this.refCounter=new WeakMap,this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numDataBuffers=0,this.gradientScopeCount=0,this.customGradientDepth=0,this.activeScope={keep:[],track:[]},this.scopeStack=[this.activeScope],this.profiler=new c.Profiler(e)}return e.prototype.executeKernel=function(e,t,n){var r,o=this;if(r=a.ENV.get(\"DEBUG\")?this.profiler.profileKernel(e,function(){return s.executeKernel(o.backend,e,t)}):s.executeKernel(this.backend,e,t),null!=this.activeTape&&0===this.customGradientDepth){t=l.stripUndefinedInputsFromInputConfig(t);var i={id:this.nextTapeNodeId++,type:\"kernel\",name:\"kernel: \"+e,kernel:e,inputAndArgs:t,output:r,gradient:n};this.activeTape.push(i)}return r},e.prototype.registerTensor=function(e){var t=this.refCounter.has(e.dataId)?this.refCounter.get(e.dataId):0;this.numTensors++,0===t&&(this.numDataBuffers++,this.numBytes+=h.sizeFromShape(e.shape)*h.bytesPerElement(e.dtype),this.backend.register(e.dataId,e.shape,e.dtype)),this.refCounter.set(e.dataId,t+1),e instanceof p.Variable||this.track(e)},e.prototype.registerVariable=function(e){if(null!=this.registeredVariables[e.name])throw new Error(\"Variable with name \"+e.name+\" was already registered\");this.registeredVariables[e.name]=e},e.prototype.disposeTensor=function(e){if(this.refCounter.has(e.dataId)){this.numTensors--;var t=this.refCounter.get(e.dataId);t<=1?(this.refCounter.delete(e.dataId),this.backend.disposeData(e.dataId),this.numDataBuffers--,this.numBytes-=h.sizeFromShape(e.shape)*h.bytesPerElement(e.dtype)):this.refCounter.set(e.dataId,t-1)}},e.prototype.memory=function(){var e=this.backend.memory();return e.numTensors=this.numTensors,e.numDataBuffers=this.numDataBuffers,e.numBytes=this.numBytes,e},e.prototype.shouldRecord=function(){return null!=this.activeTape&&0===this.customGradientDepth},e.prototype.addTapeNode=function(e,t,n){var r={};e.forEach(function(e,t){r[t]=e});var o={id:this.nextTapeNodeId++,type:\"customGradient\",name:name,inputAndArgs:{inputs:r},output:t,gradient:function(e){var t={};return n(e).forEach(function(e,n){t[n]=function(){return e}}),t}};this.activeTape.push(o)},e.prototype.keep=function(e){if(1===this.scopeStack.length&&a.ENV.engine.safeMode)throw new Error(\"Safe mode is ON. Enclose all tensor operations inside dl.tidy(): dl.tidy(() => {...}) to avoid memory leaks.\");return this.activeScope.keep.push(e),e},e.prototype.startScope=function(e){void 0===e&&(e=!1),e&&0===this.gradientScopeCount&&(this.activeTape=[]),e&&this.gradientScopeCount++;var t={keep:[],track:[]};this.scopeStack.push(t),this.activeScope=t},e.prototype.endScope=function(e,t){var n=this;void 0===t&&(t=!1),t&&(this.gradientScopeCount--,0===this.gradientScopeCount&&(this.activeTape=null));var r=this.activeScope.keep,o=l.extractTensorsFromScopeResult(e);r=r.concat(o);for(var a=0;a<this.activeScope.track.length;a++){var i=this.activeScope.track[a];h.isTensorInList(i,r)||(null!=this.activeTape?o.push(i):i.dispose())}this.scopeStack.pop(),this.activeScope=0===this.scopeStack.length?{keep:[],track:[]}:this.scopeStack[this.scopeStack.length-1],o.forEach(function(e){h.isTensorInList(e,n.activeScope.keep)||n.track(e)})},e.prototype.dispose=function(){this.customBackend&&this.backend.dispose()},e.prototype.gradients=function(e,t,n,r){var o=this;return void 0===r&&(r=!1),i.tidy(\"gradients\",function(){var a=e();h.assert(a instanceof p.Tensor,\"The result y returned by f() must be a tensor.\");var i=l.getFilteredNodesXToY(o.activeTape,t,a);if(!r&&0===i.length&&t.length>0)throw new Error(\"Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.\");var s={};return s[a.id]=null==n?u.onesLike(a):n,l.backpropagateGradients(s,i),{value:a,grads:t.map(function(e){return s[e.id]})}},!0)},e.prototype.customGrad=function(e){var t=this;return h.assert(h.isFunction(e),\"The f passed in customGrad(f) must be a function.\"),function(){for(var n,r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];h.assert(r.every(function(e){return e instanceof p.Tensor}),\"The args passed in customGrad(f)(x1, x2,...) must all be tensors\"),t.customGradientDepth++;var a=i.tidy(e.name,function(){var t=e.apply(void 0,r),o=t.value,a=t.gradFunc;return h.assert(o instanceof p.Tensor,\"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor\"),h.assert(h.isFunction(a),\"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function.\"),n=a,o},!0);if(t.customGradientDepth--,t.shouldRecord()){t.addTapeNode(r,a,function(e){var t=n(e),o=Array.isArray(t)?t:[t];return h.assert(o.length===r.length,\"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...).\"),h.assert(o.every(function(e){return e instanceof p.Tensor}),\"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.\"),o})}return a}},e.prototype.write=function(e,t){this.backend.write(e,t)},e.prototype.readSync=function(e){return this.backend.readSync(e)},e.prototype.read=function(e){return this.backend.read(e)},e.prototype.fromPixels=function(e,t){return this.backend.fromPixels(e,t)},e.prototype.time=function(e){return r(this,void 0,void 0,function(){var t,n;return o(this,function(r){switch(r.label){case 0:return t=performance.now(),[4,this.backend.time(e)];case 1:return(n=r.sent()).wallMs=performance.now()-t,[2,n]}})})},e.prototype.track=function(e){if(1===this.scopeStack.length&&this.safeMode)throw new Error(\"Safe mode is ON. Enclose all tensor operations inside dl.tidy(): dl.tidy(() => {op();...}); to avoid memory leaks.\");return this.activeScope.track.push(e),e},e}();t.Engine=d},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(1),i=n(3),s=n(2),u=n(0),c=function(){function e(){}return e.gradScope=function(e,t){return i.tidy(e,t,!0)},e.grad=function(e){return u.assert(u.isFunction(e),\"The f passed in grad(f) must be a function\"),function(t,n){u.assert(t instanceof s.Tensor,\"The x passed in grad(f)(x) must be a tensor\"),u.assert(null==n||n instanceof s.Tensor,\"The dy passed in grad(f)(x, dy) must be a tensor\");var r=a.ENV.engine.gradients(function(){return e(t)},[t],n),o=r.value,i=r.grads;return null!=n&&u.assertShapesMatch(o.shape,n.shape,\"The shape of dy passed in grad(f)(x, dy) must match the shape returned by f(x)\"),o.dispose(),l(i),i[0]}},e.grads=function(e){return u.assert(u.isFunction(e),\"The f passed in grads(f) must be a function\"),function(t,n){u.assert(Array.isArray(t)&&t.every(function(e){return e instanceof s.Tensor}),\"The args passed in grads(f)(args) must be an array of tensors\"),u.assert(null==n||n instanceof s.Tensor,\"The dy passed in grads(f)(args, dy) must be a tensor\");var r=a.ENV.engine.gradients(function(){return e.apply(void 0,t)},t,n),o=r.value,i=r.grads;return null!=n&&u.assertShapesMatch(o.shape,n.shape,\"The shape of dy passed in grads(f)([x1,...], dy) must match the shape returned by f([x1,...])\"),o.dispose(),l(i),i}},e.valueAndGrad=function(e){return u.assert(u.isFunction(e),\"The f passed in valueAndGrad(f) must be a function\"),function(t,n){u.assert(t instanceof s.Tensor,\"The x passed in valueAndGrad(f)(x) must be a tensor\"),u.assert(null==n||n instanceof s.Tensor,\"The dy passed in valueAndGrad(f)(x, dy) must be a tensor\");var r=a.ENV.engine.gradients(function(){return e(t)},[t],n),o=r.grads,i=r.value;return l(o),{grad:o[0],value:i}}},e.valueAndGrads=function(e){return u.assert(u.isFunction(e),\"The f passed in valueAndGrads(f) must be a function\"),function(t,n){u.assert(Array.isArray(t)&&t.every(function(e){return e instanceof s.Tensor}),\"The args passed in valueAndGrads(f)(args) must be array of tensors\"),u.assert(null==n||n instanceof s.Tensor,\"The dy passed in valueAndGrads(f)(args, dy) must be a tensor\");var r=a.ENV.engine.gradients(function(){return e.apply(void 0,t)},t,n);return null!=n&&u.assertShapesMatch(r.value.shape,n.shape,\"The shape of dy passed in valueAndGrads(f)([x1,...], dy) must match the shape returned by f([x1,...])\"),l(r.grads),r}},e.variableGrads=function(e,t){if(u.assert(u.isFunction(e),\"The f passed in variableGrads(f) must be a function\"),u.assert(null==t||Array.isArray(t)&&t.every(function(e){return e instanceof s.Variable}),\"The varList passed in variableGrads(f, varList) must be an array of variables\"),null==t)for(var n in t=[],a.ENV.engine.registeredVariables)t.push(a.ENV.engine.registeredVariables[n]);t=t.filter(function(e){return e.trainable});var r=a.ENV.engine.gradients(e,t,null,!0),o=r.value,i=r.grads;u.assert(i.some(function(e){return null!=e}),\"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize().\"),u.assert(0===o.rank,\"The f passed in variableGrads(f) must return a scalar, but it returned a rank-\"+o.rank+\" tensor\");var c={};return t.forEach(function(e,t){null!=i[t]&&(c[e.name]=i[t])}),{value:o,grads:c}},e.customGrad=function(e){return a.ENV.engine.customGrad(e)},r([o.doc({heading:\"Training\",subheading:\"Gradients\"})],e,\"grad\",null),r([o.doc({heading:\"Training\",subheading:\"Gradients\"})],e,\"grads\",null),r([o.doc({heading:\"Training\",subheading:\"Gradients\"})],e,\"valueAndGrad\",null),r([o.doc({heading:\"Training\",subheading:\"Gradients\"})],e,\"valueAndGrads\",null),r([o.doc({heading:\"Training\",subheading:\"Gradients\"})],e,\"variableGrads\",null),r([o.doc({heading:\"Training\",subheading:\"Gradients\"})],e,\"customGrad\",null),e}();function l(e){if(e.filter(function(e){return null==e}).length>0)throw new Error(\"Cannot compute gradient of y=f(x) with respect to x. Make sure that\\n    the f you passed encloses all operations that lead from x to y.\")}t.Gradients=c},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(5),o=n(2),a=n(0);t.executeKernel=function(e,t,n){if(\"MatMul\"===t){var i=n;return e.matMul(i.inputs.a,i.inputs.b,i.args.transposeA,i.args.transposeB)}if(\"Slice1D\"===t)return i=n,e.slice1D(i.inputs.x,i.args.begin,i.args.size);if(\"Slice2D\"===t)return i=n,e.slice2D(i.inputs.x,i.args.begin,i.args.size);if(\"Slice3D\"===t)return i=n,e.slice3D(i.inputs.x,i.args.begin,i.args.size);if(\"Slice4D\"===t)return i=n,e.slice4D(i.inputs.x,i.args.begin,i.args.size);if(\"Reverse4D\"===t)return i=n,e.reverse4D(i.inputs.x,i.args.axis);if(\"Concat\"===t)return i=n,e.concat(i.inputs.a,i.inputs.b);if(\"Neg\"===t)return i=n,e.neg(i.inputs.x);if(\"Add\"===t)return i=n,e.add(i.inputs.a,i.inputs.b);if(\"Sub\"===t)return i=n,e.subtract(i.inputs.a,i.inputs.b);if(\"Mul\"===t)return i=n,e.multiply(i.inputs.a,i.inputs.b);if(\"Div\"===t)return i=n,e.divide(i.inputs.a,i.inputs.b);if(\"Sum\"===t)return i=n,e.sum(i.inputs.x,i.args.axes);if(\"ArgMax\"===t)return i=n,e.argMax(i.inputs.x,i.args.axes);if(\"ArgMin\"===t)return i=n,e.argMin(i.inputs.x,i.args.axes);if(\"Equal\"===t)return i=n,e.equal(i.inputs.a,i.inputs.b);if(\"NotEqual\"===t)return i=n,e.notEqual(i.inputs.a,i.inputs.b);if(\"Less\"===t)return i=n,e.less(i.inputs.a,i.inputs.b);if(\"LessEqual\"===t)return i=n,e.lessEqual(i.inputs.a,i.inputs.b);if(\"Greater\"===t)return i=n,e.greater(i.inputs.a,i.inputs.b);if(\"GreaterEqual\"===t)return i=n,e.greaterEqual(i.inputs.a,i.inputs.b);if(\"LogicalNot\"===t)return i=n,e.logicalNot(i.inputs.x);if(\"LogicalAnd\"===t)return i=n,e.logicalAnd(i.inputs.a,i.inputs.b);if(\"LogicalOr\"===t)return i=n,e.logicalOr(i.inputs.a,i.inputs.b);if(\"LogicalXor\"===t)return i=n,e.logicalXor(i.inputs.a,i.inputs.b);if(\"Where\"===t)return i=n,e.where(i.inputs.condition,i.inputs.a,i.inputs.b,i.args.dtype);if(\"TopKValues\"===t)return i=n,e.topKValues(i.inputs.x,i.args.k);if(\"TopKIndices\"===t)return i=n,e.topKIndices(i.inputs.x,i.args.k);if(\"Min\"===t)return i=n,e.min(i.inputs.x,i.args.axes);if(\"Minimum\"===t)return i=n,e.minimum(i.inputs.a,i.inputs.b);if(\"Max\"===t)return i=n,e.max(i.inputs.x,i.args.axes);if(\"Maximum\"===t)return i=n,e.maximum(i.inputs.a,i.inputs.b);if(\"Ceil\"===t)return i=n,e.ceil(i.inputs.x);if(\"Floor\"===t)return i=n,e.floor(i.inputs.x);if(\"Pow\"===t)return i=n,e.pow(i.inputs.base,i.inputs.exp);if(\"Exp\"===t)return i=n,e.exp(i.inputs.x);if(\"Log\"===t)return i=n,e.log(i.inputs.x);if(\"Sqrt\"===t)return i=n,e.sqrt(i.inputs.x);if(\"Square\"===t)return i=n,e.square(i.inputs.x);if(\"Relu\"===t)return i=n,e.relu(i.inputs.x);if(\"Reshape\"===t){var s=(i=n).inputs.x,u=i.args.newShape;return o.Tensor.make(u,{dataId:s.dataId},s.dtype)}if(\"Cast\"===t){s=(i=n).inputs.x;var c=i.args.newDType;if(!a.hasEncodingLoss(s.dtype,c))return o.Tensor.make(s.shape,{dataId:s.dataId},c);if(\"int32\"===c)return e.int(s);if(\"bool\"===c)return e.notEqual(s,r.scalar(0,s.dtype));throw new Error(\"Error in Cast: unknown dtype argument (\"+c+\")\")}if(\"LeakyRelu\"===t)return i=n,e.leakyRelu(i.inputs.x,i.args.alpha);if(\"PReLU\"===t)return i=n,e.prelu(i.inputs.x,i.inputs.alpha);if(\"PReLUDer\"===t)return i=n,e.preluDer(i.inputs.x,i.inputs.alpha);if(\"Elu\"===t)return i=n,e.elu(i.inputs.x);if(\"EluDer\"===t)return i=n,e.eluDer(i.inputs.x);if(\"Selu\"===t)return i=n,e.selu(i.inputs.x);if(\"Abs\"===t)return i=n,e.abs(i.inputs.x);if(\"Sigmoid\"===t)return i=n,e.sigmoid(i.inputs.x);if(\"Step\"===t)return i=n,e.step(i.inputs.x,i.args.alpha);if(\"Sin\"===t)return i=n,e.sin(i.inputs.x);if(\"Cos\"===t)return i=n,e.cos(i.inputs.x);if(\"Tan\"===t)return i=n,e.tan(i.inputs.x);if(\"Asin\"===t)return i=n,e.asin(i.inputs.x);if(\"Acos\"===t)return i=n,e.acos(i.inputs.x);if(\"Atan\"===t)return i=n,e.atan(i.inputs.x);if(\"Sinh\"===t)return i=n,e.sinh(i.inputs.x);if(\"Cosh\"===t)return i=n,e.cosh(i.inputs.x);if(\"Tanh\"===t)return i=n,e.tanh(i.inputs.x);if(\"Clip\"===t)return i=n,e.clip(i.inputs.x,i.args.min,i.args.max);if(\"Tile\"===t)return i=n,e.tile(i.inputs.x,i.args.reps);if(\"Gather\"===t)return i=n,e.gather(i.inputs.x,i.inputs.indices,i.args.axis);if(\"Pad1D\"===t)return i=n,e.pad1D(i.inputs.x,i.args.paddings,i.args.constantValue);if(\"Pad2D\"===t)return i=n,e.pad2D(i.inputs.x,i.args.paddings,i.args.constantValue);if(\"Transpose\"===t)return i=n,e.transpose(i.inputs.x,i.args.perm);if(\"Conv2D\"===t)return i=n,e.conv2d(i.inputs.x,i.inputs.filter,i.args.convInfo);if(\"Conv2DDerInput\"===t)return i=n,e.conv2dDerInput(i.inputs.dy,i.inputs.filter,i.args.convInfo);if(\"Conv2DDerFilter\"===t)return i=n,e.conv2dDerFilter(i.inputs.x,i.inputs.dy,i.args.convInfo);if(\"DepthwiseConv2D\"===t)return i=n,e.depthwiseConv2D(i.inputs.x,i.inputs.filter,i.args.convInfo);if(\"MaxPool\"===t)return i=n,e.maxPool(i.inputs.x,i.args.convInfo);if(\"MaxPoolBackprop\"===t)return i=n,e.maxPoolBackprop(i.inputs.dy,i.inputs.x,i.args.convInfo);if(\"AvgPool\"===t)return i=n,e.avgPool(i.inputs.x,i.args.convInfo);if(\"AvgPoolBackprop\"===t)return i=n,e.avgPoolBackprop(i.inputs.dy,i.inputs.x,i.args.convInfo);if(\"MinPool\"===t)return i=n,e.minPool(i.inputs.x,i.args.convInfo);if(\"ResizeBilinear\"===t)return i=n,e.resizeBilinear(i.inputs.x,i.args.newHeight,i.args.newWidth,i.args.alignCorners);if(\"BatchNorm4D\"===t)return i=n,e.batchNormalization4D(i.inputs.x,i.inputs.mean,i.inputs.variance,i.args.varianceEpsilon,i.inputs.scale,i.inputs.offset);if(\"LRN4D\"===t)return i=n,e.localResponseNormalization4D(i.inputs.x,i.args.radius,i.args.bias,i.args.alpha,i.args.beta,i.args.normRegion);if(\"Multinomial\"===t)return i=n,e.multinomial(i.inputs.probs,i.args.numSamples,i.args.seed);if(\"OneHot\"===t)return i=n,e.oneHot(i.inputs.indices,i.args.depth,i.args.onValue,i.args.offValue);throw new Error(\"No backend method found for kernel \"+t)}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(24),o=function(){function e(e,t,n,o,a){this.mean=e,this.stdDev=t,this.dtype=n,this.nextVal=NaN,this.truncated=o,this.truncated&&(this.upper=this.mean+2*this.stdDev,this.lower=this.mean-2*this.stdDev);var i=a||Math.random();this.random=r.alea(i.toString())}return e.prototype.nextValue=function(){if(!isNaN(this.nextVal)){var e=this.nextVal;return this.nextVal=NaN,e}for(var t,n,r=!1;!r;){var o=void 0,a=void 0,i=void 0;do{i=(o=2*this.random()-1)*o+(a=2*this.random()-1)*a}while(i>=1||0===i);var s=Math.sqrt(-2*Math.log(i)/i);t=this.mean+this.stdDev*o*s,n=this.mean+this.stdDev*a*s,this.truncated&&!this.isValidTruncated(t)||(r=!0)}return this.truncated&&!this.isValidTruncated(n)||(this.nextVal=this.convertValue(n)),this.convertValue(t)},e.prototype.convertValue=function(e){return null==this.dtype||\"float32\"===this.dtype?e:Math.round(e)},e.prototype.isValidTruncated=function(e){return e<=this.upper&&e>=this.lower},e}();t.MPRandGauss=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(0);t.assertParamsValid=function(e,t,n){r.assert(e.rank===t.length,\"Error in slice\"+e.rank+\"D: Length of begin \"+t+\" must match the rank of the array (\"+e.rank+\").\"),r.assert(e.rank===n.length,\"Error in slice\"+e.rank+\"D: Length of size \"+n+\" must match the rank of the array (\"+e.rank+\").\");for(var o=0;o<e.rank;++o)r.assert(t[o]+n[o]<=e.shape[o],\"Error in slice\"+e.rank+\"D: begin[\"+o+\"] + size[\"+o+\"] (\"+(t[o]+n[o])+\") would overflow input.shape[\"+o+\"] (\"+e.shape[o]+\")\")}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(0),o=function(){function e(e,t){this.backendTimer=e,this.logger=t,null==t&&(this.logger=new a)}return e.prototype.profileKernel=function(e,t){var n,o=this,a=this.backendTimer.time(function(){n=t()}),i=n.dataSync();return r.checkForNaN(i,n.dtype,e),a.then(function(t){o.logger.logKernelProfile(e,n,i,t.kernelMs)}),n},e}();t.Profiler=o;var a=function(){function e(){}return e.prototype.logKernelProfile=function(e,t,n,o){var a=r.rightPad(o+\"ms\",9),i=r.rightPad(e,25),s=t.rank,u=t.size,c=r.rightPad(t.shape.toString(),14);console.log(\"%c\"+i+\"\\t%c\"+a+\"\\t%c\"+s+\"D \"+c+\"\\t%c\"+u,\"font-weight:bold\",\"color:red\",\"color:blue\",\"color: orange\")},e}();t.Logger=a},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(0),o=n(2);t.getFilteredNodesXToY=function(e,t,n){for(var r={},a={},i=0;i<t.length;i++)r[t[i].id]=!0;for(i=0;i<e.length;i++){var s=(w=e[i]).inputAndArgs.inputs;for(var u in s){for(var c=s[u],l=!1,p=0;p<t.length;p++)if(r[c.id]){if(w.output instanceof o.Tensor)r[w.output.id]=!0;else for(var h=0,d=Object.keys(w.output);h<d.length;h++){var f=d[h];r[w.output[f].id]=!0}l=!0,a[w.id]=!0;break}if(l)break}}var m={};m[n.id]=!0;var v={};for(i=e.length-1;i>=0;i--){s=(w=e[i]).inputAndArgs.inputs;var g=[];if(w.output instanceof o.Tensor)g.push(w.output);else for(var y=0,b=Object.keys(w.output);y<b.length;y++)f=b[y],g.push(w.output[f]);for(p=0;p<g.length;p++)if(m[g[p].id]){for(var u in s)m[s[u].id]=!0,v[w.id]=!0;break}}var x=[];for(i=0;i<e.length;i++){var w;if(a[(w=e[i]).id]&&v[w.id]){var E={};for(var u in w.inputAndArgs.inputs){var T=w.inputAndArgs.inputs[u];r[T.id]&&(E[u]=T)}var k=void 0;if(w.output instanceof o.Tensor)k=w.output;else for(var S in k={},w.output)m[w.output[S].id]&&(k[S]=w.output[S]);var O=Object.assign({},w);O.inputAndArgs={inputs:E},O.output=k,x.push(O)}}return x},t.backpropagateGradients=function(e,t){for(var n=t.length-1;n>=0;n--){var a=t[n],i=void 0;if(a.output instanceof o.Tensor)i=e[a.output.id];else{i={};for(var s=0,u=Object.keys(a.output);s<u.length;s++){var c=u[s];i[c]=e[a.output[c].id]}}if(null==a.gradient)throw new Error(\"Cannot compute gradient: gradient function not found for \"+a.name+\".\");var l=a.gradient(i,a.output);for(var p in a.inputAndArgs.inputs){if(!(p in l))throw new Error(\"Cannot backprop through input \"+p+\". Available gradients found: \"+Object.keys(l)+\".\");var h=l[p](),d=a.inputAndArgs.inputs[p];if(!r.arraysEqual(h.shape,d.shape))throw new Error(\"Error in gradient for op \"+a.name+\". The gradient of input '\"+p+\"' has shape '\"+h.shape+\"', which does not match the shape of the input '\"+d.shape+\"'\");if(null==e[d.id])e[d.id]=h;else{var f=e[d.id];e[d.id]=f.add(h),f.dispose()}}}},t.extractTensorsFromScopeResult=function(e){if(null==e)return[];if(e instanceof o.Tensor)return[e];var t=[],n=e;for(var a in n){var i=r.flatten(n[a]).filter(function(e){return e instanceof o.Tensor});t.push.apply(t,i)}return t},t.stripUndefinedInputsFromInputConfig=function(e){return Object.keys(e.inputs).forEach(function(t){null==e.inputs[t]&&delete e.inputs[t]}),e}},function(e,t,n){\"use strict\";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(2);t.scaleTo01=function(e,t){var n=t-e,r=a.Scalar.new(e),o=a.Scalar.new(n);return function(t){if(\"string\"==typeof t)throw new Error(\"Can't scale a string.\");return t instanceof a.Tensor?t.sub(r).div(o):t instanceof Array?t.map(function(t){return(t-e)/n}):(t-e)/n}},t.computeDatasetStatistics=function(e,t,n){return r(this,void 0,void 0,function(){var r,i;return o(this,function(o){switch(o.label){case 0:return[4,e.getStream()];case 1:return r=o.sent(),null!=n&&(r=r.shuffle(n)),null!=t&&(r=r.take(t)),i={},[4,r.forEach(function(e){for(var t in e){var n=e[t];if(\"string\"==typeof n);else{var r=void 0,o=void 0;if(n instanceof a.Tensor)r=n.min().dataSync()[0],o=n.max().dataSync()[0];else if(n instanceof Array)r=n.reduce(function(e,t){return Math.min(e,t)}),o=n.reduce(function(e,t){return Math.max(e,t)});else{if(isNaN(n)||!isFinite(n))throw new Error(\"Cannot compute statistics: \"+t+\" = \"+n);r=n,o=n}var s=i[t];null==s&&(s={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},i[t]=s),s.min=Math.min(s.min,r),s.max=Math.max(s.max,o)}}return{}})];case 2:return o.sent(),[2,i]}})})}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=function(e){function t(){return e.call(this,t.INITIAL_CAPACITY)||this}return r(t,e),t.prototype.isFull=function(){return!1},t.prototype.push=function(t){e.prototype.isFull.call(this)&&this.expand(),e.prototype.push.call(this,t)},t.prototype.unshift=function(t){e.prototype.isFull.call(this)&&this.expand(),e.prototype.unshift.call(this,t)},t.prototype.expand=function(){for(var e=2*this.capacity,t=new Array(e),n=this.length(),r=0;r<n;r++)t[r]=this.get(this.wrap(this.begin+r));this.data=t,this.capacity=e,this.doubledCapacity=2*this.capacity,this.begin=0,this.end=n},t.INITIAL_CAPACITY=32,t}(n(59).RingBuffer);t.GrowingRingBuffer=o},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i,s=n(28),u=n(60);!function(e){e[e.READ_FIRST_LINE=0]=\"READ_FIRST_LINE\",e[e.NUMBERED=1]=\"NUMBERED\"}(i=t.CsvHeaderConfig||(t.CsvHeaderConfig={}));var c=function(e){function t(n){var r=e.call(this)||this;return r.input=n,r.hasHeaderLine=!1,r.base=new u.TextLineDataset(n,t.textColumnName),r}return r(t,e),Object.defineProperty(t.prototype,\"csvColumnNames\",{get:function(){return this._csvColumnNames},enumerable:!0,configurable:!0}),t.prototype.setCsvColumnNames=function(e){return o(this,void 0,void 0,function(){var n,r;return a(this,function(o){switch(o.label){case 0:return null!=e&&e!==i.NUMBERED?[3,3]:[4,this.base.getStream()];case 1:return[4,o.sent().next()];case 2:return n=o.sent(),r=n[t.textColumnName],this._csvColumnNames=Array.from(r.split(\",\").keys()).map(function(e){return e.toString()}),[3,7];case 3:return e!==i.READ_FIRST_LINE?[3,6]:[4,this.base.getStream()];case 4:return[4,o.sent().next()];case 5:return n=o.sent(),r=n[t.textColumnName],this._csvColumnNames=r.split(\",\"),this.hasHeaderLine=!0,[3,7];case 6:this._csvColumnNames=e,o.label=7;case 7:return[2]}})})},t.create=function(e,n){return void 0===n&&(n=i.NUMBERED),o(this,void 0,void 0,function(){var r;return a(this,function(o){switch(o.label){case 0:return[4,(r=new t(e)).setCsvColumnNames(n)];case 1:return o.sent(),[2,r]}})})},t.prototype.getStream=function(){return o(this,void 0,void 0,function(){var e,t=this;return a(this,function(n){switch(n.label){case 0:return[4,this.base.getStream()];case 1:return e=n.sent(),this.hasHeaderLine&&(e=e.skip(1)),[2,e.map(function(e){return t.makeDatasetElement(e)})]}})})},t.prototype.makeDatasetElement=function(e){for(var n=e[t.textColumnName].split(\",\"),r={},o=0;o<this._csvColumnNames.length;o++){var a=n[o];if(\"\"===a)r[this._csvColumnNames[o]]=void 0;else{var i=Number(a);isNaN(i)?r[this._csvColumnNames[o]]=a:r[this._csvColumnNames[o]]=i}}return r},t.textColumnName=\"line\",t}(s.Dataset);t.CSVDataset=c},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(61),a=n(62),i=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.input=t,r.options=n,r}return r(t,e),t.prototype.getStream=function(){return new a.FileReaderStream(this.input,this.options)},t}(o.DataSource);t.FileDataSource=i},function(e,t,n){(function(e,r){var o;/*! https://mths.be/utf8js v2.1.2 by @mathias */!function(a){var i=t,s=(e&&e.exports,\"object\"==typeof r&&r);s.global!==s&&s.window;var u,c,l,p=String.fromCharCode;function h(e){for(var t,n,r=[],o=0,a=e.length;o<a;)(t=e.charCodeAt(o++))>=55296&&t<=56319&&o<a?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function d(e){if(e>=55296&&e<=57343)throw Error(\"Lone surrogate U+\"+e.toString(16).toUpperCase()+\" is not a scalar value\")}function f(e,t){return p(e>>t&63|128)}function m(e){if(0==(4294967168&e))return p(e);var t=\"\";return 0==(4294965248&e)?t=p(e>>6&31|192):0==(4294901760&e)?(d(e),t=p(e>>12&15|224),t+=f(e,6)):0==(4292870144&e)&&(t=p(e>>18&7|240),t+=f(e,12),t+=f(e,6)),t+=p(63&e|128)}function v(){if(l>=c)throw Error(\"Invalid byte index\");var e=255&u[l];if(l++,128==(192&e))return 63&e;throw Error(\"Invalid continuation byte\")}function g(){var e,t;if(l>c)throw Error(\"Invalid byte index\");if(l==c)return!1;if(e=255&u[l],l++,0==(128&e))return e;if(192==(224&e)){if((t=(31&e)<<6|v())>=128)return t;throw Error(\"Invalid continuation byte\")}if(224==(240&e)){if((t=(15&e)<<12|v()<<6|v())>=2048)return d(t),t;throw Error(\"Invalid continuation byte\")}if(240==(248&e)&&(t=(7&e)<<18|v()<<12|v()<<6|v())>=65536&&t<=1114111)return t;throw Error(\"Invalid UTF-8 detected\")}var y={version:\"2.1.2\",encode:function(e){for(var t=h(e),n=t.length,r=-1,o=\"\";++r<n;)o+=m(t[r]);return o},decode:function(e){u=h(e),c=u.length,l=0;for(var t,n=[];!1!==(t=g());)n.push(t);return function(e){for(var t,n=e.length,r=-1,o=\"\";++r<n;)(t=e[r])>65535&&(o+=p((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=p(t);return o}(n)}};void 0===(o=function(){return y}.call(t,n,t,e))||(e.exports=o)}()}).call(this,n(11)(e),n(37))},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(17),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.split=function(e){return new u(this,e)},t}(i.DataStream);t.StringStream=s;var u=function(e){function t(t,n){var r=e.call(this)||this;return r.impl=new c(t,n),r}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,this.impl.next()]})})},t}(s),c=function(e){function t(t,n){var r=e.call(this)||this;return r.upstream=t,r.separator=n,r.carryover=\"\",r}return r(t,e),t.prototype.pump=function(){return o(this,void 0,void 0,function(){var e,t,n,r,o;return a(this,function(a){switch(a.label){case 0:return[4,this.upstream.next()];case 1:if(null==(e=a.sent()))return\"\"===this.carryover?[2,!1]:(this.outputQueue.push(this.carryover),this.carryover=\"\",[2,!0]);for((t=e.split(this.separator))[0]=this.carryover+t[0],n=0,r=t.slice(0,-1);n<r.length;n++)o=r[n],this.outputQueue.push(o);return this.carryover=t[t.length-1],[2,!0]}})})},t}(i.QueueStream)},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(61),a=n(105),i=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.url=t,r.options=n,r}return r(t,e),t.prototype.getStream=function(){return new a.URLStream(this.url,this.options)},t}(o.DataSource);t.URLDataSource=i},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},a=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var i=n(63),s=n(17),u=n(62),c=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.impl=new l(t,n),r}return r(t,e),t.prototype.next=function(){return o(this,void 0,void 0,function(){return a(this,function(e){return[2,this.impl.next()]})})},t}(i.ByteStream);t.URLStream=c;var l=function(e){function t(t,n){void 0===n&&(n={});var r=e.call(this)||this;return r.url=t,r.options=n,r.blobPromise=fetch(t,n).then(function(e){if(e.ok)return e.blob();throw new Error(e.statusText)}),r}return r(t,e),t.prototype.pump=function(){return o(this,void 0,void 0,function(){var e,t;return a(this,function(n){switch(n.label){case 0:return null!=this.fileReaderStream?[3,2]:[4,this.blobPromise];case 1:e=n.sent(),this.fileReaderStream=new u.FileReaderStream(e,this.options),n.label=2;case 2:return[4,this.fileReaderStream.next()];case 3:return null==(t=n.sent())?[2,!1]:(this.outputQueue.push(t),[2,!0])}})})},t}(s.QueueStream)},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(1),o=n(67),a=n(68),i=n(2),s=n(0),u=[{BACKEND:\"webgl\",WEBGL_FLOAT_TEXTURE_ENABLED:!0,WEBGL_VERSION:1},{BACKEND:\"webgl\",WEBGL_FLOAT_TEXTURE_ENABLED:!0,WEBGL_VERSION:2}];function c(e,n,r){if(void 0===r&&(r=t.TEST_EPSILON),e instanceof i.Tensor||n instanceof i.Tensor){if(e instanceof i.Tensor&&n instanceof i.Tensor){if(e.dtype!==n.dtype)throw new Error(\"Arrays are of different type actual: \"+e.dtype+\" vs expected: \"+n.dtype+\".\");if(!s.arraysEqual(e.shape,n.shape))throw new Error(\"Arrays are of different shape actual: \"+e.shape+\" vs expected: \"+n.shape+\".\")}}else{var o=e.constructor.name,a=n.constructor.name;if(o!==a)throw new Error(\"Arrays are of different type actual: \"+o+\" vs expected: \"+a)}var u,c;if(u=e instanceof i.Tensor?e.dataSync():e,c=n instanceof i.Tensor?n.dataSync():n,u.length!==c.length)throw new Error(\"Arrays have different lengths actual: \"+u.length+\" vs expected: \"+c.length+\".\\nActual:   \"+u+\".\\nExpected: \"+c+\".\");for(var p=0;p<c.length;++p){var h=u[p],d=c[p];if(!l(h,Number(d),r))throw new Error(\"Arrays differ: actual[\"+p+\"] = \"+h+\", expected[\"+p+\"] = \"+d+\".\\nActual:   \"+u+\".\\nExpected: \"+c+\".\")}}function l(e,t,n){return!(!isNaN(e)||!isNaN(t))||!(isNaN(e)||isNaN(t)||Math.abs(e-t)>n)}t.WEBGL_ENVS=u.concat([{BACKEND:\"webgl\",WEBGL_FLOAT_TEXTURE_ENABLED:!1,WEBGL_VERSION:1}]),t.CPU_ENVS=[{BACKEND:\"cpu\"}],t.ALL_FLOAT_ENVS=u.concat(t.CPU_ENVS),t.ALL_ENVS=t.WEBGL_ENVS.concat(t.CPU_ENVS),t.TEST_EPSILON=.01,t.expectArraysClose=c,t.expectArraysEqual=function(e,t){return c(e,t,0)},t.expectNumbersClose=function(e,n,r){if(void 0===r&&(r=t.TEST_EPSILON),!l(e,n,r))throw new Error(\"Numbers differ: actual === \"+e+\", expected === \"+n)},t.expectValuesInRange=function(e,t,n){var r;r=e instanceof i.Tensor?e.dataSync():e;for(var o=0;o<r.length;o++)if(r[o]<t||r[o]>n)throw new Error(\"Value out of range:\"+r[o]+\" low: \"+t+\", high: \"+n)},t.describeWithFlags=function(e,t,n){t.forEach(function(t){!function(e,t,n){describe(e,function(){beforeEach(function(){r.ENV.setFeatures(n||{}),r.ENV.addCustomBackend(\"webgl\",function(){return new a.MathBackendWebGL}),r.ENV.addCustomBackend(\"cpu\",function(){return new o.MathBackendCPU}),n&&null!=n.BACKEND&&r.Environment.setBackend(n.BACKEND),r.ENV.engine.startScope()}),afterEach(function(){r.ENV.engine.endScope(null),r.ENV.reset()}),t()})}(e+\" \"+JSON.stringify(t),n,t)})},t.assertIsNan=function(e,t){if(!s.isValNaN(e,t))throw new Error(\"Value \"+e+\" does not represent NaN for dtype \"+t)}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.PARALLELIZE_THRESHOLD=30,t.computeOptimalWindowSize=function(e){return e<=t.PARALLELIZE_THRESHOLD?e:function(e,t){for(var n=t;n<e;++n)if(e%n==0)return n;return e}(e,Math.floor(Math.sqrt(e)))}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t,n){this.variableNames=[\"A\"];var r=e.windowSize,o=e.batchSize,a=e.inSize,i=Math.ceil(a/r);n||this.variableNames.push(\"bestIndicesA\"),this.outputShape=[o,i];var s=\"max\"===t?\">\":\"<\",u=n?\"inOffset + i;\":\"round(getBestIndicesA(batch, inOffset + i));\";this.userCode=\"\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int outIdx = coords[1];\\n        int inOffset = outIdx * \"+r+\";\\n\\n        int bestIndex = 0;\\n        float bestValue = getA(batch, inOffset);\\n\\n        for (int i = 0; i < \"+r+\"; i++) {\\n          int inIdx = \"+u+\";\\n          float candidate = getA(batch, inIdx);\\n          if (isNaN(candidate)) {\\n            setOutput(candidate);\\n            return;\\n          }\\n          if (candidate \"+s+\" bestValue) {\\n            bestValue = candidate;\\n            bestIndex = inIdx;\\n          }\\n        }\\n        setOutput(float(bestIndex));\\n      }\\n    \"}}();t.ArgMinMaxProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e){this.variableNames=[\"dy\"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a=t-1-e.padInfo.top,i=n-1-e.padInfo.left,s=1/(t*n);this.userCode=\"\\n      const ivec2 pads = ivec2(\"+a+\", \"+i+\");\\n      const float avgMultiplier = float(\"+s+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n\\n        ivec2 dyRCCorner = coords.yz - pads;\\n        int dyRCorner = dyRCCorner.x;\\n        int dyCCorner = dyRCCorner.y;\\n\\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \"+t+\"; wR++) {\\n          float dyR = float(dyRCorner + wR) / \"+r+\".0;\\n\\n          if (dyR < 0.0 || dyR >= \"+e.outHeight+\".0 || fract(dyR) > 0.0) {\\n            continue;\\n          }\\n          int idyR = int(dyR);\\n\\n          for (int wC = 0; wC < \"+n+\"; wC++) {\\n            float dyC = float(dyCCorner + wC) / \"+o+\".0;\\n\\n            if (dyC < 0.0 || dyC >= \"+e.outWidth+\".0 ||\\n                fract(dyC) > 0.0) {\\n              continue;\\n            }\\n            int idyC = int(dyC);\\n\\n            float dyValue = getDy(b, idyR, idyC, d);\\n\\n            dotProd += dyValue * avgMultiplier;\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"}}();t.AvgPool2DBackpropProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(12),o=function(){return function(e,t,n,o,a,i){this.outputShape=[],this.supportsBroadcasting=!0,this.variableNames=[\"x\",\"mean\",\"variance\"],r.assertAndGetBroadcastShape(e,t),r.assertAndGetBroadcastShape(e,n);var s=\"0.0\";null!=o&&(r.assertAndGetBroadcastShape(e,o),this.variableNames.push(\"offset\"),s=\"getOffsetAtOutCoords()\");var u=\"1.0\";null!=a&&(r.assertAndGetBroadcastShape(e,a),this.variableNames.push(\"scale\"),u=\"getScaleAtOutCoords()\"),this.outputShape=e,this.userCode=\"\\n      void main() {\\n        float x = getXAtOutCoords();\\n        float mean = getMeanAtOutCoords();\\n        float variance = getVarianceAtOutCoords();\\n        float offset = \"+s+\";\\n        float scale = \"+u+\";\\n        float inv = scale / sqrt(variance + float(\"+i+\"));\\n        setOutput((x - mean) * inv + offset);\\n      }\\n    \"}}();t.BatchNormProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t,n){this.variableNames=[\"A\"],this.outputShape=e;var r=t.toFixed(20),o=n.toFixed(20);this.userCode=\"\\n      void main() {\\n        float value = getAAtOutCoords();\\n        if (isNaN(value)) {\\n          setOutput(value);\\n          return;\\n        }\\n\\n        setOutput(clamp(value, \"+r+\", \"+o+\"));\\n      }\\n    \"}}();t.ClipProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(19),o=function(){return function(e,t){this.variableNames=[\"A\",\"B\"],this.outputShape=[],this.outputShape=r.computeOutShape(e,t,1),this.userCode=\"\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int yR = coords.x;\\n        int yC = coords.y;\\n\\n        float value = 0.0;\\n        if (yC < \"+e[1]+\") {\\n          value = getA(yR, yC);\\n        } else {\\n          yC -= \"+e[1]+\";\\n          value = getB(yR, yC);\\n        }\\n\\n        setOutput(value);\\n      }\\n    \"}}();t.ConcatProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e){this.variableNames=[\"x\",\"dy\"],this.outputShape=e.filterShape;var t=e.strideHeight,n=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left;this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int wR = coords.x;\\n        int wC = coords.y;\\n        int d1 = coords.z;\\n        int d2 = coords.w;\\n\\n        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n\\n        for (int b = 0; b < \"+e.batchSize+\"; b++) {\\n          for (int yR = 0; yR < \"+e.outHeight+\"; yR++) {\\n            int xR = wR + yR * \"+t+\" - \"+r+\";\\n\\n            if (xR < 0 || xR >= \"+e.inHeight+\") {\\n              continue;\\n            }\\n\\n            for (int yC = 0; yC < \"+e.outWidth+\"; yC++) {\\n              int xC = wC + yC * \"+n+\" - \"+o+\";\\n\\n              if (xC < 0 || xC >= \"+e.inWidth+\") {\\n                continue;\\n              }\\n\\n              float dyValue = getDy(b, yR, yC, d2);\\n              float xValue = getX(b, xR, xC, d1);\\n              dotProd += (xValue * dyValue);\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"}}();t.Conv2DDerFilterProgram=r;var o=function(){return function(e){this.variableNames=[\"dy\",\"W\"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a=t-1-e.padInfo.top,i=n-1-e.padInfo.left;this.userCode=\"\\n      const ivec2 pads = ivec2(\"+a+\", \"+i+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int d1 = coords[3];\\n\\n        ivec2 dyCorner = coords.yz - pads;\\n        int dyRCorner = dyCorner.x;\\n        int dyCCorner = dyCorner.y;\\n\\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \"+t+\"; wR++) {\\n          float dyR = float(dyRCorner + wR) / \"+r+\".0;\\n\\n          if (dyR < 0.0 || dyR >= \"+e.outHeight+\".0 || fract(dyR) > 0.0) {\\n            continue;\\n          }\\n          int idyR = int(dyR);\\n\\n          int wRPerm = \"+t+\" - 1 - wR;\\n\\n          for (int wC = 0; wC < \"+n+\"; wC++) {\\n            float dyC = float(dyCCorner + wC) / \"+o+\".0;\\n\\n            if (dyC < 0.0 || dyC >= \"+e.outWidth+\".0 ||\\n                fract(dyC) > 0.0) {\\n              continue;\\n            }\\n            int idyC = int(dyC);\\n\\n            int wCPerm = \"+n+\" - 1 - wC;\\n\\n            for (int d2 = 0; d2 < \"+e.outChannels+\"; d2++) {\\n              float xValue = getDy(batch, idyR, idyC, d2);\\n              float wValue = getW(wRPerm, wCPerm, d1, d2);\\n              dotProd += xValue * wValue;\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"}}();t.Conv2DDerInputProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e){this.variableNames=[\"x\",\"W\"],this.outputShape=e.outShape;var t=e.padInfo.top,n=e.padInfo.left,r=e.strideHeight,o=e.strideWidth,a=e.filterHeight,i=e.filterWidth,s=4*Math.floor(e.inChannels/4),u=e.inChannels%4;this.userCode=\"\\n      const ivec2 strides = ivec2(\"+r+\", \"+o+\");\\n      const ivec2 pads = ivec2(\"+t+\", \"+n+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int d2 = coords[3];\\n\\n        ivec2 xRCCorner = coords.yz * strides - pads;\\n        int xRCorner = xRCCorner.x;\\n        int xCCorner = xRCCorner.y;\\n\\n        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \"+a+\"; wR++) {\\n          int xR = xRCorner + wR;\\n\\n          if (xR < 0 || xR >= \"+e.inHeight+\") {\\n            continue;\\n          }\\n\\n          for (int wC = 0; wC < \"+i+\"; wC++) {\\n            int xC = xCCorner + wC;\\n\\n            if (xC < 0 || xC >= \"+e.inWidth+\") {\\n              continue;\\n            }\\n\\n            for (int d1 = 0; d1 < \"+s+\"; d1 += 4) {\\n              vec4 xValues = vec4(\\n                getX(batch, xR, xC, d1),\\n                getX(batch, xR, xC, d1 + 1),\\n                getX(batch, xR, xC, d1 + 2),\\n                getX(batch, xR, xC, d1 + 3)\\n              );\\n              vec4 wValues = vec4(\\n                getW(wR, wC, d1, d2),\\n                getW(wR, wC, d1 + 1, d2),\\n                getW(wR, wC, d1 + 2, d2),\\n                getW(wR, wC, d1 + 3, d2)\\n              );\\n\\n              dotProd += dot(xValues, wValues);\\n            }\\n\\n            if (\"+(1===u)+\") {\\n              dotProd +=\\n                getX(batch, xR, xC, \"+s+\") *\\n                getW(wR, wC, \"+s+\", d2);\\n            } else if (\"+(2===u)+\") {\\n              vec2 xValues = vec2(\\n                getX(batch, xR, xC, \"+s+\"),\\n                getX(batch, xR, xC, \"+s+\" + 1)\\n              );\\n              vec2 wValues = vec2(\\n                getW(wR, wC, \"+s+\", d2),\\n                getW(wR, wC, \"+s+\" + 1, d2)\\n              );\\n              dotProd += dot(xValues, wValues);\\n            } else if (\"+(3===u)+\") {\\n              vec3 xValues = vec3(\\n                getX(batch, xR, xC, \"+s+\"),\\n                getX(batch, xR, xC, \"+s+\" + 1),\\n                getX(batch, xR, xC, \"+s+\" + 2)\\n              );\\n              vec3 wValues = vec3(\\n                getW(wR, wC, \"+s+\", d2),\\n                getW(wR, wC, \"+s+\" + 1, d2),\\n                getW(wR, wC, \"+s+\" + 2, d2)\\n              );\\n              dotProd += dot(xValues, wValues);\\n            }\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"}}();t.Conv2DProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e){this.variableNames=[\"x\",\"W\"],this.outputShape=e.outShape;var t=e.inHeight,n=e.inWidth,r=e.padInfo.top,o=e.padInfo.left,a=e.strideHeight,i=e.strideWidth,s=e.filterHeight,u=e.filterWidth,c=e.outChannels/e.inChannels;this.userCode=\"\\n      const ivec2 strides = ivec2(\"+a+\", \"+i+\");\\n      const ivec2 pads = ivec2(\"+r+\", \"+o+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords.x;\\n        ivec2 xRCCorner = coords.yz * strides - pads;\\n        int d2 = coords.w;\\n        int d1 = d2 / \"+c+\";\\n        int q = d2 - d1 * \"+c+\";\\n\\n        int xRCorner = xRCCorner.x;\\n        int xCCorner = xRCCorner.y;\\n\\n        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        // TODO(dsmilkov): Flatten the two for loops and vec4 the operations.\\n        for (int wR = 0; wR < \"+s+\"; wR++) {\\n          int xR = xRCorner + wR;\\n\\n          if (xR < 0 || xR >= \"+t+\") {\\n            continue;\\n          }\\n\\n          for (int wC = 0; wC < \"+u+\"; wC++) {\\n            int xC = xCCorner + wC;\\n\\n            if (xC < 0 || xC >= \"+n+\") {\\n              continue;\\n            }\\n\\n            float xVal = getX(batch, xR, xC, d1);\\n            float wVal = getW(wR, wC, d1, q);\\n            dotProd += xVal * wVal;\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"}}();t.DepthwiseConv2DProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e){this.variableNames=[\"A\"];var t=e[0],n=e[1];this.outputShape=e,this.userCode=\"\\n      void main() {\\n        ivec3 coords = getOutputCoords();\\n        int texR = coords[0];\\n        int texC = coords[1];\\n        int depth = coords[2];\\n        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(\"+n+\".0, \"+t+\".0);\\n\\n        vec4 values = texture2D(A, uv);\\n        float value;\\n        if (depth == 0) {\\n          value = values.r;\\n        } else if (depth == 1) {\\n          value = values.g;\\n        } else if (depth == 2) {\\n          value = values.b;\\n        } else if (depth == 3) {\\n          value = values.a;\\n        }\\n\\n        setOutput(floor(value * 255.0 + 0.5));\\n      }\\n    \"}}();t.FromPixelsProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(18),o=function(){return function(e,t,n){this.variableNames=[\"A\",\"indices\"];var o=e.slice();o[n]=t,this.outputShape=o,this.rank=o.length;var a=r.getCoordsDataType(this.rank),i=function(e,t){var n=e.length;if(n>4)throw Error(\"Gather for rank \"+n+\" is not yet supported\");if(1===n)return\"int(getIndices(resRC))\";for(var r=[\"resRC.x\",\"resRC.y\",\"resRC.z\",\"resRC.w\"],o=[],a=0;a<e.length;a++)a===t?o.push(\"int(getIndices(\"+r[a]+\"))\"):o.push(\"\"+r[a]);return o.join()}(e,n);this.userCode=\"\\n      void main() {\\n        \"+a+\" resRC = getOutputCoords();\\n        setOutput(getA(\"+i+\"));\\n      }\\n    \"}}();t.GatherProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(1),o=n(0),a=n(18),i=[\"uv\",\"clipSpacePos\"],s=\"NaN\";function u(){return!r.ENV.get(\"WEBGL_FLOAT_TEXTURE_ENABLED\")}function c(e,t){if(e.length!==t.length)throw Error(\"Binary was compiled with \"+e.length+\" inputs, but was executed with \"+t.length+\" inputs\");e.forEach(function(e,n){var r=e.logicalShape,a=e.texShape,i=t[n].tensor.shape,s=t[n].texData.texShape;if(!o.arraysEqual(r,i))throw Error(\"Binary was compiled with different shapes than the current args. Shapes \"+r+\" and \"+i+\" must match\");if(!o.arraysEqual(a,s))throw Error(\"Binary was compiled with different texture shapes than the current args. Shape \"+a+\" and \"+s+\" must match\")})}t.compileProgram=function(e,t,n,r){for(var o=t.userCode,c=n.map(function(e,n){var r={logicalShape:e.tensor.shape,texShape:e.texData.texShape};return{name:t.variableNames[n],shapeInfo:r}}),l=c.map(function(e){return e.shapeInfo}),p={logicalShape:r.tensor.shape,texShape:r.texData.texShape},h=a.makeShader(c,p,o,!0===t.supportsBroadcasting),d=e.createProgram(h),f={},m=0;m<t.variableNames.length;m++){var v=t.variableNames[m];f[v]=e.getUniformLocation(d,v)}var g={};i.forEach(function(t){g[t]=e.getAttributeLocation(d,t)}),u()&&(f[s]=e.getUniformLocation(d,s,!1));return{program:t,source:h,webGLProgram:d,uniformLocations:f,attributeLocations:g,gpgpu:e,inShapeInfos:l,outShapeInfo:p}},t.runProgram=function(e,t,n,r){c(e.inShapeInfos,t),c([e.outShapeInfo],[n]);var o=n.texData.texture,a=n.texData.texShape,i=e.gpgpu;i.setOutputMatrixTexture(o,a[0],a[1]),i.setProgram(e.webGLProgram),t.forEach(function(t,n){var r=t.texData.texture,o=e.program.variableNames[n],a=e.uniformLocations[o];i.setInputMatrixTexture(r,a,n)}),u()&&i.gl.uniform1f(e.uniformLocations[s],NaN),null!=r&&r(i,e.webGLProgram),i.executeProgram(e.attributeLocations)},t.makeShaderKey=function(e,t,n){var r=\"\";t.concat(n).forEach(function(e){r+=e.tensor.shape+\"_\"+e.texData.texShape});var o=e.userCode,a=(!0===e.supportsBroadcasting).toString(),i=e.constructor.name;return i+=\"_\"+a+\"_\"+r+\"_\"+o}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(18),o=function(){return function(e,t,n){var o,a;if(this.variableNames=[\"c\",\"a\",\"b\"],this.outputShape=t,n>4)throw Error(\"Where for rank \"+n+\" is not yet supported\");if(1===n)a=\"resRC\",o=\"resRC\";else{for(var i=[\"resRC.x\",\"resRC.y\",\"resRC.z\",\"resRC.w\"],s=[],u=[],c=0;c<t.length;c++)u.push(\"\"+i[c]),c<e&&s.push(\"\"+i[c]);o=s.join(),a=u.join()}var l=r.getCoordsDataType(n);this.userCode=\"\\n      void main() {\\n        \"+l+\" resRC = getOutputCoords();\\n        float cVal = getC(\"+o+\");\\n        if (cVal >= 1.0) {\\n          setOutput(getA(\"+a+\"));\\n        } else {\\n          setOutput(getB(\"+a+\"));\\n        }\\n      }\\n    \"}}();t.WhereProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t,n,r,o,a){this.variableNames=[\"x\"],this.outputShape=[];var i,s=t,u=e[1]-1,c=e[2]-1,l=e[3]-1;this.outputShape=e;var p=\"float(\"+n+\") + float(\"+r+\") * sum\";i=.5===o?\"inversesqrt(\"+p+\")\":1===o?\"1.0/(\"+p+\")\":\"exp(log(\"+p+\") * float(-\"+o+\"));\",this.userCode=\"withinChannel\"===a?\"\\n        void main() {\\n          ivec4 coords = getOutputCoords();\\n          int b = coords[0];\\n          int r = coords[1];\\n          int c = coords[2];\\n          int d = coords[3];\\n          float x = getX(b, r, c, d);\\n          float sum = 0.0;\\n          for (int u = -\"+s+\"; u <= \"+s+\"; u++) {\\n            for (int v = -\"+s+\"; v <= \"+s+\"; v++) {\\n              int idx = r + u;\\n              int idy = c + v;\\n              if (idx >= 0 && idx <= \"+u+\" && idy >= 0 && idy <= \"+c+\") {\\n                float z = getX(b, idx, idy, d);\\n                sum += z * z;\\n              }\\n            }\\n          }\\n          float val = x * \"+i+\";\\n          setOutput(val);\\n        }\\n      \":\"\\n        void main() {\\n          ivec4 coords = getOutputCoords();\\n          int b = coords[0];\\n          int r = coords[1];\\n          int c = coords[2];\\n          int d = coords[3];\\n          float x = getX(b, r, c, d);\\n          float sum = 0.0;\\n          for (int j = -\"+s+\"; j <= \"+s+\"; j++) {\\n            int idx = d + j;\\n            if (idx >= 0 && idx <=  \"+l+\") {\\n              float z = getX(b, r, c, idx);\\n              sum += z * z;\\n            }\\n          }\\n          float val = x * \"+i+\";\\n          setOutput(val);\\n        }\\n      \"}}();t.LRNProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e){this.variableNames=[\"dy\",\"maxPos\"],this.outputShape=e.inShape;var t=e.filterHeight,n=e.filterWidth,r=e.strideHeight,o=e.strideWidth,a=t-1-e.padInfo.top,i=n-1-e.padInfo.left,s=t*n-1;this.userCode=\"\\n      const ivec2 pads = ivec2(\"+a+\", \"+i+\");\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n\\n        ivec2 dyRCCorner = coords.yz - pads;\\n        int dyRCorner = dyRCCorner.x;\\n        int dyCCorner = dyRCCorner.y;\\n\\n        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).\\n        // ? = to be determined. : = across all values in that axis.\\n        float dotProd = 0.0;\\n        for (int wR = 0; wR < \"+t+\"; wR++) {\\n          float dyR = float(dyRCorner + wR) / \"+r+\".0;\\n\\n          if (dyR < 0.0 || dyR >= \"+e.outHeight+\".0 || fract(dyR) > 0.0) {\\n            continue;\\n          }\\n          int idyR = int(dyR);\\n\\n          for (int wC = 0; wC < \"+n+\"; wC++) {\\n            float dyC = float(dyCCorner + wC) / \"+o+\".0;\\n\\n            if (dyC < 0.0 || dyC >= \"+e.outWidth+\".0 ||\\n                fract(dyC) > 0.0) {\\n              continue;\\n            }\\n            int idyC = int(dyC);\\n\\n            float dyValue = getDy(b, idyR, idyC, d);\\n            int maxPosValue = \"+s+\" - int(getMaxPos(b, idyR, idyC, d));\\n\\n            // Get the current value, check it against the value from the\\n            // position matrix.\\n            int curPosValue = wR * \"+n+\" + wC;\\n            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);\\n\\n            dotProd += dyValue * mask;\\n          }\\n        }\\n        setOutput(dotProd);\\n      }\\n    \"}}();t.MaxPool2DBackpropProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t,n,r){void 0===n&&(n=!1),void 0===r&&(r=!1),this.variableNames=[\"matrixA\",\"matrixB\"];var o=n?e[1]:e[0],a=r?t[0]:t[1],i=n?e[0]:e[1];this.outputShape=[o,a];var s=function(e,t){return n?t+\" + \"+e+\", aRow\":\"aRow, \"+t+\" + \"+e},u=function(e,t){return r?\"bCol, \"+t+\" + \"+e:t+\" + \"+e+\", bCol\"},c=4*Math.floor(i/4),l=i%4;this.userCode=\" float dotARowBCol(int aRow, int bCol) {\\n      float result = 0.0;\\n      for (int i = 0; i < \"+c+\"; i += 4) {\\n        vec4 a = vec4(\\n          getMatrixA(\"+s(0,\"i\")+\"),\\n          getMatrixA(\"+s(1,\"i\")+\"),\\n          getMatrixA(\"+s(2,\"i\")+\"),\\n          getMatrixA(\"+s(3,\"i\")+\")\\n        );\\n        vec4 b = vec4(\\n          getMatrixB(\"+u(0,\"i\")+\"),\\n          getMatrixB(\"+u(1,\"i\")+\"),\\n          getMatrixB(\"+u(2,\"i\")+\"),\\n          getMatrixB(\"+u(3,\"i\")+\")\\n        );\\n\\n        result += dot(a, b);\\n      }\\n\\n      if (\"+(1===l)+\") {\\n        result += getMatrixA(\"+s(0,c)+\") *\\n          getMatrixB(\"+u(0,c)+\");\\n      } else if (\"+(2===l)+\") {\\n        vec2 a = vec2(\\n          getMatrixA(\"+s(0,c)+\"),\\n          getMatrixA(\"+s(1,c)+\")\\n        );\\n        vec2 b = vec2(\\n          getMatrixB(\"+u(0,c)+\"),\\n          getMatrixB(\"+u(1,c)+\")\\n        );\\n        result += dot(a, b);\\n      } else if (\"+(3===l)+\") {\\n        vec3 a = vec3(\\n          getMatrixA(\"+s(0,c)+\"),\\n          getMatrixA(\"+s(1,c)+\"),\\n          getMatrixA(\"+s(2,c)+\")\\n        );\\n        vec3 b = vec3(\\n          getMatrixB(\"+u(0,c)+\"),\\n          getMatrixB(\"+u(1,c)+\"),\\n          getMatrixB(\"+u(2,c)+\")\\n        );\\n        result += dot(a, b);\\n      }\\n\\n      return result;\\n    }\\n\\n    void main() {\\n      ivec2 resRC = getOutputCoords();\\n      setOutput(dotARowBCol(resRC.x, resRC.y));\\n    }\\n    \"}}();t.MatMulProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){function e(e,t,n){this.variableNames=[\"probs\"],this.outputShape=[e,n],this.userCode=\"\\n      uniform float seed;\\n\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int batch = coords[0];\\n\\n        float r = random(seed);\\n        float cdf = 0.0;\\n\\n        for (int i = 0; i < \"+(t-1)+\"; i++) {\\n          cdf += getProbs(batch, i);\\n\\n          if (r < cdf) {\\n            setOutput(float(i));\\n            return;\\n          }\\n        }\\n\\n        // If no other event happened, last event happened.\\n        setOutput(float(\"+(t-1)+\"));\\n      }\\n    \"}return e.prototype.getCustomSetupFunc=function(e){var t=this;return function(n,r){null==t.seedLoc&&(t.seedLoc=n.getUniformLocation(r,\"seed\")),n.gl.uniform1f(t.seedLoc,e)}},e}();t.MultinomialProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t,n,r){this.variableNames=[\"indices\"],this.outputShape=[e,t],this.userCode=\"\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int index = round(getIndices(coords.x));\\n        setOutput(mix(float(\"+r+\"), float(\"+n+\"),\\n                      float(index == coords.y)));\\n      }\\n    \"}}();t.OneHotProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t,n){this.variableNames=[\"x\"];var r=t[0],o=t[1];this.outputShape=[r+e[0]+o],this.rank=1,this.userCode=\"\\n      void main() {\\n        int resRC = getOutputCoords();\\n        if (resRC < \"+r+\" || resRC >= \"+r+\" + \"+e[0]+\") {\\n          setOutput(float(\"+n+\"));\\n        } else {\\n          setOutput(getX(resRC - \"+r+\"));\\n        }\\n      }\\n    \"}}();t.Pad1DProgram=r;var o=function(){return function(e,t,n){this.variableNames=[\"x\"];var r=t[0][0],o=t[0][1],a=t[1][0],i=t[1][1];this.outputShape=[r+e[0]+o,a+e[1]+i],this.rank=2;var s=\"resRC.x - \"+r+\", resRC.y - \"+a;this.userCode=\"\\n      void main() {\\n        ivec2 resRC = getOutputCoords();\\n        int topShape = \"+r+\" + \"+e[0]+\";\\n        int leftShape = \"+a+\" + \"+e[1]+\";\\n        if (resRC.x < \"+r+\" || resRC.x >= topShape ||\\n            resRC.y < \"+a+\" || resRC.y >= leftShape) {\\n          setOutput(float(\"+n+\"));\\n        } else {\\n          setOutput(getX(\"+s+\"));\\n        }\\n      }\\n    \"}}();t.Pad2DProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t,n){if(this.variableNames=[\"x\"],\"avg\"===t&&n)throw new Error(\"Cannot compute positions for average pool.\");var r=e.filterHeight,o=e.filterWidth,a=e.strideHeight,i=e.strideWidth,s=e.padInfo.top,u=e.padInfo.left;this.outputShape=e.outShape;var c=\"avg\"===t,l=\"0.0\";if(c||(l=\"min\"===t?\"1.0 / 0.0\":\"-1.0 / 0.0\"),n){var p=\"min\"===t?\"<=\":\">=\";this.userCode=\"\\n        const ivec2 strides = ivec2(\"+a+\", \"+i+\");\\n        const ivec2 pads = ivec2(\"+s+\", \"+u+\");\\n\\n        void main() {\\n          ivec4 coords = getOutputCoords();\\n          int batch = coords[0];\\n          int d = coords[3];\\n\\n          ivec2 xRCCorner = coords.yz * strides - pads;\\n          int xRCorner = xRCCorner.x;\\n          int xCCorner = xRCCorner.y;\\n\\n          // max/min x(?, ?, d) to get y(yR, yC, d).\\n          // ? = to be determined\\n          float minMaxValue = 0.0;\\n          float minMaxValueFound = 0.0;\\n          int minMaxPosition = 0;\\n          float avgValue = 0.0;\\n\\n          for (int wR = 0; wR < \"+r+\"; wR++) {\\n            int xR = xRCorner + wR;\\n\\n            if (xR < 0 || xR >= \"+e.inHeight+\") {\\n              continue;\\n            }\\n\\n            for (int wC = 0; wC < \"+o+\"; wC++) {\\n              int xC = xCCorner + wC;\\n\\n              if (xC < 0 || xC >= \"+e.inWidth+\") {\\n                continue;\\n              }\\n\\n              float value = getX(batch, xR, xC, d);\\n\\n              if (isNaN(value)) {\\n                setOutput(value);\\n                return;\\n              }\\n\\n              // If a min / max value has already been found, use it. If not,\\n              // use the current value.\\n              float currMinMaxValue = mix(\\n                  value, minMaxValue, minMaxValueFound);\\n              if (value \"+p+\" currMinMaxValue) {\\n                minMaxValue = value;\\n                minMaxValueFound = 1.0;\\n                minMaxPosition = wR * \"+o+\" + wC;\\n              }\\n            }\\n          }\\n          setOutput(float(minMaxPosition));\\n        }\\n      \"}else{var h=\"min\"===t?\"min\":\"max\",d=t+\"(\"+t+\"(\"+t+\"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])\";\"avg\"===t&&(d=\"avgValue / \"+r*o+\".0\");var f=4*Math.floor(o/4),m=o%4,v=\"\\n      if (hasNaN(values)) {\\n        setOutput(getNaN(values));\\n        return;\\n      }\\n      if (\"+c+\") {\\n        avgValue += dot(values, ones);\\n      } else {\\n        minMaxValue = \"+h+\"(values, minMaxValue);\\n      }\\n    \";this.userCode=\"\\n      const ivec2 strides = ivec2(\"+a+\", \"+i+\");\\n      const ivec2 pads = ivec2(\"+s+\", \"+u+\");\\n      const float initializationValue = \"+l+\";\\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\\n\\n      float getValue(int batch, int xR, int xC, int d) {\\n        if (xC < 0 || xC >= \"+e.inWidth+\") {\\n          return initializationValue;\\n        }\\n        return getX(batch, xR, xC, d);\\n      }\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int d = coords[3];\\n\\n        ivec2 xRCCorner = coords.yz * strides - pads;\\n        int xRCorner = xRCCorner.x;\\n        int xCCorner = xRCCorner.y;\\n\\n        // max/min x(?, ?, d) to get y(yR, yC, d).\\n        // ? = to be determined\\n        vec4 minMaxValue = vec4(\"+l+\");\\n        float avgValue = 0.0;\\n\\n        for (int wR = 0; wR < \"+r+\"; wR++) {\\n          int xR = xRCorner + wR;\\n\\n          if (xR < 0 || xR >= \"+e.inHeight+\") {\\n            continue;\\n          }\\n\\n          for (int wC = 0; wC < \"+f+\"; wC += 4) {\\n            int xC = xCCorner + wC;\\n\\n            vec4 values = vec4(\\n              getValue(batch, xR, xC, d),\\n              getValue(batch, xR, xC + 1, d),\\n              getValue(batch, xR, xC + 2, d),\\n              getValue(batch, xR, xC + 3, d)\\n            );\\n\\n            \"+v+\"\\n          }\\n\\n          int xC = xCCorner + \"+f+\";\\n          if (\"+(1===m)+\") {\\n            vec4 values = vec4(\\n              getValue(batch, xR, xC, d),\\n              initializationValue,\\n              initializationValue,\\n              initializationValue\\n            );\\n            \"+v+\"\\n          } else if (\"+(2===m)+\") {\\n            vec4 values = vec4(\\n              getValue(batch, xR, xC, d),\\n              getValue(batch, xR, xC + 1, d),\\n              initializationValue,\\n              initializationValue\\n            );\\n\\n            \"+v+\"\\n          } else if (\"+(3===m)+\") {\\n            vec4 values = vec4(\\n              getValue(batch, xR, xC, d),\\n              getValue(batch, xR, xC + 1, d),\\n              getValue(batch, xR, xC + 2, d),\\n              initializationValue\\n            );\\n\\n            \"+v+\"\\n          }\\n        }\\n        setOutput(\"+d+\");\\n      }\\n    \"}}}();t.Pool2DProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t){this.variableNames=[\"x\"];var n=e.windowSize,r=e.batchSize,o=e.inSize,a=Math.ceil(o/n);this.outputShape=[r,a];var i=\"sum\"===t,s=\"0.0\";i||(s=\"min\"===t?\"1.0 / 0.0\":\"-1.0 / 0.0\");var u=\"min\"===t?\"min\":\"max\",c=t+\"(\"+t+\"(\"+t+\"(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])\";\"sum\"===t&&(c=\"sumValue\");var l=4*Math.floor(n/4),p=n%4,h=\"\\n      if (\"+i+\") {\\n        sumValue += dot(values, ones);\\n      } else {\\n        if (hasNaN(values)) {\\n          setOutput(getNaN(values));\\n          return;\\n        }\\n        minMaxValue = \"+u+\"(values, minMaxValue);\\n      }\\n    \",d=\"\";o%n>0&&(d=\"\\n        if (inIdx < 0 || inIdx >= \"+o+\") {\\n          return initializationValue;\\n        }\\n      \"),this.userCode=\"\\n      const float initializationValue = \"+s+\";\\n      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);\\n\\n      float getValue(int batch, int inIdx) {\\n        \"+d+\"\\n        return getX(batch, inIdx);\\n      }\\n\\n      void main() {\\n        ivec2 coords = getOutputCoords();\\n        int batch = coords[0];\\n        int outIdx = coords[1];\\n        int inOffset = outIdx * \"+n+\";\\n\\n        vec4 minMaxValue = vec4(\"+s+\");\\n        float sumValue = 0.0;\\n\\n        for (int i = 0; i < \"+l+\"; i += 4) {\\n          int inIdx = inOffset + i;\\n          vec4 values = vec4(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            getValue(batch, inIdx + 2),\\n            getValue(batch, inIdx + 3)\\n          );\\n\\n          \"+h+\"\\n        }\\n\\n        int inIdx = inOffset + \"+l+\";\\n        if (\"+(1===p)+\") {\\n          vec4 values = vec4(\\n            getValue(batch, inIdx),\\n            initializationValue,\\n            initializationValue,\\n            initializationValue\\n          );\\n          \"+h+\"\\n        } else if (\"+(2===p)+\") {\\n          vec4 values = vec4(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            initializationValue,\\n            initializationValue\\n          );\\n          \"+h+\"\\n        } else if (\"+(3===p)+\") {\\n          vec4 values = vec4(\\n            getValue(batch, inIdx),\\n            getValue(batch, inIdx + 1),\\n            getValue(batch, inIdx + 2),\\n            initializationValue\\n          );\\n          \"+h+\"\\n        }\\n        setOutput(\"+c+\");\\n      }\\n    \"}}();t.ReduceProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t,n,r){this.variableNames=[\"A\"],this.outputShape=[];var o=e[0],a=e[1],i=e[2],s=e[3];this.outputShape=[o,t,n,s];var u=r?[a-1,i-1]:[a,i],c=r?[t-1,n-1]:[t,n];this.userCode=\"\\n      const vec2 effectiveInputOverOutputRatioRC = vec2(\\n          \"+u[0]/c[0]+\",\\n          \"+u[1]/c[1]+\");\\n      const vec2 inputShapeRC = vec2(\"+a+\".0, \"+i+\".0);\\n\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        int b = coords[0];\\n        int d = coords[3];\\n        ivec2 yRC = coords.yz;\\n\\n        // Fractional source index.\\n        vec2 sourceFracIndexRC = vec2(yRC) * effectiveInputOverOutputRatioRC;\\n\\n        // Compute the four integer indices.\\n        ivec2 sourceFloorRC = ivec2(sourceFracIndexRC);\\n        ivec2 sourceCeilRC = ivec2(\\n          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));\\n\\n        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);\\n        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);\\n        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);\\n        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);\\n\\n        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);\\n\\n        float top = topLeft + (topRight - topLeft) * fracRC.y;\\n        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;\\n        float newValue = top + (bottom - top) * fracRC.x;\\n\\n        setOutput(newValue);\\n      }\\n    \"}}();t.ResizeBilinearProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=function(){return function(e,t){this.variableNames=[\"x\"],this.outputShape=e;var n=function(n){return-1!==t.indexOf(n)&&1!==e[n]?e[n]+\" - coords[\"+n+\"] - 1\":\"coords[\"+n+\"]\"},r=n(0),o=n(1),a=n(2),i=n(3);this.userCode=\"\\n      void main() {\\n        ivec4 coords = getOutputCoords();\\n        float val = getX(\"+r+\", \"+o+\", \"+a+\", \"+i+\");\\n        setOutput(val);\\n      }\\n    \"}}();t.ReverseProgram=r},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(18),o=function(){function e(e){this.variableNames=[\"source\"],this.outputShape=e,this.rank=e.length;var t=r.getCoordsDataType(this.rank),n=function(e){if(1===e)return\"sourceLoc\";if(2===e)return\"sourceLoc.x, sourceLoc.y\";if(3===e)return\"sourceLoc.x, sourceLoc.y, sourceLoc.z\";if(4===e)return\"sourceLoc.x, sourceLoc.y, sourceLoc.z, sourceLoc.w\";throw Error(\"Slicing for rank \"+e+\" is not yet supported\")}(this.rank);this.userCode=\"\\n      uniform \"+t+\" start;\\n\\n      void main() {\\n        \"+t+\" sourceLoc = start + getOutputCoords();\\n        setOutput(getSource(\"+n+\"));\\n      }\\n    \"}return e.prototype.getCustomSetupFunc=function(e){var t=this;if(e.length!==this.rank)throw Error(\"The rank (\"+this.rank+\") of the program must match the length of start (\"+e.length+\")\");return function(n,r){if(null!=t.startLoc||(t.startLoc=n.getUniformLocationNoThrow(r,\"start\"),null!=t.startLoc))if(1===t.rank)n.gl.uniform1i(t.startLoc,e[0]);else if(2===t.rank)n.gl.uniform2i(t.startLoc,e[0],e[1]);else if(3===t.rank)n.gl.uniform3i(t.startLoc,e[0],e[1],e[2]);else{if(4!==t.rank)throw Error(\"Slicing for rank \"+t.rank+\" is not yet supported\");n.gl.uniform4i(t.startLoc,e[0],e[1],e[2],e[3])}}},e}();t.SliceProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(21),o=function(){function e(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this.freeTextures={},this.logEnabled=!1,this.allocatedTextures=[],this.usedTextureCount={}}return e.prototype.acquireTexture=function(e,t){void 0===t&&(t=r.TextureType.FLOAT);var n=a(e,t);if(n in this.freeTextures||(this.freeTextures[n]=[]),n in this.usedTextureCount||(this.usedTextureCount[n]=0),this.usedTextureCount[n]++,this.freeTextures[n].length>0)return this.numFreeTextures--,this.numUsedTextures++,this.log(),this.freeTextures[n].shift();this.numUsedTextures++,this.log();var o=this.gpgpu.createMatrixTexture(e[0],e[1]);return this.allocatedTextures.push(o),o},e.prototype.releaseTexture=function(e,t,n){void 0===n&&(n=r.TextureType.FLOAT);var o=a(t,n);o in this.freeTextures||(this.freeTextures[o]=[]),this.freeTextures[o].push(e),this.numFreeTextures++,this.numUsedTextures--,this.usedTextureCount[o]--,this.log()},e.prototype.log=function(){if(this.logEnabled){var e=this.numFreeTextures+this.numUsedTextures;console.log(\"Free/Used\",this.numFreeTextures+\" / \"+this.numUsedTextures,\"(\"+e+\")\")}},e.prototype.getNumUsedTextures=function(){return this.numUsedTextures},e.prototype.getNumFreeTextures=function(){return this.numFreeTextures},e.prototype.dispose=function(){var e=this;null!=this.allocatedTextures&&(this.allocatedTextures.forEach(function(t){e.gpgpu.deleteMatrixTexture(t)}),this.freeTextures=null,this.allocatedTextures=null,this.usedTextureCount=null,this.numUsedTextures=0,this.numFreeTextures=0)},e}();function a(e,t){return e[0]+\"_\"+e[1]+\"_\"+t}t.TextureManager=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(18),o=function(){return function(e,t){this.variableNames=[\"A\"];for(var n=new Array(e.length),o=0;o<n.length;o++)n[o]=e[o]*t[o];this.outputShape=n,this.rank=n.length;var a=r.getCoordsDataType(this.rank),i=function(e){var t=e.length;if(t>4)throw Error(\"Tile for rank \"+t+\" is not yet supported\");if(1===t)return\"imod(resRC, \"+e[0]+\")\";for(var n=[\"resRC.x\",\"resRC.y\",\"resRC.z\",\"resRC.w\"],r=[],o=0;o<e.length;o++)r.push(\"imod(\"+n[o]+\", \"+e[o]+\")\");return r.join()}(e);this.userCode=\"\\n      void main() {\\n        \"+a+\" resRC = getOutputCoords();\\n        setOutput(getA(\"+i+\"));\\n      }\\n    \"}}();t.TileProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(18),o=function(){return function(e,t){this.variableNames=[\"A\"];for(var n=new Array(e.length),o=0;o<n.length;o++)n[o]=e[t[o]];this.outputShape=n,this.rank=n.length;var a=r.getCoordsDataType(this.rank),i=function(e){var t=e.length;if(t>4)throw Error(\"Transpose for rank \"+t+\" is not yet supported\");for(var n=[\"resRC.x\",\"resRC.y\",\"resRC.z\",\"resRC.w\"],r=new Array(t),o=0;o<e.length;o++)r[e[o]]=n[o];return r.join()}(t);this.userCode=\"\\n    void main() {\\n      \"+a+\" resRC = getOutputCoords();\\n      setOutput(getA(\"+i+\"));\\n    }\\n    \"}}();t.TransposeProgram=o},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});t.version=\"0.5.0\"},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(2),o=function(){function e(e){this.urlPath=e,\"/\"!==this.urlPath.charAt(this.urlPath.length-1)&&(this.urlPath+=\"/\")}return e.prototype.loadManifest=function(){var e=this;return new Promise(function(t,n){var r=new XMLHttpRequest;r.open(\"GET\",e.urlPath+\"manifest.json\"),r.onload=function(){e.checkpointManifest=JSON.parse(r.responseText),t()},r.onerror=function(t){throw new Error(\"manifest.json not found at \"+e.urlPath+\". \"+t)},r.send()})},e.prototype.getCheckpointManifest=function(){var e=this;return null==this.checkpointManifest?new Promise(function(t,n){e.loadManifest().then(function(){t(e.checkpointManifest)})}):new Promise(function(t,n){t(e.checkpointManifest)})},e.prototype.getAllVariables=function(){var e=this;return null!=this.variables?new Promise(function(t,n){t(e.variables)}):new Promise(function(t,n){e.getCheckpointManifest().then(function(n){for(var r=Object.keys(e.checkpointManifest),o=[],a=0;a<r.length;a++)o.push(e.getVariable(r[a]));Promise.all(o).then(function(n){e.variables={};for(var o=0;o<n.length;o++)e.variables[r[o]]=n[o];t(e.variables)})})})},e.prototype.getVariable=function(e){var t=this;if(!(e in this.checkpointManifest))throw new Error(\"Cannot load non-existant variable \"+e);var n=function(n,o){var a=new XMLHttpRequest;a.responseType=\"arraybuffer\";var i=t.checkpointManifest[e].filename;a.open(\"GET\",t.urlPath+i),a.onload=function(){if(404===a.status)throw new Error(\"Not found variable \"+e);var o=new Float32Array(a.response),i=r.Tensor.make(t.checkpointManifest[e].shape,{values:o});n(i)},a.onerror=function(t){throw new Error(\"Could not fetch variable \"+e+\": \"+t)},a.send()};return null==this.checkpointManifest?new Promise(function(e,r){t.loadManifest().then(function(){new Promise(n).then(e)})}):new Promise(n)},e}();t.CheckpointLoader=o},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(0),a=function(){function e(e){this.inputs=e,this.idx=0,this.inputCounter=0,this.epoch=0,this.shuffledIndices=o.createShuffledIndices(e[0].length),this.numInputs=e.length;for(var t=this.inputs[0].length,n=0;n<this.numInputs;n++)o.assert(this.inputs[n].length===t,\"Number of examples must match across different inputs.\");for(n=0;n<this.numInputs;n++)for(var r=this.inputs[n][0].shape,a=0;a<this.inputs[n].length;a++)o.assertShapesMatch(r,this.inputs[n][a].shape)}return e.prototype.getCurrentExampleIndex=function(){var e=this.idx;return this.inputCounter++,this.inputCounter>=this.numInputs&&(this.idx++,this.inputCounter=0,this.idx>=this.inputs[0].length&&(this.idx=0,this.epoch++)),e},e.prototype.getNextInput=function(e){var t=this.getCurrentExampleIndex();return this.inputs[e][this.shuffledIndices[t]]},e.prototype.getEpoch=function(){return this.epoch},e.prototype.getInputProviders=function(){for(var e=[],t=0;t<this.numInputs;t++)e.push(this.getInputProvider(t));return e},e}();t.InMemoryShuffledInputProviderBuilder=a;var i=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getInputProvider=function(e){var t=this;return{getNextCopy:function(){return t.getNextInput(e).clone()},disposeCopy:function(e){e.dispose()}}},t}(a);t.InCPUMemoryShuffledInputProviderBuilder=i;var s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),t.prototype.getInputProvider=function(e){var t=this;return{getNextCopy:function(){return t.getNextInput(e).clone()},disposeCopy:function(e){e.dispose()}}},t}(a);t.InGPUMemoryShuffledInputProviderBuilder=s},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r,o=n(3),a=n(2),i=n(73);!function(e){e[e.SUM=0]=\"SUM\",e[e.MEAN=1]=\"MEAN\"}(r=t.MetricReduction||(t.MetricReduction={}));var s=function(){function e(e,t,n){this.math=e,this.session=t,this.eventObserver=n,this.lastCostTimestamp=0,this.lastEvalTimestamp=0,this.resetStatistics(),this.zeroScalar=a.Scalar.new(0)}return e.prototype.resetStatistics=function(){this.totalBatchesTrained=0},e.prototype.train=function(e,t,n,o,i,s,u,c,l,p,h){void 0===l&&(l=r.MEAN),void 0===p&&(p=1500),void 0===h&&(h=500),this.costTensor=e,this.trainFeedEntries=t,this.metricTensor=s,this.metricFeedEntries=u,null!=c&&this.metricBatchSize!==c&&(null!=this.metricBatchSizeScalar&&this.metricBatchSizeScalar.dispose(),this.metricBatchSizeScalar=a.Scalar.new(c)),this.metricBatchSize=c,this.metricReduction=l,this.batchSize=n,this.optimizer=o,this.metricIntervalMs=p,this.costIntervalMs=h,this.currentTrainLoopNumBatches=i,this.batchesTrainedThisRun=0,this.isTraining=!0,this.trainStartTimestamp=performance.now(),this.trainNetwork()},e.prototype.stopTraining=function(){this.isTraining=!1},e.prototype.resumeTraining=function(){this.isTraining=!0,this.trainNetwork()},e.prototype.trainNetwork=function(){var e=this;if(this.batchesTrainedThisRun===this.currentTrainLoopNumBatches&&this.stopTraining(),this.isTraining){var t=performance.now(),n=null!=this.eventObserver.avgCostCallback&&t-this.lastCostTimestamp>this.costIntervalMs;n&&(this.lastCostTimestamp=t);var r=n?i.CostReduction.MEAN:i.CostReduction.NONE;o.tidy(function(){var o=e.session.train(e.costTensor,e.trainFeedEntries,e.batchSize,e.optimizer,r);if(n){var a=performance.now()-t;if(e.eventObserver.avgCostCallback(o),null!=e.eventObserver.trainExamplesPerSecCallback){var i=1e3*e.batchSize/a;e.eventObserver.trainExamplesPerSecCallback(i)}}null!=e.eventObserver.metricCallback&&null!=e.metricFeedEntries&&t-e.lastEvalTimestamp>e.metricIntervalMs&&(e.lastEvalTimestamp=t,null!=e.lastComputedMetric&&e.lastComputedMetric.dispose(),e.lastComputedMetric=e.computeMetric(),e.eventObserver.metricCallback(e.lastComputedMetric)),null!=e.eventObserver.totalTimeCallback&&e.eventObserver.totalTimeCallback((t-e.trainStartTimestamp)/1e3),e.batchesTrainedThisRun++,e.totalBatchesTrained++,null!=e.eventObserver.batchesTrainedCallback&&e.eventObserver.batchesTrainedCallback(e.totalBatchesTrained)}),requestAnimationFrame(function(){return e.trainNetwork()})}else null!=this.eventObserver.doneTrainingCallback&&this.eventObserver.doneTrainingCallback()},e.prototype.infer=function(e,t,n,r,o){var i=this;if(void 0===n&&(n=3e3),void 0===r&&(r=5),null==this.eventObserver.inferenceExamplesCallback&&null==this.eventObserver.inferenceExamplesPerSecCallback)throw new Error(\"Cannot start inference loop, no inference example or examples/sec observer provided.\");for(var s=0;s<t.length;s++){if(t[s].data instanceof a.Tensor)throw new Error(\"Cannot start inference on the model runner with feed entries of type NDArray. Please use InputProviders.\")}this.inferenceExampleIntervalMs=n,this.inferenceTensor=e,this.inferenceFeedEntries=t,this.inferenceExampleCount=r,this.currentInferenceLoopNumPasses=o,this.isInferring||(this.inferencePassesThisRun=0,requestAnimationFrame(function(){return i.inferNetwork()})),this.isInferring=!0},e.prototype.inferNetwork=function(){var e=this;this.isInferring&&this.inferencePassesThisRun!==this.currentInferenceLoopNumPasses&&(o.tidy(function(){for(var t=[],n=[],r=performance.now(),o=0;o<e.inferenceExampleCount;o++){for(var a=[],i=0;i<e.inferenceFeedEntries.length;i++){var s=e.inferenceFeedEntries[i],u=s.data.getNextCopy();a.push({tensor:s.tensor,data:u})}t.push(a),n.push(e.session.eval(e.inferenceTensor,a))}if(null!=e.eventObserver.inferenceExamplesPerSecCallback){n[n.length-1].dataSync();var c=performance.now()-r,l=1e3*e.inferenceExampleCount/c;e.eventObserver.inferenceExamplesPerSecCallback(l)}null!=e.eventObserver.inferenceExamplesCallback&&e.eventObserver.inferenceExamplesCallback(t,n),e.inferencePassesThisRun++}),this.lastInferTimeoutID=window.setTimeout(function(){return e.inferNetwork()},this.inferenceExampleIntervalMs))},e.prototype.stopInferring=function(){this.isInferring=!1,window.clearTimeout(this.lastInferTimeoutID)},e.prototype.isInferenceRunning=function(){return this.isInferring},e.prototype.computeMetric=function(){var e=this;if(null==this.metricFeedEntries)throw new Error(\"Cannot compute metric, no metric FeedEntries provided.\");var t=this.zeroScalar;return o.tidy(function(){for(var n=0;n<e.metricBatchSize;n++){var o=e.session.eval(e.metricTensor,e.metricFeedEntries);t=e.math.add(t,o.toFloat())}return e.metricReduction===r.MEAN&&(t=e.math.divide(t,e.metricBatchSizeScalar)),t})},e.prototype.getTotalBatchesTrained=function(){return this.totalBatchesTrained},e.prototype.getLastComputedMetric=function(){return this.lastComputedMetric},e.prototype.setMath=function(e){this.math=e},e.prototype.setSession=function(e){this.session=e},e.prototype.setInferenceTensor=function(e){this.inferenceTensor=e},e.prototype.setInferenceExampleCount=function(e){this.inferenceExampleCount=e},e}();t.GraphRunner=s},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(22),o=n(8),a=n(139),i=n(140),s=n(141),u=n(142),c=n(143),l=n(144),p=n(145),h=n(147),d=n(149),f=n(150),m=n(151),v=n(152),g=n(153),y=n(154),b=n(155),x=n(156),w=n(157),E=n(158);t.emitFromGraphNodes=function(e){var t=[];return e.forEach(function(e){return Array.prototype.push.apply(t,function(e){if(e instanceof r.ReshapeNode)return[new x.Reshape(e.inputs[r.ReshapeNode.X],e.output)];if(e instanceof r.MatMulNode){var t=e.inputs[r.MatMulNode.X1],n=e.inputs[r.MatMulNode.X2];return[new v.MatMul(t,n,e.output)]}if(e instanceof r.Convolution2DNode){var T=e.inputs[r.Convolution2DNode.W],k=e.inputs[r.Convolution2DNode.X],S=e.inputs[r.Convolution2DNode.B];return[new c.Convolution2D(T,k,S,e.output,e.fieldSize,e.outputDepth,e.stride,e.zeroPad)]}if(e instanceof r.MaxPoolNode){var k=e.inputs[r.MaxPoolNode.X];return[new g.MaxPool(k,e.output,e.fieldSize,e.stride,e.zeroPad)]}if(e instanceof r.ExpNode)return[new d.Exp(e.inputs[r.ExpNode.X],e.output)];if(e instanceof r.LogNode)return[new m.Log(e.inputs[r.LogNode.X],e.output)];if(e instanceof r.ReLUNode)return[new p.ReLU(e.inputs[r.ReLUNode.X],e.output)];if(e instanceof r.LeakyReLUNode)return[new p.LeakyReLU(e.inputs[r.LeakyReLUNode.X],e.output,e.alpha)];if(e instanceof r.PReLUNode)return[new p.PReLU(e.inputs[r.PReLUNode.X],e.inputs[r.PReLUNode.ALPHA],e.output)];if(e instanceof r.EluNode)return[new p.Elu(e.inputs[r.EluNode.X],e.output)];if(e instanceof r.TanHNode)return[new p.TanH(e.inputs[r.TanHNode.X],e.output)];if(e instanceof r.SigmoidNode)return[new p.Sigmoid(e.inputs[r.SigmoidNode.X],e.output)];if(e instanceof r.SoftmaxCrossEntropyCostNode){var k=e.inputs[r.SoftmaxCrossEntropyCostNode.X],O=e.inputs[r.SoftmaxCrossEntropyCostNode.TARGET];return[new w.SoftmaxCrossEntropyCost(k,O,e.output)]}if(e instanceof r.SoftmaxNode)return[new w.Softmax(e.inputs[r.SoftmaxNode.X],e.output)];if(e instanceof r.MeanSquaredCostNode){var _=e.inputs[r.MeanSquaredCostNode.LABEL],A=e.inputs[r.MeanSquaredCostNode.PREDICTION];return[new h.MeanSquaredCost(_,A,e.output)]}if(e instanceof r.ArgMaxEqualsNode)return[new s.ArgMaxEquals(e.inputs[r.ArgMaxEqualsNode.X1],e.inputs[r.ArgMaxEqualsNode.X2],e.output)];if(e instanceof r.ArgMaxNode)return[new i.ArgMax(e.x,e.output)];if(e instanceof r.FusedLinearCombinationNode)return[new f.LinearCombination(e.inputs[r.FusedLinearCombinationNode.T1],e.inputs[r.FusedLinearCombinationNode.T2],e.inputs[r.FusedLinearCombinationNode.C1],e.inputs[r.FusedLinearCombinationNode.C2],e.output)];if(e instanceof r.Concat1DNode)return[new u.Concat1D(e.inputs[r.Concat1DNode.X1],e.inputs[r.Concat1DNode.X2],e.output)];if(e instanceof r.Concat2DNode)return[new u.Concat2D(e.inputs[r.Concat2DNode.X1],e.inputs[r.Concat2DNode.X2],e.axis,e.output)];if(e instanceof r.Concat3DNode)return[new u.Concat3D(e.inputs[r.Concat3DNode.X1],e.inputs[r.Concat3DNode.X2],e.axis,e.output)];if(e instanceof r.Concat4DNode)return[new u.Concat4D(e.inputs[r.Concat4DNode.X1],e.inputs[r.Concat4DNode.X2],e.axis,e.output)];if(e instanceof r.SquareNode)return[new p.Square(e.inputs[r.SquareNode.X],e.output)];if(e instanceof r.AddNode)return[new a.Add(e.inputs[r.AddNode.T1],e.inputs[r.AddNode.T2],e.output)];if(e instanceof r.SubtractNode)return[new E.Subtract(e.inputs[r.SubtractNode.T1],e.inputs[r.SubtractNode.T2],e.output)];if(e instanceof r.MultiplyNode)return[new y.Multiply(e.inputs[r.MultiplyNode.T1],e.inputs[r.MultiplyNode.T2],e.output)];if(e instanceof r.DivideNode)return[new l.Divide(e.inputs[r.DivideNode.T1],e.inputs[r.DivideNode.T2],e.output)];if(e instanceof r.ReduceSumNode)return[new b.ReduceSum(e.inputs[r.ReduceSumNode.X],e.output)];if(o.isInputNode(e))return[];throw Error(\"Unsupported node type: \"+e.constructor.name)}(e))}),t}},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(0),i=n(8),s=function(e){function t(t,n,r){var o=e.call(this)||this;return o.x1Tensor=t,o.x2Tensor=n,o.yTensor=r,a.assert(1===a.sizeFromShape(t.shape)||1===a.sizeFromShape(n.shape)||a.arraysEqual(t.shape,n.shape)||2===t.shape.length&&1===n.shape.length&&t.shape[1]===n.shape[0]||1===t.shape.length&&2===n.shape.length&&t.shape[0]===n.shape[1],\"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape, or one of them can be broadcasted (2D and 1D).\"),o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),i=t.get(this.x2Tensor);o.tidy(function(){var s;s=a.isScalarShape(r.shape)?e.scalarPlusArray(r,i):a.isScalarShape(i.shape)?e.scalarPlusArray(i,r):e.add(r,i),t.set(n.yTensor,o.keep(s))})},t.prototype.backProp=function(e,t,n){var r=this,s=n.get(this.yTensor);o.tidy(function(){if(i.shouldBackProp(r.x1Tensor))if(1===r.x1Tensor.shape.length&&2===r.x2Tensor.shape.length&&r.x1Tensor.shape[0]===r.x2Tensor.shape[1]){var t=e.sum(s,0);n.add(r.x1Tensor,t)}else if(a.isScalarShape(r.x1Tensor.shape)){t=e.sum(s);n.add(r.x1Tensor,t)}else n.add(r.x1Tensor,e.clone(s));if(i.shouldBackProp(r.x2Tensor))if(2===r.x1Tensor.shape.length&&1===r.x2Tensor.shape.length&&r.x1Tensor.shape[1]===r.x2Tensor.shape[0]){t=e.sum(s,0);n.add(r.x2Tensor,t)}else if(a.isScalarShape(r.x2Tensor.shape)){t=e.sum(s);n.add(r.x2Tensor,t)}else n.add(r.x2Tensor,e.clone(s))})},t.prototype.dispose=function(){null!=this.dySizeScalar&&this.dySizeScalar.dispose()},t}(n(7).Operation);t.Add=s},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=function(e){function t(t,n){var r=e.call(this)||this;return r.xTensor=t,r.yTensor=n,r}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.xTensor);o.tidy(function(){t.set(n.yTensor,o.keep(e.argMax(r)))})},t.prototype.backProp=function(e,t,n){throw new Error(\"ArgMax backprop unimplemented\")},t}(n(7).Operation);t.ArgMax=a},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=function(e){function t(t,n,r){var o=e.call(this)||this;return o.x1Tensor=t,o.x2Tensor=n,o.yTensor=r,o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),a=t.get(this.x2Tensor);o.tidy(function(){t.set(n.yTensor,o.keep(e.argMaxEquals(r,a)))})},t.prototype.backProp=function(e,t,n){throw new Error(\"ArgMaxEquals backprop unimplemented\")},t}(n(7).Operation);t.ArgMaxEquals=a},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(19),i=n(0),s=n(7),u=function(e){function t(t,n,r){var o=e.call(this)||this;return o.x1Tensor=t,o.x2Tensor=n,o.yTensor=r,o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),a=t.get(this.x2Tensor);o.tidy(function(){var i=e.concat1D(r,a);t.set(n.yTensor,o.keep(i))})},t.prototype.backProp=function(e,t,n){var r=this;o.tidy(function(){h(e,r.x1Tensor,r.x2Tensor,r.yTensor,0,n,t)})},t}(s.Operation);t.Concat1D=u;var c=function(e){function t(t,n,r,o){var i=e.call(this)||this;return i.x1Tensor=t,i.x2Tensor=n,i.axis=r,i.yTensor=o,a.assertParams(t.shape,n.shape,r),i}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),a=t.get(this.x2Tensor);o.tidy(function(){var i=e.concat2D(r,a,n.axis);t.set(n.yTensor,o.keep(i))})},t.prototype.backProp=function(e,t,n){var r=this;o.tidy(function(){h(e,r.x1Tensor,r.x2Tensor,r.yTensor,r.axis,n,t)})},t}(s.Operation);t.Concat2D=c;var l=function(e){function t(t,n,r,o){var i=e.call(this)||this;return i.x1Tensor=t,i.x2Tensor=n,i.axis=r,i.yTensor=o,a.assertParams(t.shape,n.shape,r),i}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),a=t.get(this.x2Tensor);o.tidy(function(){var i=e.concat3D(r,a,n.axis);t.set(n.yTensor,o.keep(i))})},t.prototype.backProp=function(e,t,n){var r=this;o.tidy(function(){h(e,r.x1Tensor,r.x2Tensor,r.yTensor,r.axis,n,t)})},t}(s.Operation);t.Concat3D=l;var p=function(e){function t(t,n,r,o){var i=e.call(this)||this;return i.x1Tensor=t,i.x2Tensor=n,i.axis=r,i.yTensor=o,a.assertParams(t.shape,n.shape,r),i}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),a=t.get(this.x2Tensor);o.tidy(function(){var i=e.concat4D(r,a,n.axis);t.set(n.yTensor,o.keep(i))})},t.prototype.backProp=function(e,t,n){var r=this;o.tidy(function(){h(e,r.x1Tensor,r.x2Tensor,r.yTensor,r.axis,n,t)})},t}(s.Operation);function h(e,t,n,r,o,s,u){var c=s.get(r),l=u.get(t),p=u.get(n),h=l.as2D(-1,i.sizeFromShape(l.shape.slice(o))),d=p.as2D(-1,i.sizeFromShape(p.shape.slice(o))),f=a.computeGradientSliceShapes(h.shape,d.shape),m=f.aBegin,v=f.aSize,g=f.bBegin,y=f.bSize,b=c.as2D(-1,h.shape[1]+d.shape[1]),x=e.slice2D(b,m,v).reshapeAs(l),w=e.slice2D(b,g,y).reshapeAs(p);s.add(t,x),s.add(n,w)}t.Concat4D=p},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(16),i=n(0),s=function(e){function t(t,n,r,o,s,u,c,l){void 0===c&&(c=1);var p=e.call(this)||this;return p.wTensor=t,p.xTensor=n,p.bTensor=r,p.yTensor=o,p.fieldSize=s,p.outputDepth=u,p.stride=c,p.assertWeightsShape(t.shape),p.zeroPad=null!=l?l:a.computeDefaultPad(p.xTensor.shape,p.fieldSize,p.stride),i.assert(i.isInt(p.zeroPad),\"The zero padding (\"+p.zeroPad+\") must be an integer. Change the stride and/or zero pad parameters\"),p}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.wTensor),a=t.get(this.bTensor),i=t.get(this.xTensor);o.tidy(function(){t.set(n.yTensor,o.keep(e.conv2d(i,r,a,n.stride,n.zeroPad)))})},t.prototype.backProp=function(e,t,n){var r=this,a=t.get(this.wTensor),i=t.get(this.xTensor),s=n.get(this.yTensor);o.tidy(function(){var t=e.conv2dDerFilter(i,s,a.shape,r.stride,r.zeroPad),o=e.sum(s,[0,1]),u=e.conv2dDerInput(i.shape,s,a,r.stride,r.zeroPad);n.add(r.wTensor,t),n.add(r.bTensor,o),n.add(r.xTensor,u)})},t.prototype.assertWeightsShape=function(e){i.assert(e[0]===this.fieldSize&&e[1]===this.fieldSize&&e[2]===this.xTensor.shape[2]&&e[3]===this.outputDepth,\"weights must be of shape [\"+this.fieldSize+\",\"+this.fieldSize+\",\"+this.xTensor.shape[2]+\",\"+this.outputDepth+\"] but they are ofshape [\"+e+\"]\")},t}(n(7).Operation);t.Convolution2D=s},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(0),i=n(8),s=function(e){function t(t,n,r){var o=e.call(this)||this;return o.x1Tensor=t,o.x2Tensor=n,o.yTensor=r,a.assert(1===a.sizeFromShape(t.shape)||1===a.sizeFromShape(n.shape)||a.arraysEqual(t.shape,n.shape),\"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape\"),o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),i=t.get(this.x2Tensor);o.tidy(function(){var s;s=a.isScalarShape(r.shape)?e.scalarDividedByArray(r,i):a.isScalarShape(i.shape)?e.arrayDividedByScalar(r,i):e.divide(r,i),t.set(n.yTensor,o.keep(s))})},t.prototype.backProp=function(e,t,n){var r=this,s=t.get(this.x1Tensor),u=t.get(this.x2Tensor),c=n.get(this.yTensor),l=a.isScalarShape(s.shape),p=a.isScalarShape(u.shape);o.tidy(function(){if(i.shouldBackProp(r.x1Tensor))if(l){var t=e.divide(c,u);n.add(r.x1Tensor,e.sum(t)),t.dispose()}else p?n.add(r.x1Tensor,e.arrayDividedByScalar(c,u)):n.add(r.x1Tensor,e.divide(c,u));if(i.shouldBackProp(r.x2Tensor)){var o=e.elementWiseMul(u,u),a=void 0;a=p?e.arrayDividedByScalar(s,o):l?e.scalarDividedByArray(s,o):e.divide(s,o);var h=e.neg(a),d=e.elementWiseMul(c,h);p?n.add(r.x2Tensor,e.sum(d)):n.add(r.x2Tensor,d)}})},t}(n(7).Operation);t.Divide=s},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(146),i=n(7),s=function(e){function t(t,n,r){var o=e.call(this)||this;return o.xTensor=t,o.yTensor=n,o.func=r,o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.xTensor);o.tidy(function(){t.set(n.yTensor,o.keep(n.func.output(e,r)))})},t.prototype.backProp=function(e,t,n){var r=this,a=t.get(this.xTensor),i=t.get(this.yTensor),s=n.get(this.yTensor);o.tidy(function(){var t=r.func.der(e,a,i);n.add(r.xTensor,e.elementWiseMul(s,t)),t.dispose()})},t.prototype.dispose=function(){this.func.dispose()},t}(i.Operation);t.ElementWiseActivation=s;var u=function(e){function t(t,n){return e.call(this,t,n,new a.ReLUFunc)||this}return r(t,e),t}(s);t.ReLU=u;var c=function(e){function t(t,n,r){return e.call(this,t,n,new a.LeakyReluFunc(r))||this}return r(t,e),t}(s);t.LeakyReLU=c;var l=function(e){function t(t,n){return e.call(this,t,n,new a.TanHFunc)||this}return r(t,e),t}(s);t.TanH=l;var p=function(e){function t(t,n){return e.call(this,t,n,new a.SigmoidFunc)||this}return r(t,e),t}(s);t.Sigmoid=p;var h=function(e){function t(t,n){return e.call(this,t,n,new a.SquareFunc)||this}return r(t,e),t}(s);t.Square=h;var d=function(e){function t(t,n){return e.call(this,t,n,new a.EluFunc)||this}return r(t,e),t}(s);t.Elu=d;var f=function(e){function t(t,n,r){var o=e.call(this)||this;return o.xTensor=t,o.alphaTensor=n,o.yTensor=r,o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.xTensor),a=t.get(this.alphaTensor);o.tidy(function(){t.set(n.yTensor,o.keep(e.prelu(r,a)))})},t.prototype.backProp=function(e,t,n){throw new Error(\"Not implemented\")},t}(i.Operation);t.PReLU=f},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(3),o=n(2),a=function(){function e(){this.one=o.Scalar.new(1)}return e.prototype.output=function(e,t){return e.tanh(t)},e.prototype.der=function(e,t,n){var o=this;return r.tidy(function(){var t=e.multiplyStrict(n,n);return e.subtract(o.one,t)})},e.prototype.dispose=function(){this.one.dispose()},e}();t.TanHFunc=a;var i=function(){function e(){}return e.prototype.output=function(e,t){return e.relu(t)},e.prototype.der=function(e,t,n){return e.step(t)},e.prototype.dispose=function(){},e}();t.ReLUFunc=i;var s=function(){function e(e){this.alpha=e}return e.prototype.output=function(e,t){return e.leakyRelu(t,this.alpha)},e.prototype.der=function(e,t,n){return e.step(t,this.alpha)},e.prototype.dispose=function(){},e}();t.LeakyReluFunc=s;var u=function(){function e(){}return e.prototype.output=function(e,t){return e.sigmoid(t)},e.prototype.der=function(e,t,n){return r.tidy(function(){var t=e.multiplyStrict(n,n);return e.subStrict(n,t)})},e.prototype.dispose=function(){},e}();t.SigmoidFunc=u;var c=function(){function e(){this.two=o.Scalar.new(2)}return e.prototype.output=function(e,t){return e.multiplyStrict(t,t)},e.prototype.der=function(e,t,n){return e.multiply(this.two,t)},e.prototype.dispose=function(){this.two.dispose()},e}();t.SquareFunc=c;var l=function(){function e(){}return e.prototype.output=function(e,t){return e.elu(t)},e.prototype.der=function(e,t,n){throw new Error(\"Not implemented\")},e.prototype.dispose=function(){},e}();t.EluFunc=l},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(2),s=n(0),u=n(148),c=n(8),l=function(e){function t(t,n,r,a){var u=e.call(this)||this;return u.x1Tensor=t,u.x2Tensor=n,u.yTensor=r,u.func=a,u.oneOverNScalar=o.ENV.math.keep(i.Scalar.new(1/s.sizeFromShape(t.shape))),u}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),o=t.get(this.x2Tensor);a.tidy(function(){var i=n.func.cost(r,o),s=e.sum(i),u=e.scalarTimesArray(n.oneOverNScalar,s);t.set(n.yTensor,a.keep(u))})},t.prototype.backProp=function(e,t,n){var r=this,o=t.get(this.x1Tensor),i=t.get(this.x2Tensor);a.tidy(function(){c.shouldBackProp(r.x1Tensor)&&n.add(r.x1Tensor,r.func.der(o,i)),c.shouldBackProp(r.x2Tensor)&&n.add(r.x2Tensor,r.func.der(i,o))})},t.prototype.dispose=function(){this.func.dispose(),this.oneOverNScalar.dispose()},t}(n(7).Operation);t.ElementWiseCost=l;var p=function(e){function t(t,n,r){return e.call(this,t,n,r,new u.SquareCostFunc)||this}return r(t,e),t}(l);t.MeanSquaredCost=p},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(3),o=n(5),a=function(){function e(){this.halfOne=r.keep(o.scalar(.5))}return e.prototype.cost=function(e,t){var n=e.subStrict(t),r=n.square(),o=this.halfOne.mul(r);return n.dispose(),r.dispose(),o},e.prototype.der=function(e,t){return e.subStrict(t)},e.prototype.dispose=function(){this.halfOne.dispose()},e}();t.SquareCostFunc=a},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(8),i=function(e){function t(t,n){var r=e.call(this)||this;return r.xTensor=t,r.yTensor=n,r}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.xTensor);o.tidy(function(){t.set(n.yTensor,o.keep(e.exp(r)))})},t.prototype.backProp=function(e,t,n){var r=this,i=t.get(this.yTensor),s=n.get(this.yTensor);o.tidy(function(){a.shouldBackProp(r.xTensor)&&n.add(r.xTensor,e.elementWiseMul(i,s))})},t}(n(7).Operation);t.Exp=i},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(8),i=function(e){function t(t,n,r,o,a){var i=e.call(this)||this;return i.x1Tensor=t,i.x2Tensor=n,i.c1Tensor=r,i.c2Tensor=o,i.outTensor=a,i}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),a=t.get(this.x2Tensor),i=t.get(this.c1Tensor).asScalar(),s=t.get(this.c2Tensor).asScalar();o.tidy(function(){t.set(n.outTensor,o.keep(e.scaledArrayAdd(i,r,s,a)))})},t.prototype.backProp=function(e,t,n){var r=this,i=t.get(this.x1Tensor),s=t.get(this.x2Tensor),u=t.get(this.c1Tensor),c=t.get(this.c2Tensor),l=n.get(this.outTensor);o.tidy(function(){if(a.shouldBackProp(r.x1Tensor)&&n.add(r.x1Tensor,e.scalarTimesArray(u,l)),a.shouldBackProp(r.x2Tensor)&&n.add(r.x2Tensor,e.scalarTimesArray(c,l)),a.shouldBackProp(r.c1Tensor)){var t=e.elementWiseMul(i,l);n.add(r.c1Tensor,e.sum(t))}if(a.shouldBackProp(r.c2Tensor)){var o=e.elementWiseMul(s,l);n.add(r.c2Tensor,e.sum(o))}})},t}(n(7).Operation);t.LinearCombination=i},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(8),i=function(e){function t(t,n){var r=e.call(this)||this;return r.xTensor=t,r.yTensor=n,r}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.xTensor);o.tidy(function(){t.set(n.yTensor,o.keep(e.log(r)))})},t.prototype.backProp=function(e,t,n){var r=this,i=t.get(this.xTensor),s=n.get(this.yTensor);o.tidy(function(){a.shouldBackProp(r.xTensor)&&n.add(r.xTensor,e.divide(s,i))})},t}(n(7).Operation);t.Log=i},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(8),i=function(e){function t(t,n,r){var o=e.call(this)||this;return o.x1Tensor=t,o.x2Tensor=n,o.yTensor=r,o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),a=t.get(this.x2Tensor);o.tidy(function(){2===r.shape.length&&2===a.shape.length?t.set(n.yTensor,o.keep(e.matMul(r,a))):2===r.shape.length&&1===a.shape.length?t.set(n.yTensor,o.keep(e.matrixTimesVector(r,a))):1===r.shape.length&&2===a.shape.length&&t.set(n.yTensor,o.keep(e.vectorTimesMatrix(r,a)))})},t.prototype.backProp=function(e,t,n){var r=this,i=t.get(this.x1Tensor),s=t.get(this.x2Tensor),u=n.get(this.yTensor);1===i.shape.length&&(i=i.reshape([1,i.size]),u=u.reshape([1,u.size])),1===s.shape.length&&(s=s.reshape([s.size,1]),u=u.reshape([u.size,1])),o.tidy(function(){if(a.shouldBackProp(r.x1Tensor)){var t=e.matMul(u,s,!1,!0);n.add(r.x1Tensor,1===r.x1Tensor.shape.length?t.as1D():t)}if(a.shouldBackProp(r.x2Tensor)){var o=e.matMul(i,u,!0,!1);n.add(r.x2Tensor,1===r.x2Tensor.shape.length?o.as1D():o)}})},t}(n(7).Operation);t.MatMul=i},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(16),i=n(0),s=function(e){function t(t,n,r,o,s){void 0===o&&(o=1);var u=e.call(this)||this;return u.xTensor=t,u.yTensor=n,u.fieldSize=r,u.stride=o,u.pad=null!=s?s:a.computeDefaultPad(t.shape,u.fieldSize,u.stride),i.assert(i.isInt(u.pad),\"The zero padding (\"+u.pad+\") must be an integer. Change the stride and/or zero pad parameters\"),u}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.xTensor);o.tidy(function(){t.set(n.yTensor,o.keep(e.maxPool(r,n.fieldSize,n.stride,n.pad)))})},t.prototype.backProp=function(e,t,n){var r=this,a=t.get(this.xTensor),i=n.get(this.yTensor);o.tidy(function(){n.add(r.xTensor,e.maxPoolBackprop(i,a,r.fieldSize,r.stride,r.pad))})},t}(n(7).Operation);t.MaxPool=s},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(0),i=n(8),s=function(e){function t(t,n,r){var o=e.call(this)||this;return o.x1Tensor=t,o.x2Tensor=n,o.yTensor=r,a.assert(1===a.sizeFromShape(t.shape)||1===a.sizeFromShape(n.shape)||a.arraysEqual(t.shape,n.shape),\"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape\"),o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x1Tensor),i=t.get(this.x2Tensor);o.tidy(function(){var s;s=a.isScalarShape(r.shape)?e.scalarTimesArray(r,i):a.isScalarShape(i.shape)?e.scalarTimesArray(i,r):e.elementWiseMul(r,i),t.set(n.yTensor,o.keep(s))})},t.prototype.backProp=function(e,t,n){var r=this,s=t.get(this.x1Tensor),u=t.get(this.x2Tensor),c=n.get(this.yTensor);o.tidy(function(){if(i.shouldBackProp(r.x1Tensor))if(a.isScalarShape(r.x1Tensor.shape)){var t=e.elementWiseMul(c,u);n.add(r.x1Tensor,e.sum(t))}else a.isScalarShape(u.shape)?n.add(r.x1Tensor,e.scalarTimesArray(u,c)):n.add(r.x1Tensor,e.elementWiseMul(u,c));if(i.shouldBackProp(r.x2Tensor))if(a.isScalarShape(r.x2Tensor.shape)){t=e.elementWiseMul(c,s);n.add(r.x2Tensor,e.sum(t))}else a.isScalarShape(s.shape)?n.add(r.x2Tensor,e.scalarTimesArray(s,c)):n.add(r.x2Tensor,e.elementWiseMul(s,c))})},t}(n(7).Operation);t.Multiply=s},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(2),s=n(0),u=n(8),c=function(e){function t(t,n){var r=e.call(this)||this;return r.x=t,r.outTensor=n,s.assertShapesMatch(n.shape,[]),r.ones=o.ENV.math.keep(i.Tensor.ones(t.shape)),r}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.x);a.tidy(function(){t.set(n.outTensor,a.keep(e.sum(r)))})},t.prototype.backProp=function(e,t,n){var r=this;u.shouldBackProp(this.x)&&a.tidy(function(){var t=n.get(r.outTensor);n.add(r.x,e.scalarTimesArray(t,r.ones))})},t.prototype.dispose=function(){this.ones.dispose()},t}(n(7).Operation);t.ReduceSum=c},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(0),i=function(e){function t(t,n){var r=e.call(this)||this;r.xTensor=t,r.yTensor=n;var o=a.sizeFromShape(t.shape),i=a.sizeFromShape(n.shape);return a.assert(o===i,\"The input size (\"+o+\") and output size (\"+i+\") must match\"),r}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.xTensor),a=e.clone(r);o.tidy(function(){t.set(n.yTensor,o.keep(a.reshape(n.yTensor.shape)))})},t.prototype.backProp=function(e,t,n){var r=this,a=n.get(this.yTensor),i=e.clone(a);o.tidy(function(){n.add(r.xTensor,i.reshape(r.xTensor.shape))})},t}(n(7).Operation);t.Reshape=i},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(1),a=n(3),i=n(2),s=n(0),u=n(22),c=n(8),l=n(7),p=function(e){function t(t,n){var r=e.call(this)||this;return r.logitsTensor=t,r.output=n,r}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.logitsTensor);return a.tidy(function(){t.set(n.output,a.keep(e.softmax(r)))})},t.prototype.backProp=function(e,t,n){var r=this,o=t.get(this.output),i=n.get(this.output);a.tidy(function(){if(c.shouldBackProp(r.logitsTensor)){var t=e.elementWiseMul(e.subtract(i,e.sum(e.elementWiseMul(i,o))),o);n.add(r.logitsTensor,t)}})},t}(l.Operation);t.Softmax=p;var h=function(e){function t(t,n,r){var a=e.call(this)||this;return a.logitsTensor=t,a.labelTensor=n,a.yTensor=r,a.softmaxTensor=new u.SymbolicTensor(t.shape),a.epsilon=o.ENV.math.keep(i.Scalar.new(1e-5)),a}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.logitsTensor),o=t.get(this.labelTensor);a.tidy(function(){var i=e.softmax(r);t.set(n.softmaxTensor,a.keep(i)),t.set(n.yTensor,a.keep(d(e,i,o,n.epsilon)))})},t.prototype.backProp=function(e,t,n){var r=this,o=t.get(this.softmaxTensor),i=t.get(this.labelTensor);a.tidy(function(){n.add(r.logitsTensor,e.subtract(o,i))})},t.prototype.disposeTransientArrays=function(e,t){e.disposeArray(this.softmaxTensor)},t.prototype.dispose=function(){this.epsilon.dispose()},t}(l.Operation);function d(e,t,n,r){return s.assert(t.size===n.size,\"The output and target must be the same size\"),a.tidy(function(){var o=e.scalarPlusArray(r,t),a=e.log(o),i=e.elementWiseMul(n,a),s=e.neg(i);return e.sum(s)})}t.SoftmaxCrossEntropyCost=h,t.crossEntropyCost=d},function(e,t,n){\"use strict\";var r=this&&this.__extends||function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(3),a=n(0),i=n(8),s=function(e){function t(t,n,r){var o=e.call(this)||this;return o.t1=t,o.t2=n,o.outTensor=r,a.assert(1===a.sizeFromShape(t.shape)||1===a.sizeFromShape(n.shape)||a.arraysEqual(t.shape,n.shape),\"One of t1 or t2 must be a scalar, or t1 and t2 must have the same shape\"),o}return r(t,e),t.prototype.feedForward=function(e,t){var n=this,r=t.get(this.t1),i=t.get(this.t2);o.tidy(function(){var s;s=a.isScalarShape(r.shape)?e.scalarMinusArray(r,i):a.isScalarShape(i.shape)?e.arrayMinusScalar(r,i):e.subtract(r,i),t.set(n.outTensor,o.keep(s))})},t.prototype.backProp=function(e,t,n){var r=this,s=n.get(this.outTensor);o.tidy(function(){if(i.shouldBackProp(r.t1))if(a.isScalarShape(r.t1.shape)){var t=e.sum(s);n.add(r.t1,t)}else n.add(r.t1,e.clone(s));if(i.shouldBackProp(r.t2))if(a.isScalarShape(r.t2.shape)){t=e.sum(s);var o=e.neg(t);n.add(r.t2,o)}else n.add(r.t2,e.neg(s))})},t.prototype.dispose=function(){null!=this.dySizeScalar&&this.dySizeScalar.dispose()},t}(n(7).Operation);t.Subtract=s},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(31),o=n(32),a=n(33),i=n(34),s=n(35),u=n(160),c=n(36),l=n(27);s.MomentumOptimizer,l.SGDOptimizer,r.AdadeltaOptimizer,o.AdagradOptimizer,c.RMSPropOptimizer,i.AdamaxOptimizer,a.AdamOptimizer,t.train={sgd:u.OptimizerConstructors.sgd,momentum:u.OptimizerConstructors.momentum,adadelta:u.OptimizerConstructors.adadelta,adagrad:u.OptimizerConstructors.adagrad,rmsprop:u.OptimizerConstructors.rmsprop,adamax:u.OptimizerConstructors.adamax,adam:u.OptimizerConstructors.adam}},function(e,t,n){\"use strict\";var r=this&&this.__decorate||function(e,t,n,r){var o,a=arguments.length,i=a<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if(\"object\"==typeof Reflect&&\"function\"==typeof Reflect.decorate)i=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(t,n,i):o(t,n))||i);return a>3&&i&&Object.defineProperty(t,n,i),i};Object.defineProperty(t,\"__esModule\",{value:!0});var o=n(4),a=n(31),i=n(32),s=n(33),u=n(34),c=n(35),l=n(36),p=n(27),h=function(){function e(){}return e.sgd=function(e){return new p.SGDOptimizer(e)},e.momentum=function(e,t){return new c.MomentumOptimizer(e,t)},e.rmsprop=function(e,t,n,r){return void 0===t&&(t=.9),void 0===n&&(n=0),void 0===r&&(r=1e-8),new l.RMSPropOptimizer(e,t,n,void 0,r)},e.adam=function(e,t,n,r){return void 0===e&&(e=.001),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=1e-8),new s.AdamOptimizer(e,t,n,r,void 0)},e.adadelta=function(e,t,n){return void 0===e&&(e=.001),void 0===t&&(t=.95),void 0===n&&(n=1e-8),new a.AdadeltaOptimizer(e,t,void 0,n)},e.adamax=function(e,t,n,r,o){return void 0===e&&(e=.002),void 0===t&&(t=.9),void 0===n&&(n=.999),void 0===r&&(r=1e-8),void 0===o&&(o=0),new u.AdamaxOptimizer(e,t,n,r,o,void 0)},e.adagrad=function(e,t){return void 0===t&&(t=.1),new i.AdagradOptimizer(e,void 0,t)},r([o.doc({heading:\"Training\",subheading:\"Optimizers\",namespace:\"train\"})],e,\"sgd\",null),r([o.doc({heading:\"Training\",subheading:\"Optimizers\",namespace:\"train\"})],e,\"momentum\",null),r([o.doc({heading:\"Training\",subheading:\"Optimizers\",namespace:\"train\"})],e,\"rmsprop\",null),r([o.doc({heading:\"Training\",subheading:\"Optimizers\",namespace:\"train\"})],e,\"adam\",null),r([o.doc({heading:\"Training\",subheading:\"Optimizers\",namespace:\"train\"})],e,\"adadelta\",null),r([o.doc({heading:\"Training\",subheading:\"Optimizers\",namespace:\"train\"})],e,\"adamax\",null),r([o.doc({heading:\"Training\",subheading:\"Optimizers\",namespace:\"train\"})],e,\"adagrad\",null),e}();t.OptimizerConstructors=h},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var r=n(162);t.SqueezeNet=r.SqueezeNet},function(e,t,n){\"use strict\";var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))(function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function s(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(i,s)}u((r=r.apply(e,t||[])).next())})},o=this&&this.__generator||function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:s(0),throw:s(1),return:s(2)},\"function\"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function s(a){return function(s){return function(a){if(n)throw new TypeError(\"Generator is already executing.\");for(;i;)try{if(n=1,r&&(o=r[2&a[0]?\"return\":a[0]?\"throw\":\"next\"])&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[0,o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=(o=i.trys).length>0&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,s])}}};Object.defineProperty(t,\"__esModule\",{value:!0});var a=n(23),i=n(163),s=n(164),u=function(){function e(){this.preprocessOffset=a.tensor1d([103.939,116.779,123.68])}return e.prototype.load=function(){return r(this,void 0,void 0,function(){var e,t;return o(this,function(n){switch(n.label){case 0:return e=new a.CheckpointLoader(\"https://storage.googleapis.com/learnjs-data/checkpoint_zoo/squeezenet1_1/\"),t=this,[4,e.getAllVariables()];case 1:return t.variables=n.sent(),[2]}})})},e.prototype.predict=function(e){return this.predictWithActivation(e).logits},e.prototype.predictWithActivation=function(e,t){var n=this;return a.tidy(function(){var r,o=a.sub(e.asType(\"float32\"),n.preprocessOffset).conv2d(n.variables[\"conv1_W:0\"],2,0).add(n.variables[\"conv1_b:0\"]).relu();\"conv_1\"===t&&(r=o);var i=o.maxPool(3,2,0);\"maxpool_1\"===t&&(r=i);var s=n.fireModule(i,2);\"fire2\"===t&&(r=s);var u=n.fireModule(s,3);\"fire3\"===t&&(r=u);var c=u.maxPool(3,2,\"valid\");\"maxpool_2\"===t&&(r=c);var l=n.fireModule(c,4);\"fire4\"===t&&(r=l);var p=n.fireModule(l,5);\"fire5\"===t&&(r=p);var h=p.maxPool(3,2,0);\"maxpool_3\"===t&&(r=h);var d=n.fireModule(h,6);\"fire6\"===t&&(r=d);var f=n.fireModule(d,7);\"fire7\"===t&&(r=f);var m=n.fireModule(f,8);\"fire8\"===t&&(r=m);var v=n.fireModule(m,9);\"fire9\"===t&&(r=v);var g=v.conv2d(n.variables[\"conv10_W:0\"],1,0).add(n.variables[\"conv10_b:0\"]);return\"conv10\"===t&&(r=g),{logits:a.avgPool(g,g.shape[0],1,0).as1D(),activation:r}})},e.prototype.fireModule=function(e,t){var n=a.conv2d(e,this.variables[\"fire\"+t+\"/squeeze1x1_W:0\"],1,0).add(this.variables[\"fire\"+t+\"/squeeze1x1_b:0\"]).relu(),r=a.conv2d(n,this.variables[\"fire\"+t+\"/expand1x1_W:0\"],1,0).add(this.variables[\"fire\"+t+\"/expand1x1_b:0\"]).relu(),o=a.conv2d(n,this.variables[\"fire\"+t+\"/expand3x3_W:0\"],1,1).add(this.variables[\"fire\"+t+\"/expand3x3_b:0\"]).relu();return r.concat(o,2)},e.prototype.getTopKClasses=function(e,t){return r(this,void 0,void 0,function(){var n,r,u,c,l,p,h,d;return o(this,function(o){switch(o.label){case 0:return n=a.tidy(function(){return a.softmax(e).asType(\"float32\")}),c=(u=i).topK,[4,n.data()];case 1:for(r=c.apply(u,[o.sent(),t]),n.dispose(),l=r.indices,p=r.values,h={},d=0;d<l.length;d++)h[s.IMAGENET_CLASSES[l[d]]]=p[d];return[2,h]}})})},e.prototype.dispose=function(){for(var e in this.preprocessOffset.dispose(),this.variables)this.variables[e].dispose()},e}();t.SqueezeNet=u},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.topK=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push({value:e[r],index:r});n.sort(function(e,t){return t.value-e.value});var o=new Float32Array(t),a=new Int32Array(t);for(r=0;r<t;r++)o[r]=n[r].value,a[r]=n[r].index;return{values:o,indices:a}}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.IMAGENET_CLASSES={0:\"tench, Tinca tinca\",1:\"goldfish, Carassius auratus\",2:\"great white shark, white shark, man-eater, man-eating shark, Carcharodon carcharias\",3:\"tiger shark, Galeocerdo cuvieri\",4:\"hammerhead, hammerhead shark\",5:\"electric ray, crampfish, numbfish, torpedo\",6:\"stingray\",7:\"cock\",8:\"hen\",9:\"ostrich, Struthio camelus\",10:\"brambling, Fringilla montifringilla\",11:\"goldfinch, Carduelis carduelis\",12:\"house finch, linnet, Carpodacus mexicanus\",13:\"junco, snowbird\",14:\"indigo bunting, indigo finch, indigo bird, Passerina cyanea\",15:\"robin, American robin, Turdus migratorius\",16:\"bulbul\",17:\"jay\",18:\"magpie\",19:\"chickadee\",20:\"water ouzel, dipper\",21:\"kite\",22:\"bald eagle, American eagle, Haliaeetus leucocephalus\",23:\"vulture\",24:\"great grey owl, great gray owl, Strix nebulosa\",25:\"European fire salamander, Salamandra salamandra\",26:\"common newt, Triturus vulgaris\",27:\"eft\",28:\"spotted salamander, Ambystoma maculatum\",29:\"axolotl, mud puppy, Ambystoma mexicanum\",30:\"bullfrog, Rana catesbeiana\",31:\"tree frog, tree-frog\",32:\"tailed frog, bell toad, ribbed toad, tailed toad, Ascaphus trui\",33:\"loggerhead, loggerhead turtle, Caretta caretta\",34:\"leatherback turtle, leatherback, leathery turtle, Dermochelys coriacea\",35:\"mud turtle\",36:\"terrapin\",37:\"box turtle, box tortoise\",38:\"banded gecko\",39:\"common iguana, iguana, Iguana iguana\",40:\"American chameleon, anole, Anolis carolinensis\",41:\"whiptail, whiptail lizard\",42:\"agama\",43:\"frilled lizard, Chlamydosaurus kingi\",44:\"alligator lizard\",45:\"Gila monster, Heloderma suspectum\",46:\"green lizard, Lacerta viridis\",47:\"African chameleon, Chamaeleo chamaeleon\",48:\"Komodo dragon, Komodo lizard, dragon lizard, giant lizard, Varanus komodoensis\",49:\"African crocodile, Nile crocodile, Crocodylus niloticus\",50:\"American alligator, Alligator mississipiensis\",51:\"triceratops\",52:\"thunder snake, worm snake, Carphophis amoenus\",53:\"ringneck snake, ring-necked snake, ring snake\",54:\"hognose snake, puff adder, sand viper\",55:\"green snake, grass snake\",56:\"king snake, kingsnake\",57:\"garter snake, grass snake\",58:\"water snake\",59:\"vine snake\",60:\"night snake, Hypsiglena torquata\",61:\"boa constrictor, Constrictor constrictor\",62:\"rock python, rock snake, Python sebae\",63:\"Indian cobra, Naja naja\",64:\"green mamba\",65:\"sea snake\",66:\"horned viper, cerastes, sand viper, horned asp, Cerastes cornutus\",67:\"diamondback, diamondback rattlesnake, Crotalus adamanteus\",68:\"sidewinder, horned rattlesnake, Crotalus cerastes\",69:\"trilobite\",70:\"harvestman, daddy longlegs, Phalangium opilio\",71:\"scorpion\",72:\"black and gold garden spider, Argiope aurantia\",73:\"barn spider, Araneus cavaticus\",74:\"garden spider, Aranea diademata\",75:\"black widow, Latrodectus mactans\",76:\"tarantula\",77:\"wolf spider, hunting spider\",78:\"tick\",79:\"centipede\",80:\"black grouse\",81:\"ptarmigan\",82:\"ruffed grouse, partridge, Bonasa umbellus\",83:\"prairie chicken, prairie grouse, prairie fowl\",84:\"peacock\",85:\"quail\",86:\"partridge\",87:\"African grey, African gray, Psittacus erithacus\",88:\"macaw\",89:\"sulphur-crested cockatoo, Kakatoe galerita, Cacatua galerita\",90:\"lorikeet\",91:\"coucal\",92:\"bee eater\",93:\"hornbill\",94:\"hummingbird\",95:\"jacamar\",96:\"toucan\",97:\"drake\",98:\"red-breasted merganser, Mergus serrator\",99:\"goose\",100:\"black swan, Cygnus atratus\",101:\"tusker\",102:\"echidna, spiny anteater, anteater\",103:\"platypus, duckbill, duckbilled platypus, duck-billed platypus, Ornithorhynchus anatinus\",104:\"wallaby, brush kangaroo\",105:\"koala, koala bear, kangaroo bear, native bear, Phascolarctos cinereus\",106:\"wombat\",107:\"jelly fish\",108:\"sea anemone, anemone\",109:\"brain coral\",110:\"flatworm, platyhelminth\",111:\"nematode, nematode worm, roundworm\",112:\"conch\",113:\"snail\",114:\"slug\",115:\"sea slug, nudibranch\",116:\"chiton, coat-of-mail shell, sea cradle, polyplacophore\",117:\"chambered nautilus, pearly nautilus, nautilus\",118:\"Dungeness crab, Cancer magister\",119:\"rock crab, Cancer irroratus\",120:\"fiddler crab\",121:\"king crab, Alaska crab, Alaskan king crab, Alaska king crab, Paralithodes camtschatica\",122:\"American lobster, Northern lobster, Maine lobster, Homarus americanus\",123:\"spiny lobster, langouste, rock lobster, crawfish, crayfish, sea crawfish\",124:\"crayfish, crawfish, crawdad, crawdaddy\",125:\"hermit crab\",126:\"isopod\",127:\"white stork, Ciconia ciconia\",128:\"black stork, Ciconia nigra\",129:\"spoonbill\",130:\"flamingo\",131:\"little blue heron, Egretta caerulea\",132:\"American egret, great white heron, Egretta albus\",133:\"bittern\",134:\"crane\",135:\"limpkin, Aramus pictus\",136:\"European gallinule, Porphyrio porphyrio\",137:\"American coot, marsh hen, mud hen, water hen, Fulica americana\",138:\"bustard\",139:\"ruddy turnstone, Arenaria interpres\",140:\"red-backed sandpiper, dunlin, Erolia alpina\",141:\"redshank, Tringa totanus\",142:\"dowitcher\",143:\"oystercatcher, oyster catcher\",144:\"pelican\",145:\"king penguin, Aptenodytes patagonica\",146:\"albatross, mollymawk\",147:\"grey whale, gray whale, devilfish, Eschrichtius gibbosus, Eschrichtius robustus\",148:\"killer whale, killer, orca, grampus, sea wolf, Orcinus orca\",149:\"dugong, Dugong dugon\",150:\"sea lion\",151:\"Chihuahua\",152:\"Japanese spaniel\",153:\"Maltese dog, Maltese terrier, Maltese\",154:\"Pekinese, Pekingese, Peke\",155:\"Shih-Tzu\",156:\"Blenheim spaniel\",157:\"papillon\",158:\"toy terrier\",159:\"Rhodesian ridgeback\",160:\"Afghan hound, Afghan\",161:\"basset, basset hound\",162:\"beagle\",163:\"bloodhound, sleuthhound\",164:\"bluetick\",165:\"black-and-tan coonhound\",166:\"Walker hound, Walker foxhound\",167:\"English foxhound\",168:\"redbone\",169:\"borzoi, Russian wolfhound\",170:\"Irish wolfhound\",171:\"Italian greyhound\",172:\"whippet\",173:\"Ibizan hound, Ibizan Podenco\",174:\"Norwegian elkhound, elkhound\",175:\"otterhound, otter hound\",176:\"Saluki, gazelle hound\",177:\"Scottish deerhound, deerhound\",178:\"Weimaraner\",179:\"Staffordshire bullterrier, Staffordshire bull terrier\",180:\"American Staffordshire terrier, Staffordshire terrier, American pit bull terrier, pit bull terrier\",181:\"Bedlington terrier\",182:\"Border terrier\",183:\"Kerry blue terrier\",184:\"Irish terrier\",185:\"Norfolk terrier\",186:\"Norwich terrier\",187:\"Yorkshire terrier\",188:\"wire-haired fox terrier\",189:\"Lakeland terrier\",190:\"Sealyham terrier, Sealyham\",191:\"Airedale, Airedale terrier\",192:\"cairn, cairn terrier\",193:\"Australian terrier\",194:\"Dandie Dinmont, Dandie Dinmont terrier\",195:\"Boston bull, Boston terrier\",196:\"miniature schnauzer\",197:\"giant schnauzer\",198:\"standard schnauzer\",199:\"Scotch terrier, Scottish terrier, Scottie\",200:\"Tibetan terrier, chrysanthemum dog\",201:\"silky terrier, Sydney silky\",202:\"soft-coated wheaten terrier\",203:\"West Highland white terrier\",204:\"Lhasa, Lhasa apso\",205:\"flat-coated retriever\",206:\"curly-coated retriever\",207:\"golden retriever\",208:\"Labrador retriever\",209:\"Chesapeake Bay retriever\",210:\"German short-haired pointer\",211:\"vizsla, Hungarian pointer\",212:\"English setter\",213:\"Irish setter, red setter\",214:\"Gordon setter\",215:\"Brittany spaniel\",216:\"clumber, clumber spaniel\",217:\"English springer, English springer spaniel\",218:\"Welsh springer spaniel\",219:\"cocker spaniel, English cocker spaniel, cocker\",220:\"Sussex spaniel\",221:\"Irish water spaniel\",222:\"kuvasz\",223:\"schipperke\",224:\"groenendael\",225:\"malinois\",226:\"briard\",227:\"kelpie\",228:\"komondor\",229:\"Old English sheepdog, bobtail\",230:\"Shetland sheepdog, Shetland sheep dog, Shetland\",231:\"collie\",232:\"Border collie\",233:\"Bouvier des Flandres, Bouviers des Flandres\",234:\"Rottweiler\",235:\"German shepherd, German shepherd dog, German police dog, alsatian\",236:\"Doberman, Doberman pinscher\",237:\"miniature pinscher\",238:\"Greater Swiss Mountain dog\",239:\"Bernese mountain dog\",240:\"Appenzeller\",241:\"EntleBucher\",242:\"boxer\",243:\"bull mastiff\",244:\"Tibetan mastiff\",245:\"French bulldog\",246:\"Great Dane\",247:\"Saint Bernard, St Bernard\",248:\"Eskimo dog, husky\",249:\"malamute, malemute, Alaskan malamute\",250:\"Siberian husky\",251:\"dalmatian, coach dog, carriage dog\",252:\"affenpinscher, monkey pinscher, monkey dog\",253:\"basenji\",254:\"pug, pug-dog\",255:\"Leonberg\",256:\"Newfoundland, Newfoundland dog\",257:\"Great Pyrenees\",258:\"Samoyed, Samoyede\",259:\"Pomeranian\",260:\"chow, chow chow\",261:\"keeshond\",262:\"Brabancon griffon\",263:\"Pembroke, Pembroke Welsh corgi\",264:\"Cardigan, Cardigan Welsh corgi\",265:\"toy poodle\",266:\"miniature poodle\",267:\"standard poodle\",268:\"Mexican hairless\",269:\"timber wolf, grey wolf, gray wolf, Canis lupus\",270:\"white wolf, Arctic wolf, Canis lupus tundrarum\",271:\"red wolf, maned wolf, Canis rufus, Canis niger\",272:\"coyote, prairie wolf, brush wolf, Canis latrans\",273:\"dingo, warrigal, warragal, Canis dingo\",274:\"dhole, Cuon alpinus\",275:\"African hunting dog, hyena dog, Cape hunting dog, Lycaon pictus\",276:\"hyena, hyaena\",277:\"red fox, Vulpes vulpes\",278:\"kit fox, Vulpes macrotis\",279:\"Arctic fox, white fox, Alopex lagopus\",280:\"grey fox, gray fox, Urocyon cinereoargenteus\",281:\"tabby, tabby cat\",282:\"tiger cat\",283:\"Persian cat\",284:\"Siamese cat, Siamese\",285:\"Egyptian cat\",286:\"cougar, puma, catamount, mountain lion, painter, panther, Felis concolor\",287:\"lynx, catamount\",288:\"leopard, Panthera pardus\",289:\"snow leopard, ounce, Panthera uncia\",290:\"jaguar, panther, Panthera onca, Felis onca\",291:\"lion, king of beasts, Panthera leo\",292:\"tiger, Panthera tigris\",293:\"cheetah, chetah, Acinonyx jubatus\",294:\"brown bear, bruin, Ursus arctos\",295:\"American black bear, black bear, Ursus americanus, Euarctos americanus\",296:\"ice bear, polar bear, Ursus Maritimus, Thalarctos maritimus\",297:\"sloth bear, Melursus ursinus, Ursus ursinus\",298:\"mongoose\",299:\"meerkat, mierkat\",300:\"tiger beetle\",301:\"ladybug, ladybeetle, lady beetle, ladybird, ladybird beetle\",302:\"ground beetle, carabid beetle\",303:\"long-horned beetle, longicorn, longicorn beetle\",304:\"leaf beetle, chrysomelid\",305:\"dung beetle\",306:\"rhinoceros beetle\",307:\"weevil\",308:\"fly\",309:\"bee\",310:\"ant, emmet, pismire\",311:\"grasshopper, hopper\",312:\"cricket\",313:\"walking stick, walkingstick, stick insect\",314:\"cockroach, roach\",315:\"mantis, mantid\",316:\"cicada, cicala\",317:\"leafhopper\",318:\"lacewing, lacewing fly\",319:\"dragonfly, darning needle, devil's darning needle, sewing needle, snake feeder, snake doctor, mosquito hawk, skeeter hawk\",320:\"damselfly\",321:\"admiral\",322:\"ringlet, ringlet butterfly\",323:\"monarch, monarch butterfly, milkweed butterfly, Danaus plexippus\",324:\"cabbage butterfly\",325:\"sulphur butterfly, sulfur butterfly\",326:\"lycaenid, lycaenid butterfly\",327:\"starfish, sea star\",328:\"sea urchin\",329:\"sea cucumber, holothurian\",330:\"wood rabbit, cottontail, cottontail rabbit\",331:\"hare\",332:\"Angora, Angora rabbit\",333:\"hamster\",334:\"porcupine, hedgehog\",335:\"fox squirrel, eastern fox squirrel, Sciurus niger\",336:\"marmot\",337:\"beaver\",338:\"guinea pig, Cavia cobaya\",339:\"sorrel\",340:\"zebra\",341:\"hog, pig, grunter, squealer, Sus scrofa\",342:\"wild boar, boar, Sus scrofa\",343:\"warthog\",344:\"hippopotamus, hippo, river horse, Hippopotamus amphibius\",345:\"ox\",346:\"water buffalo, water ox, Asiatic buffalo, Bubalus bubalis\",347:\"bison\",348:\"ram, tup\",349:\"bighorn, bighorn sheep, cimarron, Rocky Mountain bighorn, Rocky Mountain sheep, Ovis canadensis\",350:\"ibex, Capra ibex\",351:\"hartebeest\",352:\"impala, Aepyceros melampus\",353:\"gazelle\",354:\"Arabian camel, dromedary, Camelus dromedarius\",355:\"llama\",356:\"weasel\",357:\"mink\",358:\"polecat, fitch, foulmart, foumart, Mustela putorius\",359:\"black-footed ferret, ferret, Mustela nigripes\",360:\"otter\",361:\"skunk, polecat, wood pussy\",362:\"badger\",363:\"armadillo\",364:\"three-toed sloth, ai, Bradypus tridactylus\",365:\"orangutan, orang, orangutang, Pongo pygmaeus\",366:\"gorilla, Gorilla gorilla\",367:\"chimpanzee, chimp, Pan troglodytes\",368:\"gibbon, Hylobates lar\",369:\"siamang, Hylobates syndactylus, Symphalangus syndactylus\",370:\"guenon, guenon monkey\",371:\"patas, hussar monkey, Erythrocebus patas\",372:\"baboon\",373:\"macaque\",374:\"langur\",375:\"colobus, colobus monkey\",376:\"proboscis monkey, Nasalis larvatus\",377:\"marmoset\",378:\"capuchin, ringtail, Cebus capucinus\",379:\"howler monkey, howler\",380:\"titi, titi monkey\",381:\"spider monkey, Ateles geoffroyi\",382:\"squirrel monkey, Saimiri sciureus\",383:\"Madagascar cat, ring-tailed lemur, Lemur catta\",384:\"indri, indris, Indri indri, Indri brevicaudatus\",385:\"Indian elephant, Elephas maximus\",386:\"African elephant, Loxodonta africana\",387:\"lesser panda, red panda, panda, bear cat, cat bear, Ailurus fulgens\",388:\"giant panda, panda, panda bear, coon bear, Ailuropoda melanoleuca\",389:\"barracouta, snoek\",390:\"eel\",391:\"coho, cohoe, coho salmon, blue jack, silver salmon, Oncorhynchus kisutch\",392:\"rock beauty, Holocanthus tricolor\",393:\"anemone fish\",394:\"sturgeon\",395:\"gar, garfish, garpike, billfish, Lepisosteus osseus\",396:\"lionfish\",397:\"puffer, pufferfish, blowfish, globefish\",398:\"abacus\",399:\"abaya\",400:\"academic gown, academic robe, judge's robe\",401:\"accordion, piano accordion, squeeze box\",402:\"acoustic guitar\",403:\"aircraft carrier, carrier, flattop, attack aircraft carrier\",404:\"airliner\",405:\"airship, dirigible\",406:\"altar\",407:\"ambulance\",408:\"amphibian, amphibious vehicle\",409:\"analog clock\",410:\"apiary, bee house\",411:\"apron\",412:\"ashcan, trash can, garbage can, wastebin, ash bin, ash-bin, ashbin, dustbin, trash barrel, trash bin\",413:\"assault rifle, assault gun\",414:\"backpack, back pack, knapsack, packsack, rucksack, haversack\",415:\"bakery, bakeshop, bakehouse\",416:\"balance beam, beam\",417:\"balloon\",418:\"ballpoint, ballpoint pen, ballpen, Biro\",419:\"Band Aid\",420:\"banjo\",421:\"bannister, banister, balustrade, balusters, handrail\",422:\"barbell\",423:\"barber chair\",424:\"barbershop\",425:\"barn\",426:\"barometer\",427:\"barrel, cask\",428:\"barrow, garden cart, lawn cart, wheelbarrow\",429:\"baseball\",430:\"basketball\",431:\"bassinet\",432:\"bassoon\",433:\"bathing cap, swimming cap\",434:\"bath towel\",435:\"bathtub, bathing tub, bath, tub\",436:\"beach wagon, station wagon, wagon, estate car, beach waggon, station waggon, waggon\",437:\"beacon, lighthouse, beacon light, pharos\",438:\"beaker\",439:\"bearskin, busby, shako\",440:\"beer bottle\",441:\"beer glass\",442:\"bell cote, bell cot\",443:\"bib\",444:\"bicycle-built-for-two, tandem bicycle, tandem\",445:\"bikini, two-piece\",446:\"binder, ring-binder\",447:\"binoculars, field glasses, opera glasses\",448:\"birdhouse\",449:\"boathouse\",450:\"bobsled, bobsleigh, bob\",451:\"bolo tie, bolo, bola tie, bola\",452:\"bonnet, poke bonnet\",453:\"bookcase\",454:\"bookshop, bookstore, bookstall\",455:\"bottlecap\",456:\"bow\",457:\"bow tie, bow-tie, bowtie\",458:\"brass, memorial tablet, plaque\",459:\"brassiere, bra, bandeau\",460:\"breakwater, groin, groyne, mole, bulwark, seawall, jetty\",461:\"breastplate, aegis, egis\",462:\"broom\",463:\"bucket, pail\",464:\"buckle\",465:\"bulletproof vest\",466:\"bullet train, bullet\",467:\"butcher shop, meat market\",468:\"cab, hack, taxi, taxicab\",469:\"caldron, cauldron\",470:\"candle, taper, wax light\",471:\"cannon\",472:\"canoe\",473:\"can opener, tin opener\",474:\"cardigan\",475:\"car mirror\",476:\"carousel, carrousel, merry-go-round, roundabout, whirligig\",477:\"carpenter's kit, tool kit\",478:\"carton\",479:\"car wheel\",480:\"cash machine, cash dispenser, automated teller machine, automatic teller machine, automated teller, automatic teller, ATM\",481:\"cassette\",482:\"cassette player\",483:\"castle\",484:\"catamaran\",485:\"CD player\",486:\"cello, violoncello\",487:\"cellular telephone, cellular phone, cellphone, cell, mobile phone\",488:\"chain\",489:\"chainlink fence\",490:\"chain mail, ring mail, mail, chain armor, chain armour, ring armor, ring armour\",491:\"chain saw, chainsaw\",492:\"chest\",493:\"chiffonier, commode\",494:\"chime, bell, gong\",495:\"china cabinet, china closet\",496:\"Christmas stocking\",497:\"church, church building\",498:\"cinema, movie theater, movie theatre, movie house, picture palace\",499:\"cleaver, meat cleaver, chopper\",500:\"cliff dwelling\",501:\"cloak\",502:\"clog, geta, patten, sabot\",503:\"cocktail shaker\",504:\"coffee mug\",505:\"coffeepot\",506:\"coil, spiral, volute, whorl, helix\",507:\"combination lock\",508:\"computer keyboard, keypad\",509:\"confectionery, confectionary, candy store\",510:\"container ship, containership, container vessel\",511:\"convertible\",512:\"corkscrew, bottle screw\",513:\"cornet, horn, trumpet, trump\",514:\"cowboy boot\",515:\"cowboy hat, ten-gallon hat\",516:\"cradle\",517:\"crane\",518:\"crash helmet\",519:\"crate\",520:\"crib, cot\",521:\"Crock Pot\",522:\"croquet ball\",523:\"crutch\",524:\"cuirass\",525:\"dam, dike, dyke\",526:\"desk\",527:\"desktop computer\",528:\"dial telephone, dial phone\",529:\"diaper, nappy, napkin\",530:\"digital clock\",531:\"digital watch\",532:\"dining table, board\",533:\"dishrag, dishcloth\",534:\"dishwasher, dish washer, dishwashing machine\",535:\"disk brake, disc brake\",536:\"dock, dockage, docking facility\",537:\"dogsled, dog sled, dog sleigh\",538:\"dome\",539:\"doormat, welcome mat\",540:\"drilling platform, offshore rig\",541:\"drum, membranophone, tympan\",542:\"drumstick\",543:\"dumbbell\",544:\"Dutch oven\",545:\"electric fan, blower\",546:\"electric guitar\",547:\"electric locomotive\",548:\"entertainment center\",549:\"envelope\",550:\"espresso maker\",551:\"face powder\",552:\"feather boa, boa\",553:\"file, file cabinet, filing cabinet\",554:\"fireboat\",555:\"fire engine, fire truck\",556:\"fire screen, fireguard\",557:\"flagpole, flagstaff\",558:\"flute, transverse flute\",559:\"folding chair\",560:\"football helmet\",561:\"forklift\",562:\"fountain\",563:\"fountain pen\",564:\"four-poster\",565:\"freight car\",566:\"French horn, horn\",567:\"frying pan, frypan, skillet\",568:\"fur coat\",569:\"garbage truck, dustcart\",570:\"gasmask, respirator, gas helmet\",571:\"gas pump, gasoline pump, petrol pump, island dispenser\",572:\"goblet\",573:\"go-kart\",574:\"golf ball\",575:\"golfcart, golf cart\",576:\"gondola\",577:\"gong, tam-tam\",578:\"gown\",579:\"grand piano, grand\",580:\"greenhouse, nursery, glasshouse\",581:\"grille, radiator grille\",582:\"grocery store, grocery, food market, market\",583:\"guillotine\",584:\"hair slide\",585:\"hair spray\",586:\"half track\",587:\"hammer\",588:\"hamper\",589:\"hand blower, blow dryer, blow drier, hair dryer, hair drier\",590:\"hand-held computer, hand-held microcomputer\",591:\"handkerchief, hankie, hanky, hankey\",592:\"hard disc, hard disk, fixed disk\",593:\"harmonica, mouth organ, harp, mouth harp\",594:\"harp\",595:\"harvester, reaper\",596:\"hatchet\",597:\"holster\",598:\"home theater, home theatre\",599:\"honeycomb\",600:\"hook, claw\",601:\"hoopskirt, crinoline\",602:\"horizontal bar, high bar\",603:\"horse cart, horse-cart\",604:\"hourglass\",605:\"iPod\",606:\"iron, smoothing iron\",607:\"jack-o'-lantern\",608:\"jean, blue jean, denim\",609:\"jeep, landrover\",610:\"jersey, T-shirt, tee shirt\",611:\"jigsaw puzzle\",612:\"jinrikisha, ricksha, rickshaw\",613:\"joystick\",614:\"kimono\",615:\"knee pad\",616:\"knot\",617:\"lab coat, laboratory coat\",618:\"ladle\",619:\"lampshade, lamp shade\",620:\"laptop, laptop computer\",621:\"lawn mower, mower\",622:\"lens cap, lens cover\",623:\"letter opener, paper knife, paperknife\",624:\"library\",625:\"lifeboat\",626:\"lighter, light, igniter, ignitor\",627:\"limousine, limo\",628:\"liner, ocean liner\",629:\"lipstick, lip rouge\",630:\"Loafer\",631:\"lotion\",632:\"loudspeaker, speaker, speaker unit, loudspeaker system, speaker system\",633:\"loupe, jeweler's loupe\",634:\"lumbermill, sawmill\",635:\"magnetic compass\",636:\"mailbag, postbag\",637:\"mailbox, letter box\",638:\"maillot\",639:\"maillot, tank suit\",640:\"manhole cover\",641:\"maraca\",642:\"marimba, xylophone\",643:\"mask\",644:\"matchstick\",645:\"maypole\",646:\"maze, labyrinth\",647:\"measuring cup\",648:\"medicine chest, medicine cabinet\",649:\"megalith, megalithic structure\",650:\"microphone, mike\",651:\"microwave, microwave oven\",652:\"military uniform\",653:\"milk can\",654:\"minibus\",655:\"miniskirt, mini\",656:\"minivan\",657:\"missile\",658:\"mitten\",659:\"mixing bowl\",660:\"mobile home, manufactured home\",661:\"Model T\",662:\"modem\",663:\"monastery\",664:\"monitor\",665:\"moped\",666:\"mortar\",667:\"mortarboard\",668:\"mosque\",669:\"mosquito net\",670:\"motor scooter, scooter\",671:\"mountain bike, all-terrain bike, off-roader\",672:\"mountain tent\",673:\"mouse, computer mouse\",674:\"mousetrap\",675:\"moving van\",676:\"muzzle\",677:\"nail\",678:\"neck brace\",679:\"necklace\",680:\"nipple\",681:\"notebook, notebook computer\",682:\"obelisk\",683:\"oboe, hautboy, hautbois\",684:\"ocarina, sweet potato\",685:\"odometer, hodometer, mileometer, milometer\",686:\"oil filter\",687:\"organ, pipe organ\",688:\"oscilloscope, scope, cathode-ray oscilloscope, CRO\",689:\"overskirt\",690:\"oxcart\",691:\"oxygen mask\",692:\"packet\",693:\"paddle, boat paddle\",694:\"paddlewheel, paddle wheel\",695:\"padlock\",696:\"paintbrush\",697:\"pajama, pyjama, pj's, jammies\",698:\"palace\",699:\"panpipe, pandean pipe, syrinx\",700:\"paper towel\",701:\"parachute, chute\",702:\"parallel bars, bars\",703:\"park bench\",704:\"parking meter\",705:\"passenger car, coach, carriage\",706:\"patio, terrace\",707:\"pay-phone, pay-station\",708:\"pedestal, plinth, footstall\",709:\"pencil box, pencil case\",710:\"pencil sharpener\",711:\"perfume, essence\",712:\"Petri dish\",713:\"photocopier\",714:\"pick, plectrum, plectron\",715:\"pickelhaube\",716:\"picket fence, paling\",717:\"pickup, pickup truck\",718:\"pier\",719:\"piggy bank, penny bank\",720:\"pill bottle\",721:\"pillow\",722:\"ping-pong ball\",723:\"pinwheel\",724:\"pirate, pirate ship\",725:\"pitcher, ewer\",726:\"plane, carpenter's plane, woodworking plane\",727:\"planetarium\",728:\"plastic bag\",729:\"plate rack\",730:\"plow, plough\",731:\"plunger, plumber's helper\",732:\"Polaroid camera, Polaroid Land camera\",733:\"pole\",734:\"police van, police wagon, paddy wagon, patrol wagon, wagon, black Maria\",735:\"poncho\",736:\"pool table, billiard table, snooker table\",737:\"pop bottle, soda bottle\",738:\"pot, flowerpot\",739:\"potter's wheel\",740:\"power drill\",741:\"prayer rug, prayer mat\",742:\"printer\",743:\"prison, prison house\",744:\"projectile, missile\",745:\"projector\",746:\"puck, hockey puck\",747:\"punching bag, punch bag, punching ball, punchball\",748:\"purse\",749:\"quill, quill pen\",750:\"quilt, comforter, comfort, puff\",751:\"racer, race car, racing car\",752:\"racket, racquet\",753:\"radiator\",754:\"radio, wireless\",755:\"radio telescope, radio reflector\",756:\"rain barrel\",757:\"recreational vehicle, RV, R.V.\",758:\"reel\",759:\"reflex camera\",760:\"refrigerator, icebox\",761:\"remote control, remote\",762:\"restaurant, eating house, eating place, eatery\",763:\"revolver, six-gun, six-shooter\",764:\"rifle\",765:\"rocking chair, rocker\",766:\"rotisserie\",767:\"rubber eraser, rubber, pencil eraser\",768:\"rugby ball\",769:\"rule, ruler\",770:\"running shoe\",771:\"safe\",772:\"safety pin\",773:\"saltshaker, salt shaker\",774:\"sandal\",775:\"sarong\",776:\"sax, saxophone\",777:\"scabbard\",778:\"scale, weighing machine\",779:\"school bus\",780:\"schooner\",781:\"scoreboard\",782:\"screen, CRT screen\",783:\"screw\",784:\"screwdriver\",785:\"seat belt, seatbelt\",786:\"sewing machine\",787:\"shield, buckler\",788:\"shoe shop, shoe-shop, shoe store\",789:\"shoji\",790:\"shopping basket\",791:\"shopping cart\",792:\"shovel\",793:\"shower cap\",794:\"shower curtain\",795:\"ski\",796:\"ski mask\",797:\"sleeping bag\",798:\"slide rule, slipstick\",799:\"sliding door\",800:\"slot, one-armed bandit\",801:\"snorkel\",802:\"snowmobile\",803:\"snowplow, snowplough\",804:\"soap dispenser\",805:\"soccer ball\",806:\"sock\",807:\"solar dish, solar collector, solar furnace\",808:\"sombrero\",809:\"soup bowl\",810:\"space bar\",811:\"space heater\",812:\"space shuttle\",813:\"spatula\",814:\"speedboat\",815:\"spider web, spider's web\",816:\"spindle\",817:\"sports car, sport car\",818:\"spotlight, spot\",819:\"stage\",820:\"steam locomotive\",821:\"steel arch bridge\",822:\"steel drum\",823:\"stethoscope\",824:\"stole\",825:\"stone wall\",826:\"stopwatch, stop watch\",827:\"stove\",828:\"strainer\",829:\"streetcar, tram, tramcar, trolley, trolley car\",830:\"stretcher\",831:\"studio couch, day bed\",832:\"stupa, tope\",833:\"submarine, pigboat, sub, U-boat\",834:\"suit, suit of clothes\",835:\"sundial\",836:\"sunglass\",837:\"sunglasses, dark glasses, shades\",838:\"sunscreen, sunblock, sun blocker\",839:\"suspension bridge\",840:\"swab, swob, mop\",841:\"sweatshirt\",842:\"swimming trunks, bathing trunks\",843:\"swing\",844:\"switch, electric switch, electrical switch\",845:\"syringe\",846:\"table lamp\",847:\"tank, army tank, armored combat vehicle, armoured combat vehicle\",848:\"tape player\",849:\"teapot\",850:\"teddy, teddy bear\",851:\"television, television system\",852:\"tennis ball\",853:\"thatch, thatched roof\",854:\"theater curtain, theatre curtain\",855:\"thimble\",856:\"thresher, thrasher, threshing machine\",857:\"throne\",858:\"tile roof\",859:\"toaster\",860:\"tobacco shop, tobacconist shop, tobacconist\",861:\"toilet seat\",862:\"torch\",863:\"totem pole\",864:\"tow truck, tow car, wrecker\",865:\"toyshop\",866:\"tractor\",867:\"trailer truck, tractor trailer, trucking rig, rig, articulated lorry, semi\",868:\"tray\",869:\"trench coat\",870:\"tricycle, trike, velocipede\",871:\"trimaran\",872:\"tripod\",873:\"triumphal arch\",874:\"trolleybus, trolley coach, trackless trolley\",875:\"trombone\",876:\"tub, vat\",877:\"turnstile\",878:\"typewriter keyboard\",879:\"umbrella\",880:\"unicycle, monocycle\",881:\"upright, upright piano\",882:\"vacuum, vacuum cleaner\",883:\"vase\",884:\"vault\",885:\"velvet\",886:\"vending machine\",887:\"vestment\",888:\"viaduct\",889:\"violin, fiddle\",890:\"volleyball\",891:\"waffle iron\",892:\"wall clock\",893:\"wallet, billfold, notecase, pocketbook\",894:\"wardrobe, closet, press\",895:\"warplane, military plane\",896:\"washbasin, handbasin, washbowl, lavabo, wash-hand basin\",897:\"washer, automatic washer, washing machine\",898:\"water bottle\",899:\"water jug\",900:\"water tower\",901:\"whiskey jug\",902:\"whistle\",903:\"wig\",904:\"window screen\",905:\"window shade\",906:\"Windsor tie\",907:\"wine bottle\",908:\"wing\",909:\"wok\",910:\"wooden spoon\",911:\"wool, woolen, woollen\",912:\"worm fence, snake fence, snake-rail fence, Virginia fence\",913:\"wreck\",914:\"yawl\",915:\"yurt\",916:\"web site, website, internet site, site\",917:\"comic book\",918:\"crossword puzzle, crossword\",919:\"street sign\",920:\"traffic light, traffic signal, stoplight\",921:\"book jacket, dust cover, dust jacket, dust wrapper\",922:\"menu\",923:\"plate\",924:\"guacamole\",925:\"consomme\",926:\"hot pot, hotpot\",927:\"trifle\",928:\"ice cream, icecream\",929:\"ice lolly, lolly, lollipop, popsicle\",930:\"French loaf\",931:\"bagel, beigel\",932:\"pretzel\",933:\"cheeseburger\",934:\"hotdog, hot dog, red hot\",935:\"mashed potato\",936:\"head cabbage\",937:\"broccoli\",938:\"cauliflower\",939:\"zucchini, courgette\",940:\"spaghetti squash\",941:\"acorn squash\",942:\"butternut squash\",943:\"cucumber, cuke\",944:\"artichoke, globe artichoke\",945:\"bell pepper\",946:\"cardoon\",947:\"mushroom\",948:\"Granny Smith\",949:\"strawberry\",950:\"orange\",951:\"lemon\",952:\"fig\",953:\"pineapple, ananas\",954:\"banana\",955:\"jackfruit, jak, jack\",956:\"custard apple\",957:\"pomegranate\",958:\"hay\",959:\"carbonara\",960:\"chocolate sauce, chocolate syrup\",961:\"dough\",962:\"meat loaf, meatloaf\",963:\"pizza, pizza pie\",964:\"potpie\",965:\"burrito\",966:\"red wine\",967:\"espresso\",968:\"cup\",969:\"eggnog\",970:\"alp\",971:\"bubble\",972:\"cliff, drop, drop-off\",973:\"coral reef\",974:\"geyser\",975:\"lakeside, lakeshore\",976:\"promontory, headland, head, foreland\",977:\"sandbar, sand bar\",978:\"seashore, coast, seacoast, sea-coast\",979:\"valley, vale\",980:\"volcano\",981:\"ballplayer, baseball player\",982:\"groom, bridegroom\",983:\"scuba diver\",984:\"rapeseed\",985:\"daisy\",986:\"yellow lady's slipper, yellow lady-slipper, Cypripedium calceolus, Cypripedium parviflorum\",987:\"corn\",988:\"acorn\",989:\"hip, rose hip, rosehip\",990:\"buckeye, horse chestnut, conker\",991:\"coral fungus\",992:\"agaric\",993:\"gyromitra\",994:\"stinkhorn, carrion fungus\",995:\"earthstar\",996:\"hen-of-the-woods, hen of the woods, Polyporus frondosus, Grifola frondosa\",997:\"bolete\",998:\"ear, spike, capitulum\",999:\"toilet tissue, toilet paper, bathroom tissue\"}},function(e,t,n){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.topK=function(e,t){for(var n=[],r=0;r<e.length;r++)n.push({value:e[r],index:r});n.sort(function(e,t){return t.value-e.value});var o=new Float32Array(t),a=new Int32Array(t);for(r=0;r<t;r++)o[r]=n[r].value,a[r]=n[r].index;return{values:o,indices:a}}},function(e,t){}]);","extractedComments":[]}